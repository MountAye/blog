{"pageProps":{"metadata":{"date":"2024-04-15","title":".tex | MC→MCMC 蒙特卡洛模拟，基于马尔科夫链采样","filename":"2024-04-15-mc-mcmc-markov-chain-monte-carlo-gibbs-sampling.md","url":"mc-mcmc-markov-chain-monte-carlo-gibbs-sampling","layout":"post","keywords":["tex","phy"],"excerpt":"蒙特卡洛模拟、马尔科夫链采样、Metropolis-Hastings 算法、吉布斯采样","hasMath":true},"mdAst":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"Monte Carlo 蒙特卡洛模拟，简称 MC.","position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":26,"offset":27}}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":27,"offset":28}}},{"type":"paragraph","children":[{"type":"text","value":"Markov Chain Monte Carlo 是用马尔科夫链采样的蒙特卡洛模拟，简称 MCMC.","position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":51,"offset":82}}}],"position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":51,"offset":82}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Monte Carlo 模拟","position":{"start":{"line":6,"column":4,"offset":89},"end":{"line":6,"column":18,"offset":103}}}],"position":{"start":{"line":6,"column":1,"offset":86},"end":{"line":6,"column":18,"offset":103}}},{"type":"paragraph","children":[{"type":"text","value":"这个比较简单了，举个例子，要计算 π 的近似值，可以在一块正方形板子里画一个内接圆，然后以均匀的概率往正方形里一粒一粒地扔沙子，每扔一粒，就判断并且记录这里沙子在圆内还是圆外，然后把沙子吹掉，如此往复。圆的面积是 πr²，正方形的面积是 4r²，所以落在圆内的概率（圆内沙子的数量和总数的比值）乘 4，就是所求。","position":{"start":{"line":8,"column":1,"offset":107},"end":{"line":8,"column":157,"offset":263}}}],"position":{"start":{"line":8,"column":1,"offset":107},"end":{"line":8,"column":157,"offset":263}}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"/blog/photos/2024-04-15-monte-carlo-pi.png","alt":"","position":{"start":{"line":10,"column":1,"offset":267},"end":{"line":10,"column":48,"offset":314}}}],"position":{"start":{"line":10,"column":1,"offset":267},"end":{"line":10,"column":48,"offset":314}}},{"type":"paragraph","children":[{"type":"text","value":"归纳一下：当问题的解用一个随机变量的概率分布、期望值、二阶矩……等等来表示的时候，就生成一个符合该概率分布的随机样本，用样本的统计量去近似原概率分布。","position":{"start":{"line":12,"column":1,"offset":318},"end":{"line":12,"column":76,"offset":393}}}],"position":{"start":{"line":12,"column":1,"offset":318},"end":{"line":12,"column":76,"offset":393}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Markov Chain Monte Carlo","position":{"start":{"line":14,"column":4,"offset":400},"end":{"line":14,"column":28,"offset":424}}}],"position":{"start":{"line":14,"column":1,"offset":397},"end":{"line":14,"column":28,"offset":424}}},{"type":"paragraph","children":[{"type":"text","value":"但是前述例子有一个步骤，就是我们往板子上扔完沙子要把沙子吹掉，每粒沙子，每次扔沙子之间也应该看不出区别，这是为了保证取样之间","position":{"start":{"line":16,"column":1,"offset":428},"end":{"line":16,"column":63,"offset":490}}},{"type":"strong","children":[{"type":"text","value":"相互独立且来自同一个概率分布","position":{"start":{"line":16,"column":65,"offset":492},"end":{"line":16,"column":79,"offset":506}}}],"position":{"start":{"line":16,"column":63,"offset":490},"end":{"line":16,"column":81,"offset":508}}},{"type":"text","value":"。","position":{"start":{"line":16,"column":81,"offset":508},"end":{"line":16,"column":82,"offset":509}}}],"position":{"start":{"line":16,"column":1,"offset":428},"end":{"line":16,"column":82,"offset":509}}},{"type":"paragraph","children":[{"type":"text","value":"但是很多取样过程无法满足这种条件，或者达成条件所需的成本很高。比如计算一个高斯积分 ","position":{"start":{"line":18,"column":1,"offset":513},"end":{"line":18,"column":43,"offset":555}}},{"type":"inlineMath","value":"\\int_{-\\infty}^{+\\infty}e^{-x^2}dx","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"\\int_{-\\infty}^{+\\infty}e^{-x^2}dx"}]},"position":{"start":{"line":18,"column":43,"offset":555},"end":{"line":18,"column":81,"offset":593}}},{"type":"text","value":"，被积函数的取值范围涵盖整个实数集，想找一个在整个实数集上均匀分布的随机数发生器就比较难了。","position":{"start":{"line":18,"column":81,"offset":593},"end":{"line":18,"column":127,"offset":639}}}],"position":{"start":{"line":18,"column":1,"offset":513},"end":{"line":18,"column":127,"offset":639}}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"/blog/photos/2024-04-15-monte-carlo-gaussian.png","alt":"","position":{"start":{"line":20,"column":1,"offset":643},"end":{"line":20,"column":54,"offset":696}}}],"position":{"start":{"line":20,"column":1,"offset":643},"end":{"line":20,"column":54,"offset":696}}},{"type":"paragraph","children":[{"type":"text","value":"但是学过物理的朋友应该知道，上面的被积函数是以狄拉克 δ(x) 函数为初值条件的一个扩散方程的解，在某一时刻的空间分布。（不想凑系数了，将就看吧）","position":{"start":{"line":22,"column":1,"offset":700},"end":{"line":22,"column":74,"offset":773}}}],"position":{"start":{"line":22,"column":1,"offset":700},"end":{"line":22,"column":74,"offset":773}}},{"type":"paragraph","children":[{"type":"text","value":"而扩散方程又是随机游走 (random walk) 在连续近似下的极限。","position":{"start":{"line":24,"column":1,"offset":777},"end":{"line":24,"column":37,"offset":813}}}],"position":{"start":{"line":24,"column":1,"offset":777},"end":{"line":24,"column":37,"offset":813}}},{"type":"paragraph","children":[{"type":"text","value":"所以我们直接模拟一堆粒子从原点出发作随机行走，向两个方向的概率相同，扩散系数以及积分里的常数对齐，统计粒子在整个过程中出现在不同 x 位置的频率，求和之后乘以步长就是积分结果。这个过程需要的随机数发生器容易获取得多，是一个以 0.5 为阈值的 [0,1) 的均匀分布，比如一个均匀硬币。","position":{"start":{"line":26,"column":1,"offset":817},"end":{"line":26,"column":144,"offset":960}}}],"position":{"start":{"line":26,"column":1,"offset":817},"end":{"line":26,"column":144,"offset":960}}},{"type":"paragraph","children":[{"type":"text","value":"而随机行走过程中走完每一步的位置，都只取决于前一步的位置，而与更久远的历史无关——这样的过程叫做马尔可夫过程。用这种方法取样获得随机样本的蒙特卡洛模拟，就是 MCMC.","position":{"start":{"line":28,"column":1,"offset":964},"end":{"line":28,"column":85,"offset":1048}}}],"position":{"start":{"line":28,"column":1,"offset":964},"end":{"line":28,"column":85,"offset":1048}}},{"type":"paragraph","children":[{"type":"text","value":"扩散方程和随机行走只是 MCMC 的一个很特殊很特殊的例子，而对于一般的 MCMC 模拟，有以下通用的 Markov Chain 采样的算法：","position":{"start":{"line":30,"column":1,"offset":1052},"end":{"line":30,"column":72,"offset":1123}}}],"position":{"start":{"line":30,"column":1,"offset":1052},"end":{"line":30,"column":72,"offset":1123}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Metropolis-Hastings 算法","position":{"start":{"line":32,"column":5,"offset":1131},"end":{"line":32,"column":27,"offset":1153}}}],"position":{"start":{"line":32,"column":1,"offset":1127},"end":{"line":32,"column":27,"offset":1153}}},{"type":"paragraph","children":[{"type":"text","value":"已知一个随机变量 x, 和一个与目标概率分布 P(x) 成正比的函数 f(x)（不要求 f 归一化）","position":{"start":{"line":34,"column":1,"offset":1157},"end":{"line":34,"column":51,"offset":1207}}}],"position":{"start":{"line":34,"column":1,"offset":1157},"end":{"line":34,"column":51,"offset":1207}}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"初始化","position":{"start":{"line":36,"column":4,"offset":1214},"end":{"line":36,"column":7,"offset":1217}}}],"position":{"start":{"line":36,"column":4,"offset":1214},"end":{"line":36,"column":7,"offset":1217}}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"选定初始采样点 ","position":{"start":{"line":37,"column":8,"offset":1226},"end":{"line":37,"column":16,"offset":1234}}},{"type":"inlineMath","value":"x_0","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"x_0"}]},"position":{"start":{"line":37,"column":16,"offset":1234},"end":{"line":37,"column":23,"offset":1241}}}],"position":{"start":{"line":37,"column":8,"offset":1226},"end":{"line":37,"column":24,"offset":1242}}}],"position":{"start":{"line":37,"column":5,"offset":1223},"end":{"line":37,"column":24,"offset":1242}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"选定一个采样函数 proposal function，也就是在已知当前 x 的取值时，下一个 x’ 取值的概率分布 ","position":{"start":{"line":38,"column":8,"offset":1251},"end":{"line":38,"column":66,"offset":1309}}},{"type":"inlineMath","value":"g(x’\\vert x)","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"g(x’\\vert x)"}]},"position":{"start":{"line":38,"column":66,"offset":1309},"end":{"line":38,"column":82,"offset":1325}}},{"type":"text","value":"；其中对于 Metropolis 算法，这个采样函数是对称的：","position":{"start":{"line":38,"column":82,"offset":1325},"end":{"line":38,"column":113,"offset":1356}}},{"type":"inlineMath","value":"g(x’\\vert x)=g(x\\vert x’)","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"g(x’\\vert x)=g(x\\vert x’)"}]},"position":{"start":{"line":38,"column":113,"offset":1356},"end":{"line":38,"column":142,"offset":1385}}},{"type":"text","value":". 常用以两者之差为宗量的高斯函数。","position":{"start":{"line":38,"column":142,"offset":1385},"end":{"line":38,"column":160,"offset":1403}}}],"position":{"start":{"line":38,"column":8,"offset":1251},"end":{"line":38,"column":160,"offset":1403}}}],"position":{"start":{"line":38,"column":5,"offset":1248},"end":{"line":38,"column":160,"offset":1403}}}],"position":{"start":{"line":37,"column":5,"offset":1223},"end":{"line":38,"column":160,"offset":1403}}}],"position":{"start":{"line":36,"column":1,"offset":1211},"end":{"line":38,"column":160,"offset":1403}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"在得出 t 时刻的 ","position":{"start":{"line":39,"column":4,"offset":1408},"end":{"line":39,"column":14,"offset":1418}}},{"type":"inlineMath","value":"x_t","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"x_t"}]},"position":{"start":{"line":39,"column":14,"offset":1418},"end":{"line":39,"column":21,"offset":1425}}},{"type":"text","value":" 之后：","position":{"start":{"line":39,"column":21,"offset":1425},"end":{"line":39,"column":25,"offset":1429}}}],"position":{"start":{"line":39,"column":4,"offset":1408},"end":{"line":39,"column":25,"offset":1429}}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"根据 ","position":{"start":{"line":40,"column":8,"offset":1438},"end":{"line":40,"column":11,"offset":1441}}},{"type":"inlineMath","value":"g(x'\\vert x_t)","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"g(x'\\vert x_t)"}]},"position":{"start":{"line":40,"column":11,"offset":1441},"end":{"line":40,"column":29,"offset":1459}}},{"type":"text","value":" 抽样得到一个 x’","position":{"start":{"line":40,"column":29,"offset":1459},"end":{"line":40,"column":39,"offset":1469}}}],"position":{"start":{"line":40,"column":8,"offset":1438},"end":{"line":40,"column":39,"offset":1469}}}],"position":{"start":{"line":40,"column":5,"offset":1435},"end":{"line":40,"column":39,"offset":1469}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"计算 α = f(x’)/f(x) = P(x’)/P(x)","position":{"start":{"line":41,"column":8,"offset":1478},"end":{"line":41,"column":38,"offset":1508}}}],"position":{"start":{"line":41,"column":8,"offset":1478},"end":{"line":41,"column":38,"offset":1508}}}],"position":{"start":{"line":41,"column":5,"offset":1475},"end":{"line":41,"column":38,"offset":1508}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"决定是否将 x’ 加入样本","position":{"start":{"line":42,"column":8,"offset":1517},"end":{"line":42,"column":21,"offset":1530}}}],"position":{"start":{"line":42,"column":8,"offset":1517},"end":{"line":42,"column":21,"offset":1530}}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"如果 α ≥ 1, 直接加入","position":{"start":{"line":43,"column":12,"offset":1543},"end":{"line":43,"column":26,"offset":1557}}}],"position":{"start":{"line":43,"column":12,"offset":1543},"end":{"line":43,"column":26,"offset":1557}}}],"position":{"start":{"line":43,"column":9,"offset":1540},"end":{"line":43,"column":26,"offset":1557}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"如果 α < 1, 以 α 为概率加入","position":{"start":{"line":44,"column":12,"offset":1570},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":44,"column":12,"offset":1570},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":44,"column":9,"offset":1567},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":43,"column":9,"offset":1540},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":42,"column":5,"offset":1514},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":40,"column":5,"offset":1435},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":39,"column":1,"offset":1405},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":36,"column":1,"offset":1211},"end":{"line":44,"column":31,"offset":1589}}},{"type":"paragraph","children":[{"type":"text","value":"这种方法不保证采样的早期样本也符合目标概率分布，所以一般会抛弃最先加入的若干样本。","position":{"start":{"line":46,"column":1,"offset":1593},"end":{"line":46,"column":42,"offset":1634}}}],"position":{"start":{"line":46,"column":1,"offset":1593},"end":{"line":46,"column":42,"offset":1634}}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Gibbs 采样","position":{"start":{"line":48,"column":5,"offset":1642},"end":{"line":48,"column":13,"offset":1650}}}],"position":{"start":{"line":48,"column":1,"offset":1638},"end":{"line":48,"column":13,"offset":1650}}},{"type":"paragraph","children":[{"type":"text","value":"只是一种思路，不算是完整的算法。","position":{"start":{"line":50,"column":1,"offset":1654},"end":{"line":50,"column":17,"offset":1670}}}],"position":{"start":{"line":50,"column":1,"offset":1654},"end":{"line":50,"column":17,"offset":1670}}},{"type":"paragraph","children":[{"type":"text","value":"当被采样的随机变量是一个多维向量的情况，在不使用 Gibbs 采样的情况下，在迭代的某一步骤 t，每个分量都应该是前一步骤的函数：","position":{"start":{"line":52,"column":1,"offset":1674},"end":{"line":52,"column":66,"offset":1739}}},{"type":"inlineMath","value":"x_{i,t}=f(\\{x_{j,\\ t-1}\\})","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"x_{i,t}=f(\\{x_{j,\\ t-1}\\})"}]},"position":{"start":{"line":52,"column":66,"offset":1739},"end":{"line":52,"column":96,"offset":1769}}}],"position":{"start":{"line":52,"column":1,"offset":1674},"end":{"line":52,"column":96,"offset":1769}}},{"type":"paragraph","children":[{"type":"text","value":"而 Gibbs 采样就是说，不必让每个维度 i 都根据前一个步骤的分量来取值，可以把当前 t 已经取样出来的分量直接带入到本回合后面的维度：","position":{"start":{"line":54,"column":1,"offset":1773},"end":{"line":54,"column":71,"offset":1843}}},{"type":"inlineMath","value":"x_{i,t}=f(\\{x_{j,\\ t}\\}_{j<i}\\cup\\{x_{k,\\ t-1}\\}_{k\\ge i})","data":{"hName":"code","hProperties":{"className":["language-math","math-inline"]},"hChildren":[{"type":"text","value":"x_{i,t}=f(\\{x_{j,\\ t}\\}_{j<i}\\cup\\{x_{k,\\ t-1}\\}_{k\\ge i})"}]},"position":{"start":{"line":54,"column":71,"offset":1843},"end":{"line":54,"column":133,"offset":1905}}}],"position":{"start":{"line":54,"column":1,"offset":1773},"end":{"line":54,"column":133,"offset":1905}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":54,"column":133,"offset":1905}}},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Monte Carlo 蒙特卡洛模拟，简称 MC.","position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":26,"offset":27}}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":27,"offset":28}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Markov Chain Monte Carlo 是用马尔科夫链采样的蒙特卡洛模拟，简称 MCMC.","position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":51,"offset":82}}}],"position":{"start":{"line":4,"column":1,"offset":32},"end":{"line":4,"column":51,"offset":82}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"monte-carlo-模拟"},"children":[{"type":"element","tagName":"a","properties":{"href":"#monte-carlo-模拟"},"children":[{"type":"text","value":"Monte Carlo 模拟","position":{"start":{"line":6,"column":4,"offset":89},"end":{"line":6,"column":18,"offset":103}}}]}],"position":{"start":{"line":6,"column":1,"offset":86},"end":{"line":6,"column":18,"offset":103}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这个比较简单了，举个例子，要计算 π 的近似值，可以在一块正方形板子里画一个内接圆，然后以均匀的概率往正方形里一粒一粒地扔沙子，每扔一粒，就判断并且记录这里沙子在圆内还是圆外，然后把沙子吹掉，如此往复。圆的面积是 πr²，正方形的面积是 4r²，所以落在圆内的概率（圆内沙子的数量和总数的比值）乘 4，就是所求。","position":{"start":{"line":8,"column":1,"offset":107},"end":{"line":8,"column":157,"offset":263}}}],"position":{"start":{"line":8,"column":1,"offset":107},"end":{"line":8,"column":157,"offset":263}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"/blog/photos/2024-04-15-monte-carlo-pi.png","alt":""},"children":[],"position":{"start":{"line":10,"column":1,"offset":267},"end":{"line":10,"column":48,"offset":314}}}],"position":{"start":{"line":10,"column":1,"offset":267},"end":{"line":10,"column":48,"offset":314}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"归纳一下：当问题的解用一个随机变量的概率分布、期望值、二阶矩……等等来表示的时候，就生成一个符合该概率分布的随机样本，用样本的统计量去近似原概率分布。","position":{"start":{"line":12,"column":1,"offset":318},"end":{"line":12,"column":76,"offset":393}}}],"position":{"start":{"line":12,"column":1,"offset":318},"end":{"line":12,"column":76,"offset":393}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"markov-chain-monte-carlo"},"children":[{"type":"element","tagName":"a","properties":{"href":"#markov-chain-monte-carlo"},"children":[{"type":"text","value":"Markov Chain Monte Carlo","position":{"start":{"line":14,"column":4,"offset":400},"end":{"line":14,"column":28,"offset":424}}}]}],"position":{"start":{"line":14,"column":1,"offset":397},"end":{"line":14,"column":28,"offset":424}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"但是前述例子有一个步骤，就是我们往板子上扔完沙子要把沙子吹掉，每粒沙子，每次扔沙子之间也应该看不出区别，这是为了保证取样之间","position":{"start":{"line":16,"column":1,"offset":428},"end":{"line":16,"column":63,"offset":490}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"相互独立且来自同一个概率分布","position":{"start":{"line":16,"column":65,"offset":492},"end":{"line":16,"column":79,"offset":506}}}],"position":{"start":{"line":16,"column":63,"offset":490},"end":{"line":16,"column":81,"offset":508}}},{"type":"text","value":"。","position":{"start":{"line":16,"column":81,"offset":508},"end":{"line":16,"column":82,"offset":509}}}],"position":{"start":{"line":16,"column":1,"offset":428},"end":{"line":16,"column":82,"offset":509}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"但是很多取样过程无法满足这种条件，或者达成条件所需的成本很高。比如计算一个高斯积分 ","position":{"start":{"line":18,"column":1,"offset":513},"end":{"line":18,"column":43,"offset":555}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msubsup","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"∫"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∞"}]}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∞"}]}]}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]}]}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"\\int_{-\\infty}^{+\\infty}e^{-x^2}dx"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.4011em;vertical-align:-0.4142em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mop"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mop","op-symbol","small-op"],"style":"margin-right:0.19445em;position:relative;top:-0.0006em;"},"children":[{"type":"text","value":"∫"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.9662em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"∞"}]}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.2579em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"∞"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.4142em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.1667em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.9869em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8913em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.931em;margin-right:0.0714em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size3","size1","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"text","value":"，被积函数的取值范围涵盖整个实数集，想找一个在整个实数集上均匀分布的随机数发生器就比较难了。","position":{"start":{"line":18,"column":81,"offset":593},"end":{"line":18,"column":127,"offset":639}}}],"position":{"start":{"line":18,"column":1,"offset":513},"end":{"line":18,"column":127,"offset":639}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"/blog/photos/2024-04-15-monte-carlo-gaussian.png","alt":""},"children":[],"position":{"start":{"line":20,"column":1,"offset":643},"end":{"line":20,"column":54,"offset":696}}}],"position":{"start":{"line":20,"column":1,"offset":643},"end":{"line":20,"column":54,"offset":696}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"但是学过物理的朋友应该知道，上面的被积函数是以狄拉克 δ(x) 函数为初值条件的一个扩散方程的解，在某一时刻的空间分布。（不想凑系数了，将就看吧）","position":{"start":{"line":22,"column":1,"offset":700},"end":{"line":22,"column":74,"offset":773}}}],"position":{"start":{"line":22,"column":1,"offset":700},"end":{"line":22,"column":74,"offset":773}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"而扩散方程又是随机游走 (random walk) 在连续近似下的极限。","position":{"start":{"line":24,"column":1,"offset":777},"end":{"line":24,"column":37,"offset":813}}}],"position":{"start":{"line":24,"column":1,"offset":777},"end":{"line":24,"column":37,"offset":813}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"所以我们直接模拟一堆粒子从原点出发作随机行走，向两个方向的概率相同，扩散系数以及积分里的常数对齐，统计粒子在整个过程中出现在不同 x 位置的频率，求和之后乘以步长就是积分结果。这个过程需要的随机数发生器容易获取得多，是一个以 0.5 为阈值的 [0,1) 的均匀分布，比如一个均匀硬币。","position":{"start":{"line":26,"column":1,"offset":817},"end":{"line":26,"column":144,"offset":960}}}],"position":{"start":{"line":26,"column":1,"offset":817},"end":{"line":26,"column":144,"offset":960}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"而随机行走过程中走完每一步的位置，都只取决于前一步的位置，而与更久远的历史无关——这样的过程叫做马尔可夫过程。用这种方法取样获得随机样本的蒙特卡洛模拟，就是 MCMC.","position":{"start":{"line":28,"column":1,"offset":964},"end":{"line":28,"column":85,"offset":1048}}}],"position":{"start":{"line":28,"column":1,"offset":964},"end":{"line":28,"column":85,"offset":1048}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"扩散方程和随机行走只是 MCMC 的一个很特殊很特殊的例子，而对于一般的 MCMC 模拟，有以下通用的 Markov Chain 采样的算法：","position":{"start":{"line":30,"column":1,"offset":1052},"end":{"line":30,"column":72,"offset":1123}}}],"position":{"start":{"line":30,"column":1,"offset":1052},"end":{"line":30,"column":72,"offset":1123}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"metropolis-hastings-算法"},"children":[{"type":"element","tagName":"a","properties":{"href":"#metropolis-hastings-算法"},"children":[{"type":"text","value":"Metropolis-Hastings 算法","position":{"start":{"line":32,"column":5,"offset":1131},"end":{"line":32,"column":27,"offset":1153}}}]}],"position":{"start":{"line":32,"column":1,"offset":1127},"end":{"line":32,"column":27,"offset":1153}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"已知一个随机变量 x, 和一个与目标概率分布 P(x) 成正比的函数 f(x)（不要求 f 归一化）","position":{"start":{"line":34,"column":1,"offset":1157},"end":{"line":34,"column":51,"offset":1207}}}],"position":{"start":{"line":34,"column":1,"offset":1157},"end":{"line":34,"column":51,"offset":1207}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"初始化","position":{"start":{"line":36,"column":4,"offset":1214},"end":{"line":36,"column":7,"offset":1217}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"选定初始采样点 ","position":{"start":{"line":37,"column":8,"offset":1226},"end":{"line":37,"column":16,"offset":1234}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x_0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.5806em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3011em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]}],"position":{"start":{"line":37,"column":5,"offset":1223},"end":{"line":37,"column":24,"offset":1242}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"选定一个采样函数 proposal function，也就是在已知当前 x 的取值时，下一个 x’ 取值的概率分布 ","position":{"start":{"line":38,"column":8,"offset":1251},"end":{"line":38,"column":66,"offset":1309}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mtext","properties":{},"children":[{"type":"text","value":"’"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"g(x’\\vert x)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"’∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"；其中对于 Metropolis 算法，这个采样函数是对称的：","position":{"start":{"line":38,"column":82,"offset":1325},"end":{"line":38,"column":113,"offset":1356}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mtext","properties":{},"children":[{"type":"text","value":"’"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mtext","properties":{},"children":[{"type":"text","value":"’"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"g(x’\\vert x)=g(x\\vert x’)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"’∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"’"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":". 常用以两者之差为宗量的高斯函数。","position":{"start":{"line":38,"column":142,"offset":1385},"end":{"line":38,"column":160,"offset":1403}}}],"position":{"start":{"line":38,"column":5,"offset":1248},"end":{"line":38,"column":160,"offset":1403}}},{"type":"text","value":"\n"}],"position":{"start":{"line":37,"column":5,"offset":1223},"end":{"line":38,"column":160,"offset":1403}}},{"type":"text","value":"\n"}],"position":{"start":{"line":36,"column":1,"offset":1211},"end":{"line":38,"column":160,"offset":1403}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"在得出 t 时刻的 ","position":{"start":{"line":39,"column":4,"offset":1408},"end":{"line":39,"column":14,"offset":1418}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x_t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.5806em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2806em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]},{"type":"text","value":" 之后：","position":{"start":{"line":39,"column":21,"offset":1425},"end":{"line":39,"column":25,"offset":1429}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"根据 ","position":{"start":{"line":40,"column":8,"offset":1438},"end":{"line":40,"column":11,"offset":1441}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{"mathvariant":"normal","lspace":"0em","rspace":"0em"},"children":[{"type":"text","value":"′"}]}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"g(x'\\vert x_t)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.0019em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.7519em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"′"}]}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2806em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" 抽样得到一个 x’","position":{"start":{"line":40,"column":29,"offset":1459},"end":{"line":40,"column":39,"offset":1469}}}],"position":{"start":{"line":40,"column":5,"offset":1435},"end":{"line":40,"column":39,"offset":1469}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"计算 α = f(x’)/f(x) = P(x’)/P(x)","position":{"start":{"line":41,"column":8,"offset":1478},"end":{"line":41,"column":38,"offset":1508}}}],"position":{"start":{"line":41,"column":5,"offset":1475},"end":{"line":41,"column":38,"offset":1508}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"决定是否将 x’ 加入样本","position":{"start":{"line":42,"column":8,"offset":1517},"end":{"line":42,"column":21,"offset":1530}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果 α ≥ 1, 直接加入","position":{"start":{"line":43,"column":12,"offset":1543},"end":{"line":43,"column":26,"offset":1557}}}],"position":{"start":{"line":43,"column":9,"offset":1540},"end":{"line":43,"column":26,"offset":1557}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果 α < 1, 以 α 为概率加入","position":{"start":{"line":44,"column":12,"offset":1570},"end":{"line":44,"column":31,"offset":1589}}}],"position":{"start":{"line":44,"column":9,"offset":1567},"end":{"line":44,"column":31,"offset":1589}}},{"type":"text","value":"\n"}],"position":{"start":{"line":43,"column":9,"offset":1540},"end":{"line":44,"column":31,"offset":1589}}},{"type":"text","value":"\n"}],"position":{"start":{"line":42,"column":5,"offset":1514},"end":{"line":44,"column":31,"offset":1589}}},{"type":"text","value":"\n"}],"position":{"start":{"line":40,"column":5,"offset":1435},"end":{"line":44,"column":31,"offset":1589}}},{"type":"text","value":"\n"}],"position":{"start":{"line":39,"column":1,"offset":1405},"end":{"line":44,"column":31,"offset":1589}}},{"type":"text","value":"\n"}],"position":{"start":{"line":36,"column":1,"offset":1211},"end":{"line":44,"column":31,"offset":1589}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这种方法不保证采样的早期样本也符合目标概率分布，所以一般会抛弃最先加入的若干样本。","position":{"start":{"line":46,"column":1,"offset":1593},"end":{"line":46,"column":42,"offset":1634}}}],"position":{"start":{"line":46,"column":1,"offset":1593},"end":{"line":46,"column":42,"offset":1634}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"gibbs-采样"},"children":[{"type":"element","tagName":"a","properties":{"href":"#gibbs-采样"},"children":[{"type":"text","value":"Gibbs 采样","position":{"start":{"line":48,"column":5,"offset":1642},"end":{"line":48,"column":13,"offset":1650}}}]}],"position":{"start":{"line":48,"column":1,"offset":1638},"end":{"line":48,"column":13,"offset":1650}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"只是一种思路，不算是完整的算法。","position":{"start":{"line":50,"column":1,"offset":1654},"end":{"line":50,"column":17,"offset":1670}}}],"position":{"start":{"line":50,"column":1,"offset":1654},"end":{"line":50,"column":17,"offset":1670}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"当被采样的随机变量是一个多维向量的情况，在不使用 Gibbs 采样的情况下，在迭代的某一步骤 t，每个分量都应该是前一步骤的函数：","position":{"start":{"line":52,"column":1,"offset":1674},"end":{"line":52,"column":66,"offset":1739}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"j"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mtext","properties":{},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x_{i,t}=f(\\{x_{j,\\ t-1}\\})"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.7167em;vertical-align:-0.2861em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3117em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct","mtight"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2861em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.0361em;vertical-align:-0.2861em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"],"style":"margin-right:0.10764em;"},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"({"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3117em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"],"style":"margin-right:0.05724em;"},"children":[{"type":"text","value":"j"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct","mtight"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtight"]},"children":[{"type":"text","value":" "}]}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mbin","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2861em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":"})"}]}]}]}]}],"position":{"start":{"line":52,"column":1,"offset":1674},"end":{"line":52,"column":96,"offset":1769}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"而 Gibbs 采样就是说，不必让每个维度 i 都根据前一个步骤的分量来取值，可以把当前 t 已经取样出来的分量直接带入到本回合后面的维度：","position":{"start":{"line":54,"column":1,"offset":1773},"end":{"line":54,"column":71,"offset":1843}}},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{"xmlns":"http://www.w3.org/1998/Math/MathML"},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"j"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mtext","properties":{},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"j"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"i"}]}]}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"∪"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"k"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mtext","properties":{},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"k"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≥"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"i"}]}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x_{i,t}=f(\\{x_{j,\\ t}\\}_{j<i}\\cup\\{x_{k,\\ t-1}\\}_{k\\ge i})"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.7167em;vertical-align:-0.2861em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3117em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct","mtight"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2861em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.0361em;vertical-align:-0.2861em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"],"style":"margin-right:0.10764em;"},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"({"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3117em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"],"style":"margin-right:0.05724em;"},"children":[{"type":"text","value":"j"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct","mtight"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtight"]},"children":[{"type":"text","value":" "}]}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2861em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3117em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"],"style":"margin-right:0.05724em;"},"children":[{"type":"text","value":"j"}]},{"type":"element","tagName":"span","properties":{"className":["mrel","mtight"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"i"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2861em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"∪"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.0361em;vertical-align:-0.2861em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3361em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"],"style":"margin-right:0.03148em;"},"children":[{"type":"text","value":"k"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct","mtight"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtight"]},"children":[{"type":"text","value":" "}]}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mbin","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2861em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.3361em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.55em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"],"style":"margin-right:0.03148em;"},"children":[{"type":"text","value":"k"}]},{"type":"element","tagName":"span","properties":{"className":["mrel","mtight"]},"children":[{"type":"text","value":"≥"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathnormal","mtight"]},"children":[{"type":"text","value":"i"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2452em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]}],"position":{"start":{"line":54,"column":1,"offset":1773},"end":{"line":54,"column":133,"offset":1905}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":54,"column":133,"offset":1905}}}},"__N_SSG":true}