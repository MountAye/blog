{"pageProps":{"metadata":{"slug":"python-subprocess-run-bash","date":"2022-07-08","title":".py | python.subprocess执行bash命令","filename":"2022-07-08-python-subprocess-run-bash.md","url":"python-subprocess-run-bash","layout":"post","keywords":["md","py"],"excerpt":"让 python 读 bash 的命令结果，写 bash 的命令语句。","content":"\r\n笔记本的触摸屏被我摔了道裂纹，一开始还不影响使用，但是最近几周情况恶化，有时鼠标光标会突然暴走，不听指挥。所以需要禁用触摸屏作为输入设备。\r\n\r\n在 xorg 的桌面环境之下，可以用 `xinput list` 显示出所有输入设备，以及对应的 id 号码。然后把找到的 id 填入 `xinput disable ##` 就可以了。一般来说这个 id 的数值是稳定的，所以我就直接把禁用命令写到 `~/.bashrc` 里面去了。\r\n\r\n然而，最近把吃灰很久的树莓派拿出来玩了，所以败家买了个60%布局的小机械键盘，小键盘往笔记本一插，诶，您猜怎么着，新买的键盘输完密码登陆之后就不能用了，着实吓了一跳。\r\n\r\n所以需要每次检查一遍输入设备的 id，然后把和触摸屏有关的 id（不止一个）从 `xinput list` 的输出里摘出来赋值给一个变量，然后把变量带入 `xinput disable #` 里面。这一套操作已经超出我的 bash 能力了，所以考虑用 python 完成中间步骤，也就是需要让 python 读 bash 的命令结果，写 bash 的命令语句。\r\n\r\nGoogles搜索给到了这个结果：[https://stackoverflow.com/questions/4256107/running-bash-commands-in-python](https://stackoverflow.com/questions/4256107/running-bash-commands-in-python)，稍微看了一下 subprocess 的官方文档，写了下面的一段，存到 `~/disable_touchscreen.py`, 然后在 `~/.bashrc` 里加一句 `python ~/disable_touchscreen.py`\r\n\r\n```python\r\nimport subprocess\r\ncheck = subprcess.run([\"xinput\",\"list\"],capture_output=True)\r\nfor line in check.stdout.decode(\"utf-8\").split(\"\\n\"):\r\n    if \"touchscreen\" in line:\r\n        device = line.partition(\"id=\")[2].partition(\"\\t\")[0]\r\n        disable = subprocess.run([\"xinput\",\"disable\",str(device)])\r\n        if disable.returncode==0:\r\n            print(f\"Successfully disabled touchscreen device {device}\")\r\n        else:\r\n            print(f\"Failed to disable touchscreen device {device}\")\r\n```\r\n\r\n- 这段代码的核心是 `subprocess.run()` ，第一个参数就是传给 bash 的命令，这是一个list，其中每个元素就是 bash 语句用空格分割开的每一部分。要想得到命令的执行结果，需要添加参数 `capture_output=True`\r\n- 上面函数的返回值是一个特殊的数据结构，命令顺利执行的话，结果会写在 `.stdout` 里，这是一个二进制串 `b'xxx...'`，所以需要 `.decode(\"utf-8\")` 转化成字符串。\r\n\r\n如果只用bash的话，\r\n\r\n- 我的 bash 水平可以做到 `xinput list | grep \"touchscreen\"`, 这里的 `|` 是一个管道，也就是将前一条命令的输出传递给后一条作为输入。要想在 python 里使用管道，可以看这个问答：[https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes](https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes)\r\n- 上面管道的结果还需要裁剪出 id 号，也就是 `line.partition(\"id=\")[2].partition(\"\\t\")[0]`，估计需要用到 awk, 虽然难，但可以学，至少知道该学什么；\r\n- 但是把 id 号传递给一个变量，然后把这个变量填进 `xinput disable`, 这一步就连该学什么也不知道了。\r\n"},"mdAst":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"笔记本的触摸屏被我摔了道裂纹，一开始还不影响使用，但是最近几周情况恶化，有时鼠标光标会突然暴走，不听指挥。所以需要禁用触摸屏作为输入设备。","position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":70,"offset":71}}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":70,"offset":71}}},{"type":"paragraph","children":[{"type":"text","value":"在 xorg 的桌面环境之下，可以用 ","position":{"start":{"line":4,"column":1,"offset":75},"end":{"line":4,"column":20,"offset":94}}},{"type":"inlineCode","value":"xinput list","position":{"start":{"line":4,"column":20,"offset":94},"end":{"line":4,"column":33,"offset":107}}},{"type":"text","value":" 显示出所有输入设备，以及对应的 id 号码。然后把找到的 id 填入 ","position":{"start":{"line":4,"column":33,"offset":107},"end":{"line":4,"column":69,"offset":143}}},{"type":"inlineCode","value":"xinput disable ##","position":{"start":{"line":4,"column":69,"offset":143},"end":{"line":4,"column":88,"offset":162}}},{"type":"text","value":" 就可以了。一般来说这个 id 的数值是稳定的，所以我就直接把禁用命令写到 ","position":{"start":{"line":4,"column":88,"offset":162},"end":{"line":4,"column":126,"offset":200}}},{"type":"inlineCode","value":"~/.bashrc","position":{"start":{"line":4,"column":126,"offset":200},"end":{"line":4,"column":137,"offset":211}}},{"type":"text","value":" 里面去了。","position":{"start":{"line":4,"column":137,"offset":211},"end":{"line":4,"column":143,"offset":217}}}],"position":{"start":{"line":4,"column":1,"offset":75},"end":{"line":4,"column":143,"offset":217}}},{"type":"paragraph","children":[{"type":"text","value":"然而，最近把吃灰很久的树莓派拿出来玩了，所以败家买了个60%布局的小机械键盘，小键盘往笔记本一插，诶，您猜怎么着，新买的键盘输完密码登陆之后就不能用了，着实吓了一跳。","position":{"start":{"line":6,"column":1,"offset":221},"end":{"line":6,"column":84,"offset":304}}}],"position":{"start":{"line":6,"column":1,"offset":221},"end":{"line":6,"column":84,"offset":304}}},{"type":"paragraph","children":[{"type":"text","value":"所以需要每次检查一遍输入设备的 id，然后把和触摸屏有关的 id（不止一个）从 ","position":{"start":{"line":8,"column":1,"offset":308},"end":{"line":8,"column":41,"offset":348}}},{"type":"inlineCode","value":"xinput list","position":{"start":{"line":8,"column":41,"offset":348},"end":{"line":8,"column":54,"offset":361}}},{"type":"text","value":" 的输出里摘出来赋值给一个变量，然后把变量带入 ","position":{"start":{"line":8,"column":54,"offset":361},"end":{"line":8,"column":78,"offset":385}}},{"type":"inlineCode","value":"xinput disable #","position":{"start":{"line":8,"column":78,"offset":385},"end":{"line":8,"column":96,"offset":403}}},{"type":"text","value":" 里面。这一套操作已经超出我的 bash 能力了，所以考虑用 python 完成中间步骤，也就是需要让 python 读 bash 的命令结果，写 bash 的命令语句。","position":{"start":{"line":8,"column":96,"offset":403},"end":{"line":8,"column":181,"offset":488}}}],"position":{"start":{"line":8,"column":1,"offset":308},"end":{"line":8,"column":181,"offset":488}}},{"type":"paragraph","children":[{"type":"text","value":"Googles搜索给到了这个结果：","position":{"start":{"line":10,"column":1,"offset":492},"end":{"line":10,"column":18,"offset":509}}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python","children":[{"type":"text","value":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python","position":{"start":{"line":10,"column":19,"offset":510},"end":{"line":10,"column":94,"offset":585}}}],"position":{"start":{"line":10,"column":18,"offset":509},"end":{"line":10,"column":172,"offset":663}}},{"type":"text","value":"，稍微看了一下 subprocess 的官方文档，写了下面的一段，存到 ","position":{"start":{"line":10,"column":172,"offset":663},"end":{"line":10,"column":208,"offset":699}}},{"type":"inlineCode","value":"~/disable_touchscreen.py","position":{"start":{"line":10,"column":208,"offset":699},"end":{"line":10,"column":234,"offset":725}}},{"type":"text","value":", 然后在 ","position":{"start":{"line":10,"column":234,"offset":725},"end":{"line":10,"column":240,"offset":731}}},{"type":"inlineCode","value":"~/.bashrc","position":{"start":{"line":10,"column":240,"offset":731},"end":{"line":10,"column":251,"offset":742}}},{"type":"text","value":" 里加一句 ","position":{"start":{"line":10,"column":251,"offset":742},"end":{"line":10,"column":257,"offset":748}}},{"type":"inlineCode","value":"python ~/disable_touchscreen.py","position":{"start":{"line":10,"column":257,"offset":748},"end":{"line":10,"column":290,"offset":781}}}],"position":{"start":{"line":10,"column":1,"offset":492},"end":{"line":10,"column":290,"offset":781}}},{"type":"code","lang":"python","meta":null,"value":"import subprocess\r\ncheck = subprcess.run([\"xinput\",\"list\"],capture_output=True)\r\nfor line in check.stdout.decode(\"utf-8\").split(\"\\n\"):\r\n    if \"touchscreen\" in line:\r\n        device = line.partition(\"id=\")[2].partition(\"\\t\")[0]\r\n        disable = subprocess.run([\"xinput\",\"disable\",str(device)])\r\n        if disable.returncode==0:\r\n            print(f\"Successfully disabled touchscreen device {device}\")\r\n        else:\r\n            print(f\"Failed to disable touchscreen device {device}\")","position":{"start":{"line":12,"column":1,"offset":785},"end":{"line":23,"column":4,"offset":1288}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"这段代码的核心是 ","position":{"start":{"line":25,"column":3,"offset":1294},"end":{"line":25,"column":12,"offset":1303}}},{"type":"inlineCode","value":"subprocess.run()","position":{"start":{"line":25,"column":12,"offset":1303},"end":{"line":25,"column":30,"offset":1321}}},{"type":"text","value":" ，第一个参数就是传给 bash 的命令，这是一个list，其中每个元素就是 bash 语句用空格分割开的每一部分。要想得到命令的执行结果，需要添加参数 ","position":{"start":{"line":25,"column":30,"offset":1321},"end":{"line":25,"column":107,"offset":1398}}},{"type":"inlineCode","value":"capture_output=True","position":{"start":{"line":25,"column":107,"offset":1398},"end":{"line":25,"column":128,"offset":1419}}}],"position":{"start":{"line":25,"column":3,"offset":1294},"end":{"line":25,"column":128,"offset":1419}}}],"position":{"start":{"line":25,"column":1,"offset":1292},"end":{"line":25,"column":128,"offset":1419}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"上面函数的返回值是一个特殊的数据结构，命令顺利执行的话，结果会写在 ","position":{"start":{"line":26,"column":3,"offset":1423},"end":{"line":26,"column":37,"offset":1457}}},{"type":"inlineCode","value":".stdout","position":{"start":{"line":26,"column":37,"offset":1457},"end":{"line":26,"column":46,"offset":1466}}},{"type":"text","value":" 里，这是一个二进制串 ","position":{"start":{"line":26,"column":46,"offset":1466},"end":{"line":26,"column":58,"offset":1478}}},{"type":"inlineCode","value":"b'xxx...'","position":{"start":{"line":26,"column":58,"offset":1478},"end":{"line":26,"column":69,"offset":1489}}},{"type":"text","value":"，所以需要 ","position":{"start":{"line":26,"column":69,"offset":1489},"end":{"line":26,"column":75,"offset":1495}}},{"type":"inlineCode","value":".decode(\"utf-8\")","position":{"start":{"line":26,"column":75,"offset":1495},"end":{"line":26,"column":93,"offset":1513}}},{"type":"text","value":" 转化成字符串。","position":{"start":{"line":26,"column":93,"offset":1513},"end":{"line":26,"column":101,"offset":1521}}}],"position":{"start":{"line":26,"column":3,"offset":1423},"end":{"line":26,"column":101,"offset":1521}}}],"position":{"start":{"line":26,"column":1,"offset":1421},"end":{"line":26,"column":101,"offset":1521}}}],"position":{"start":{"line":25,"column":1,"offset":1292},"end":{"line":26,"column":101,"offset":1521}}},{"type":"paragraph","children":[{"type":"text","value":"如果只用bash的话，","position":{"start":{"line":28,"column":1,"offset":1525},"end":{"line":28,"column":12,"offset":1536}}}],"position":{"start":{"line":28,"column":1,"offset":1525},"end":{"line":28,"column":12,"offset":1536}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"我的 bash 水平可以做到 ","position":{"start":{"line":30,"column":3,"offset":1542},"end":{"line":30,"column":18,"offset":1557}}},{"type":"inlineCode","value":"xinput list | grep \"touchscreen\"","position":{"start":{"line":30,"column":18,"offset":1557},"end":{"line":30,"column":52,"offset":1591}}},{"type":"text","value":", 这里的 ","position":{"start":{"line":30,"column":52,"offset":1591},"end":{"line":30,"column":58,"offset":1597}}},{"type":"inlineCode","value":"|","position":{"start":{"line":30,"column":58,"offset":1597},"end":{"line":30,"column":61,"offset":1600}}},{"type":"text","value":" 是一个管道，也就是将前一条命令的输出传递给后一条作为输入。要想在 python 里使用管道，可以看这个问答：","position":{"start":{"line":30,"column":61,"offset":1600},"end":{"line":30,"column":116,"offset":1655}}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes","children":[{"type":"text","value":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes","position":{"start":{"line":30,"column":117,"offset":1656},"end":{"line":30,"column":202,"offset":1741}}}],"position":{"start":{"line":30,"column":116,"offset":1655},"end":{"line":30,"column":290,"offset":1829}}}],"position":{"start":{"line":30,"column":3,"offset":1542},"end":{"line":30,"column":290,"offset":1829}}}],"position":{"start":{"line":30,"column":1,"offset":1540},"end":{"line":30,"column":290,"offset":1829}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"上面管道的结果还需要裁剪出 id 号，也就是 ","position":{"start":{"line":31,"column":3,"offset":1833},"end":{"line":31,"column":26,"offset":1856}}},{"type":"inlineCode","value":"line.partition(\"id=\")[2].partition(\"\\t\")[0]","position":{"start":{"line":31,"column":26,"offset":1856},"end":{"line":31,"column":71,"offset":1901}}},{"type":"text","value":"，估计需要用到 awk, 虽然难，但可以学，至少知道该学什么；","position":{"start":{"line":31,"column":71,"offset":1901},"end":{"line":31,"column":102,"offset":1932}}}],"position":{"start":{"line":31,"column":3,"offset":1833},"end":{"line":31,"column":102,"offset":1932}}}],"position":{"start":{"line":31,"column":1,"offset":1831},"end":{"line":31,"column":102,"offset":1932}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"但是把 id 号传递给一个变量，然后把这个变量填进 ","position":{"start":{"line":32,"column":3,"offset":1936},"end":{"line":32,"column":29,"offset":1962}}},{"type":"inlineCode","value":"xinput disable","position":{"start":{"line":32,"column":29,"offset":1962},"end":{"line":32,"column":45,"offset":1978}}},{"type":"text","value":", 这一步就连该学什么也不知道了。","position":{"start":{"line":32,"column":45,"offset":1978},"end":{"line":32,"column":62,"offset":1995}}}],"position":{"start":{"line":32,"column":3,"offset":1936},"end":{"line":32,"column":62,"offset":1995}}}],"position":{"start":{"line":32,"column":1,"offset":1934},"end":{"line":32,"column":62,"offset":1995}}}],"position":{"start":{"line":30,"column":1,"offset":1540},"end":{"line":32,"column":62,"offset":1995}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":33,"column":1,"offset":1997}}},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"笔记本的触摸屏被我摔了道裂纹，一开始还不影响使用，但是最近几周情况恶化，有时鼠标光标会突然暴走，不听指挥。所以需要禁用触摸屏作为输入设备。","position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":70,"offset":71}}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":70,"offset":71}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 xorg 的桌面环境之下，可以用 ","position":{"start":{"line":4,"column":1,"offset":75},"end":{"line":4,"column":20,"offset":94}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput list","position":{"start":{"line":4,"column":20,"offset":94},"end":{"line":4,"column":33,"offset":107}}}],"position":{"start":{"line":4,"column":20,"offset":94},"end":{"line":4,"column":33,"offset":107}}},{"type":"text","value":" 显示出所有输入设备，以及对应的 id 号码。然后把找到的 id 填入 ","position":{"start":{"line":4,"column":33,"offset":107},"end":{"line":4,"column":69,"offset":143}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput disable ##","position":{"start":{"line":4,"column":69,"offset":143},"end":{"line":4,"column":88,"offset":162}}}],"position":{"start":{"line":4,"column":69,"offset":143},"end":{"line":4,"column":88,"offset":162}}},{"type":"text","value":" 就可以了。一般来说这个 id 的数值是稳定的，所以我就直接把禁用命令写到 ","position":{"start":{"line":4,"column":88,"offset":162},"end":{"line":4,"column":126,"offset":200}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"~/.bashrc","position":{"start":{"line":4,"column":126,"offset":200},"end":{"line":4,"column":137,"offset":211}}}],"position":{"start":{"line":4,"column":126,"offset":200},"end":{"line":4,"column":137,"offset":211}}},{"type":"text","value":" 里面去了。","position":{"start":{"line":4,"column":137,"offset":211},"end":{"line":4,"column":143,"offset":217}}}],"position":{"start":{"line":4,"column":1,"offset":75},"end":{"line":4,"column":143,"offset":217}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"然而，最近把吃灰很久的树莓派拿出来玩了，所以败家买了个60%布局的小机械键盘，小键盘往笔记本一插，诶，您猜怎么着，新买的键盘输完密码登陆之后就不能用了，着实吓了一跳。","position":{"start":{"line":6,"column":1,"offset":221},"end":{"line":6,"column":84,"offset":304}}}],"position":{"start":{"line":6,"column":1,"offset":221},"end":{"line":6,"column":84,"offset":304}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"所以需要每次检查一遍输入设备的 id，然后把和触摸屏有关的 id（不止一个）从 ","position":{"start":{"line":8,"column":1,"offset":308},"end":{"line":8,"column":41,"offset":348}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput list","position":{"start":{"line":8,"column":41,"offset":348},"end":{"line":8,"column":54,"offset":361}}}],"position":{"start":{"line":8,"column":41,"offset":348},"end":{"line":8,"column":54,"offset":361}}},{"type":"text","value":" 的输出里摘出来赋值给一个变量，然后把变量带入 ","position":{"start":{"line":8,"column":54,"offset":361},"end":{"line":8,"column":78,"offset":385}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput disable #","position":{"start":{"line":8,"column":78,"offset":385},"end":{"line":8,"column":96,"offset":403}}}],"position":{"start":{"line":8,"column":78,"offset":385},"end":{"line":8,"column":96,"offset":403}}},{"type":"text","value":" 里面。这一套操作已经超出我的 bash 能力了，所以考虑用 python 完成中间步骤，也就是需要让 python 读 bash 的命令结果，写 bash 的命令语句。","position":{"start":{"line":8,"column":96,"offset":403},"end":{"line":8,"column":181,"offset":488}}}],"position":{"start":{"line":8,"column":1,"offset":308},"end":{"line":8,"column":181,"offset":488}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Googles搜索给到了这个结果：","position":{"start":{"line":10,"column":1,"offset":492},"end":{"line":10,"column":18,"offset":509}}},{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python"},"children":[{"type":"text","value":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python","position":{"start":{"line":10,"column":19,"offset":510},"end":{"line":10,"column":94,"offset":585}}}],"position":{"start":{"line":10,"column":18,"offset":509},"end":{"line":10,"column":172,"offset":663}}},{"type":"text","value":"，稍微看了一下 subprocess 的官方文档，写了下面的一段，存到 ","position":{"start":{"line":10,"column":172,"offset":663},"end":{"line":10,"column":208,"offset":699}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"~/disable_touchscreen.py","position":{"start":{"line":10,"column":208,"offset":699},"end":{"line":10,"column":234,"offset":725}}}],"position":{"start":{"line":10,"column":208,"offset":699},"end":{"line":10,"column":234,"offset":725}}},{"type":"text","value":", 然后在 ","position":{"start":{"line":10,"column":234,"offset":725},"end":{"line":10,"column":240,"offset":731}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"~/.bashrc","position":{"start":{"line":10,"column":240,"offset":731},"end":{"line":10,"column":251,"offset":742}}}],"position":{"start":{"line":10,"column":240,"offset":731},"end":{"line":10,"column":251,"offset":742}}},{"type":"text","value":" 里加一句 ","position":{"start":{"line":10,"column":251,"offset":742},"end":{"line":10,"column":257,"offset":748}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python ~/disable_touchscreen.py","position":{"start":{"line":10,"column":257,"offset":748},"end":{"line":10,"column":290,"offset":781}}}],"position":{"start":{"line":10,"column":257,"offset":748},"end":{"line":10,"column":290,"offset":781}}}],"position":{"start":{"line":10,"column":1,"offset":492},"end":{"line":10,"column":290,"offset":781}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" subprocess"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"check "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" subprcess.run(["}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"xinput\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"list\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"],"}]},{"type":"element","tagName":"span","properties":{"style":"color:#E36209;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"capture_output"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"True"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" line "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" check.stdout.decode("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"utf-8\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":").split("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"):"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"touchscreen\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" line:"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        device "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" line.partition("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"id=\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")["}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"].partition("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"\\t"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")["}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        disable "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" subprocess.run(["}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"xinput\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"disable\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"str"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(device)])"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" disable.returncode"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":":"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"            print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Successfully disabled touchscreen device "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"device"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        else"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":":"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"            print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Failed to disable touchscreen device "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"device"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这段代码的核心是 ","position":{"start":{"line":25,"column":3,"offset":1294},"end":{"line":25,"column":12,"offset":1303}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"subprocess.run()","position":{"start":{"line":25,"column":12,"offset":1303},"end":{"line":25,"column":30,"offset":1321}}}],"position":{"start":{"line":25,"column":12,"offset":1303},"end":{"line":25,"column":30,"offset":1321}}},{"type":"text","value":" ，第一个参数就是传给 bash 的命令，这是一个list，其中每个元素就是 bash 语句用空格分割开的每一部分。要想得到命令的执行结果，需要添加参数 ","position":{"start":{"line":25,"column":30,"offset":1321},"end":{"line":25,"column":107,"offset":1398}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"capture_output=True","position":{"start":{"line":25,"column":107,"offset":1398},"end":{"line":25,"column":128,"offset":1419}}}],"position":{"start":{"line":25,"column":107,"offset":1398},"end":{"line":25,"column":128,"offset":1419}}}],"position":{"start":{"line":25,"column":1,"offset":1292},"end":{"line":25,"column":128,"offset":1419}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"上面函数的返回值是一个特殊的数据结构，命令顺利执行的话，结果会写在 ","position":{"start":{"line":26,"column":3,"offset":1423},"end":{"line":26,"column":37,"offset":1457}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".stdout","position":{"start":{"line":26,"column":37,"offset":1457},"end":{"line":26,"column":46,"offset":1466}}}],"position":{"start":{"line":26,"column":37,"offset":1457},"end":{"line":26,"column":46,"offset":1466}}},{"type":"text","value":" 里，这是一个二进制串 ","position":{"start":{"line":26,"column":46,"offset":1466},"end":{"line":26,"column":58,"offset":1478}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"b'xxx...'","position":{"start":{"line":26,"column":58,"offset":1478},"end":{"line":26,"column":69,"offset":1489}}}],"position":{"start":{"line":26,"column":58,"offset":1478},"end":{"line":26,"column":69,"offset":1489}}},{"type":"text","value":"，所以需要 ","position":{"start":{"line":26,"column":69,"offset":1489},"end":{"line":26,"column":75,"offset":1495}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".decode(\"utf-8\")","position":{"start":{"line":26,"column":75,"offset":1495},"end":{"line":26,"column":93,"offset":1513}}}],"position":{"start":{"line":26,"column":75,"offset":1495},"end":{"line":26,"column":93,"offset":1513}}},{"type":"text","value":" 转化成字符串。","position":{"start":{"line":26,"column":93,"offset":1513},"end":{"line":26,"column":101,"offset":1521}}}],"position":{"start":{"line":26,"column":1,"offset":1421},"end":{"line":26,"column":101,"offset":1521}}},{"type":"text","value":"\n"}],"position":{"start":{"line":25,"column":1,"offset":1292},"end":{"line":26,"column":101,"offset":1521}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果只用bash的话，","position":{"start":{"line":28,"column":1,"offset":1525},"end":{"line":28,"column":12,"offset":1536}}}],"position":{"start":{"line":28,"column":1,"offset":1525},"end":{"line":28,"column":12,"offset":1536}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"我的 bash 水平可以做到 ","position":{"start":{"line":30,"column":3,"offset":1542},"end":{"line":30,"column":18,"offset":1557}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput list | grep \"touchscreen\"","position":{"start":{"line":30,"column":18,"offset":1557},"end":{"line":30,"column":52,"offset":1591}}}],"position":{"start":{"line":30,"column":18,"offset":1557},"end":{"line":30,"column":52,"offset":1591}}},{"type":"text","value":", 这里的 ","position":{"start":{"line":30,"column":52,"offset":1591},"end":{"line":30,"column":58,"offset":1597}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"|","position":{"start":{"line":30,"column":58,"offset":1597},"end":{"line":30,"column":61,"offset":1600}}}],"position":{"start":{"line":30,"column":58,"offset":1597},"end":{"line":30,"column":61,"offset":1600}}},{"type":"text","value":" 是一个管道，也就是将前一条命令的输出传递给后一条作为输入。要想在 python 里使用管道，可以看这个问答：","position":{"start":{"line":30,"column":61,"offset":1600},"end":{"line":30,"column":116,"offset":1655}}},{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes"},"children":[{"type":"text","value":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes","position":{"start":{"line":30,"column":117,"offset":1656},"end":{"line":30,"column":202,"offset":1741}}}],"position":{"start":{"line":30,"column":116,"offset":1655},"end":{"line":30,"column":290,"offset":1829}}}],"position":{"start":{"line":30,"column":1,"offset":1540},"end":{"line":30,"column":290,"offset":1829}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"上面管道的结果还需要裁剪出 id 号，也就是 ","position":{"start":{"line":31,"column":3,"offset":1833},"end":{"line":31,"column":26,"offset":1856}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"line.partition(\"id=\")[2].partition(\"\\t\")[0]","position":{"start":{"line":31,"column":26,"offset":1856},"end":{"line":31,"column":71,"offset":1901}}}],"position":{"start":{"line":31,"column":26,"offset":1856},"end":{"line":31,"column":71,"offset":1901}}},{"type":"text","value":"，估计需要用到 awk, 虽然难，但可以学，至少知道该学什么；","position":{"start":{"line":31,"column":71,"offset":1901},"end":{"line":31,"column":102,"offset":1932}}}],"position":{"start":{"line":31,"column":1,"offset":1831},"end":{"line":31,"column":102,"offset":1932}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"但是把 id 号传递给一个变量，然后把这个变量填进 ","position":{"start":{"line":32,"column":3,"offset":1936},"end":{"line":32,"column":29,"offset":1962}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput disable","position":{"start":{"line":32,"column":29,"offset":1962},"end":{"line":32,"column":45,"offset":1978}}}],"position":{"start":{"line":32,"column":29,"offset":1962},"end":{"line":32,"column":45,"offset":1978}}},{"type":"text","value":", 这一步就连该学什么也不知道了。","position":{"start":{"line":32,"column":45,"offset":1978},"end":{"line":32,"column":62,"offset":1995}}}],"position":{"start":{"line":32,"column":1,"offset":1934},"end":{"line":32,"column":62,"offset":1995}}},{"type":"text","value":"\n"}],"position":{"start":{"line":30,"column":1,"offset":1540},"end":{"line":32,"column":62,"offset":1995}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":33,"column":1,"offset":1997}}}},"__N_SSG":true}