{"pageProps":{"metadata":{"slug":"python-subprocess-run-bash","date":"2022-07-08","title":".py | python.subprocess执行bash命令","filename":"2022-07-08-python-subprocess-run-bash.md","url":"python-subprocess-run-bash","layout":"post","keywords":["md","py"],"excerpt":"让 python 读 bash 的命令结果，写 bash 的命令语句。","content":"\n笔记本的触摸屏被我摔了道裂纹，一开始还不影响使用，但是最近几周情况恶化，有时鼠标光标会突然暴走，不听指挥。所以需要禁用触摸屏作为输入设备。\n\n在 xorg 的桌面环境之下，可以用 `xinput list` 显示出所有输入设备，以及对应的 id 号码。然后把找到的 id 填入 `xinput disable ##` 就可以了。一般来说这个 id 的数值是稳定的，所以我就直接把禁用命令写到 `~/.bashrc` 里面去了。\n\n然而，最近把吃灰很久的树莓派拿出来玩了，所以败家买了个60%布局的小机械键盘，小键盘往笔记本一插，诶，您猜怎么着，新买的键盘输完密码登陆之后就不能用了，着实吓了一跳。\n\n所以需要每次检查一遍输入设备的 id，然后把和触摸屏有关的 id（不止一个）从 `xinput list` 的输出里摘出来赋值给一个变量，然后把变量带入 `xinput disable #` 里面。这一套操作已经超出我的 bash 能力了，所以考虑用 python 完成中间步骤，也就是需要让 python 读 bash 的命令结果，写 bash 的命令语句。\n\nGoogles搜索给到了这个结果：[https://stackoverflow.com/questions/4256107/running-bash-commands-in-python](https://stackoverflow.com/questions/4256107/running-bash-commands-in-python)，稍微看了一下 subprocess 的官方文档，写了下面的一段，存到 `~/disable_touchscreen.py`, 然后在 `~/.bashrc` 里加一句 `python ~/disable_touchscreen.py`\n\n```python\nimport subprocess\ncheck = subprcess.run([\"xinput\",\"list\"],capture_output=True)\nfor line in check.stdout.decode(\"utf-8\").split(\"\\n\"):\n    if \"touchscreen\" in line:\n        device = line.partition(\"id=\")[2].partition(\"\\t\")[0]\n        disable = subprocess.run([\"xinput\",\"disable\",str(device)])\n        if disable.returncode==0:\n            print(f\"Successfully disabled touchscreen device {device}\")\n        else:\n            print(f\"Failed to disable touchscreen device {device}\")\n```\n\n- 这段代码的核心是 `subprocess.run()` ，第一个参数就是传给 bash 的命令，这是一个list，其中每个元素就是 bash 语句用空格分割开的每一部分。要想得到命令的执行结果，需要添加参数 `capture_output=True`\n- 上面函数的返回值是一个特殊的数据结构，命令顺利执行的话，结果会写在 `.stdout` 里，这是一个二进制串 `b'xxx...'`，所以需要 `.decode(\"utf-8\")` 转化成字符串。\n\n如果只用bash的话，\n\n- 我的 bash 水平可以做到 `xinput list | grep \"touchscreen\"`, 这里的 `|` 是一个管道，也就是将前一条命令的输出传递给后一条作为输入。要想在 python 里使用管道，可以看这个问答：[https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes](https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes)\n- 上面管道的结果还需要裁剪出 id 号，也就是 `line.partition(\"id=\")[2].partition(\"\\t\")[0]`，估计需要用到 awk, 虽然难，但可以学，至少知道该学什么；\n- 但是把 id 号传递给一个变量，然后把这个变量填进 `xinput disable`, 这一步就连该学什么也不知道了。\n"},"mdAst":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"笔记本的触摸屏被我摔了道裂纹，一开始还不影响使用，但是最近几周情况恶化，有时鼠标光标会突然暴走，不听指挥。所以需要禁用触摸屏作为输入设备。","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":70,"offset":70}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":70,"offset":70}}},{"type":"paragraph","children":[{"type":"text","value":"在 xorg 的桌面环境之下，可以用 ","position":{"start":{"line":4,"column":1,"offset":72},"end":{"line":4,"column":20,"offset":91}}},{"type":"inlineCode","value":"xinput list","position":{"start":{"line":4,"column":20,"offset":91},"end":{"line":4,"column":33,"offset":104}}},{"type":"text","value":" 显示出所有输入设备，以及对应的 id 号码。然后把找到的 id 填入 ","position":{"start":{"line":4,"column":33,"offset":104},"end":{"line":4,"column":69,"offset":140}}},{"type":"inlineCode","value":"xinput disable ##","position":{"start":{"line":4,"column":69,"offset":140},"end":{"line":4,"column":88,"offset":159}}},{"type":"text","value":" 就可以了。一般来说这个 id 的数值是稳定的，所以我就直接把禁用命令写到 ","position":{"start":{"line":4,"column":88,"offset":159},"end":{"line":4,"column":126,"offset":197}}},{"type":"inlineCode","value":"~/.bashrc","position":{"start":{"line":4,"column":126,"offset":197},"end":{"line":4,"column":137,"offset":208}}},{"type":"text","value":" 里面去了。","position":{"start":{"line":4,"column":137,"offset":208},"end":{"line":4,"column":143,"offset":214}}}],"position":{"start":{"line":4,"column":1,"offset":72},"end":{"line":4,"column":143,"offset":214}}},{"type":"paragraph","children":[{"type":"text","value":"然而，最近把吃灰很久的树莓派拿出来玩了，所以败家买了个60%布局的小机械键盘，小键盘往笔记本一插，诶，您猜怎么着，新买的键盘输完密码登陆之后就不能用了，着实吓了一跳。","position":{"start":{"line":6,"column":1,"offset":216},"end":{"line":6,"column":84,"offset":299}}}],"position":{"start":{"line":6,"column":1,"offset":216},"end":{"line":6,"column":84,"offset":299}}},{"type":"paragraph","children":[{"type":"text","value":"所以需要每次检查一遍输入设备的 id，然后把和触摸屏有关的 id（不止一个）从 ","position":{"start":{"line":8,"column":1,"offset":301},"end":{"line":8,"column":41,"offset":341}}},{"type":"inlineCode","value":"xinput list","position":{"start":{"line":8,"column":41,"offset":341},"end":{"line":8,"column":54,"offset":354}}},{"type":"text","value":" 的输出里摘出来赋值给一个变量，然后把变量带入 ","position":{"start":{"line":8,"column":54,"offset":354},"end":{"line":8,"column":78,"offset":378}}},{"type":"inlineCode","value":"xinput disable #","position":{"start":{"line":8,"column":78,"offset":378},"end":{"line":8,"column":96,"offset":396}}},{"type":"text","value":" 里面。这一套操作已经超出我的 bash 能力了，所以考虑用 python 完成中间步骤，也就是需要让 python 读 bash 的命令结果，写 bash 的命令语句。","position":{"start":{"line":8,"column":96,"offset":396},"end":{"line":8,"column":181,"offset":481}}}],"position":{"start":{"line":8,"column":1,"offset":301},"end":{"line":8,"column":181,"offset":481}}},{"type":"paragraph","children":[{"type":"text","value":"Googles搜索给到了这个结果：","position":{"start":{"line":10,"column":1,"offset":483},"end":{"line":10,"column":18,"offset":500}}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python","children":[{"type":"text","value":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python","position":{"start":{"line":10,"column":19,"offset":501},"end":{"line":10,"column":94,"offset":576}}}],"position":{"start":{"line":10,"column":18,"offset":500},"end":{"line":10,"column":172,"offset":654}}},{"type":"text","value":"，稍微看了一下 subprocess 的官方文档，写了下面的一段，存到 ","position":{"start":{"line":10,"column":172,"offset":654},"end":{"line":10,"column":208,"offset":690}}},{"type":"inlineCode","value":"~/disable_touchscreen.py","position":{"start":{"line":10,"column":208,"offset":690},"end":{"line":10,"column":234,"offset":716}}},{"type":"text","value":", 然后在 ","position":{"start":{"line":10,"column":234,"offset":716},"end":{"line":10,"column":240,"offset":722}}},{"type":"inlineCode","value":"~/.bashrc","position":{"start":{"line":10,"column":240,"offset":722},"end":{"line":10,"column":251,"offset":733}}},{"type":"text","value":" 里加一句 ","position":{"start":{"line":10,"column":251,"offset":733},"end":{"line":10,"column":257,"offset":739}}},{"type":"inlineCode","value":"python ~/disable_touchscreen.py","position":{"start":{"line":10,"column":257,"offset":739},"end":{"line":10,"column":290,"offset":772}}}],"position":{"start":{"line":10,"column":1,"offset":483},"end":{"line":10,"column":290,"offset":772}}},{"type":"code","lang":"python","meta":null,"value":"import subprocess\ncheck = subprcess.run([\"xinput\",\"list\"],capture_output=True)\nfor line in check.stdout.decode(\"utf-8\").split(\"\\n\"):\n    if \"touchscreen\" in line:\n        device = line.partition(\"id=\")[2].partition(\"\\t\")[0]\n        disable = subprocess.run([\"xinput\",\"disable\",str(device)])\n        if disable.returncode==0:\n            print(f\"Successfully disabled touchscreen device {device}\")\n        else:\n            print(f\"Failed to disable touchscreen device {device}\")","position":{"start":{"line":12,"column":1,"offset":774},"end":{"line":23,"column":4,"offset":1266}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"这段代码的核心是 ","position":{"start":{"line":25,"column":3,"offset":1270},"end":{"line":25,"column":12,"offset":1279}}},{"type":"inlineCode","value":"subprocess.run()","position":{"start":{"line":25,"column":12,"offset":1279},"end":{"line":25,"column":30,"offset":1297}}},{"type":"text","value":" ，第一个参数就是传给 bash 的命令，这是一个list，其中每个元素就是 bash 语句用空格分割开的每一部分。要想得到命令的执行结果，需要添加参数 ","position":{"start":{"line":25,"column":30,"offset":1297},"end":{"line":25,"column":107,"offset":1374}}},{"type":"inlineCode","value":"capture_output=True","position":{"start":{"line":25,"column":107,"offset":1374},"end":{"line":25,"column":128,"offset":1395}}}],"position":{"start":{"line":25,"column":3,"offset":1270},"end":{"line":25,"column":128,"offset":1395}}}],"position":{"start":{"line":25,"column":1,"offset":1268},"end":{"line":25,"column":128,"offset":1395}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"上面函数的返回值是一个特殊的数据结构，命令顺利执行的话，结果会写在 ","position":{"start":{"line":26,"column":3,"offset":1398},"end":{"line":26,"column":37,"offset":1432}}},{"type":"inlineCode","value":".stdout","position":{"start":{"line":26,"column":37,"offset":1432},"end":{"line":26,"column":46,"offset":1441}}},{"type":"text","value":" 里，这是一个二进制串 ","position":{"start":{"line":26,"column":46,"offset":1441},"end":{"line":26,"column":58,"offset":1453}}},{"type":"inlineCode","value":"b'xxx...'","position":{"start":{"line":26,"column":58,"offset":1453},"end":{"line":26,"column":69,"offset":1464}}},{"type":"text","value":"，所以需要 ","position":{"start":{"line":26,"column":69,"offset":1464},"end":{"line":26,"column":75,"offset":1470}}},{"type":"inlineCode","value":".decode(\"utf-8\")","position":{"start":{"line":26,"column":75,"offset":1470},"end":{"line":26,"column":93,"offset":1488}}},{"type":"text","value":" 转化成字符串。","position":{"start":{"line":26,"column":93,"offset":1488},"end":{"line":26,"column":101,"offset":1496}}}],"position":{"start":{"line":26,"column":3,"offset":1398},"end":{"line":26,"column":101,"offset":1496}}}],"position":{"start":{"line":26,"column":1,"offset":1396},"end":{"line":26,"column":101,"offset":1496}}}],"position":{"start":{"line":25,"column":1,"offset":1268},"end":{"line":26,"column":101,"offset":1496}}},{"type":"paragraph","children":[{"type":"text","value":"如果只用bash的话，","position":{"start":{"line":28,"column":1,"offset":1498},"end":{"line":28,"column":12,"offset":1509}}}],"position":{"start":{"line":28,"column":1,"offset":1498},"end":{"line":28,"column":12,"offset":1509}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"我的 bash 水平可以做到 ","position":{"start":{"line":30,"column":3,"offset":1513},"end":{"line":30,"column":18,"offset":1528}}},{"type":"inlineCode","value":"xinput list | grep \"touchscreen\"","position":{"start":{"line":30,"column":18,"offset":1528},"end":{"line":30,"column":52,"offset":1562}}},{"type":"text","value":", 这里的 ","position":{"start":{"line":30,"column":52,"offset":1562},"end":{"line":30,"column":58,"offset":1568}}},{"type":"inlineCode","value":"|","position":{"start":{"line":30,"column":58,"offset":1568},"end":{"line":30,"column":61,"offset":1571}}},{"type":"text","value":" 是一个管道，也就是将前一条命令的输出传递给后一条作为输入。要想在 python 里使用管道，可以看这个问答：","position":{"start":{"line":30,"column":61,"offset":1571},"end":{"line":30,"column":116,"offset":1626}}},{"type":"link","title":null,"url":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes","children":[{"type":"text","value":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes","position":{"start":{"line":30,"column":117,"offset":1627},"end":{"line":30,"column":202,"offset":1712}}}],"position":{"start":{"line":30,"column":116,"offset":1626},"end":{"line":30,"column":290,"offset":1800}}}],"position":{"start":{"line":30,"column":3,"offset":1513},"end":{"line":30,"column":290,"offset":1800}}}],"position":{"start":{"line":30,"column":1,"offset":1511},"end":{"line":30,"column":290,"offset":1800}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"上面管道的结果还需要裁剪出 id 号，也就是 ","position":{"start":{"line":31,"column":3,"offset":1803},"end":{"line":31,"column":26,"offset":1826}}},{"type":"inlineCode","value":"line.partition(\"id=\")[2].partition(\"\\t\")[0]","position":{"start":{"line":31,"column":26,"offset":1826},"end":{"line":31,"column":71,"offset":1871}}},{"type":"text","value":"，估计需要用到 awk, 虽然难，但可以学，至少知道该学什么；","position":{"start":{"line":31,"column":71,"offset":1871},"end":{"line":31,"column":102,"offset":1902}}}],"position":{"start":{"line":31,"column":3,"offset":1803},"end":{"line":31,"column":102,"offset":1902}}}],"position":{"start":{"line":31,"column":1,"offset":1801},"end":{"line":31,"column":102,"offset":1902}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"但是把 id 号传递给一个变量，然后把这个变量填进 ","position":{"start":{"line":32,"column":3,"offset":1905},"end":{"line":32,"column":29,"offset":1931}}},{"type":"inlineCode","value":"xinput disable","position":{"start":{"line":32,"column":29,"offset":1931},"end":{"line":32,"column":45,"offset":1947}}},{"type":"text","value":", 这一步就连该学什么也不知道了。","position":{"start":{"line":32,"column":45,"offset":1947},"end":{"line":32,"column":62,"offset":1964}}}],"position":{"start":{"line":32,"column":3,"offset":1905},"end":{"line":32,"column":62,"offset":1964}}}],"position":{"start":{"line":32,"column":1,"offset":1903},"end":{"line":32,"column":62,"offset":1964}}}],"position":{"start":{"line":30,"column":1,"offset":1511},"end":{"line":32,"column":62,"offset":1964}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":33,"column":1,"offset":1965}}},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"笔记本的触摸屏被我摔了道裂纹，一开始还不影响使用，但是最近几周情况恶化，有时鼠标光标会突然暴走，不听指挥。所以需要禁用触摸屏作为输入设备。","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":70,"offset":70}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":70,"offset":70}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 xorg 的桌面环境之下，可以用 ","position":{"start":{"line":4,"column":1,"offset":72},"end":{"line":4,"column":20,"offset":91}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput list","position":{"start":{"line":4,"column":20,"offset":91},"end":{"line":4,"column":33,"offset":104}}}],"position":{"start":{"line":4,"column":20,"offset":91},"end":{"line":4,"column":33,"offset":104}}},{"type":"text","value":" 显示出所有输入设备，以及对应的 id 号码。然后把找到的 id 填入 ","position":{"start":{"line":4,"column":33,"offset":104},"end":{"line":4,"column":69,"offset":140}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput disable ##","position":{"start":{"line":4,"column":69,"offset":140},"end":{"line":4,"column":88,"offset":159}}}],"position":{"start":{"line":4,"column":69,"offset":140},"end":{"line":4,"column":88,"offset":159}}},{"type":"text","value":" 就可以了。一般来说这个 id 的数值是稳定的，所以我就直接把禁用命令写到 ","position":{"start":{"line":4,"column":88,"offset":159},"end":{"line":4,"column":126,"offset":197}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"~/.bashrc","position":{"start":{"line":4,"column":126,"offset":197},"end":{"line":4,"column":137,"offset":208}}}],"position":{"start":{"line":4,"column":126,"offset":197},"end":{"line":4,"column":137,"offset":208}}},{"type":"text","value":" 里面去了。","position":{"start":{"line":4,"column":137,"offset":208},"end":{"line":4,"column":143,"offset":214}}}],"position":{"start":{"line":4,"column":1,"offset":72},"end":{"line":4,"column":143,"offset":214}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"然而，最近把吃灰很久的树莓派拿出来玩了，所以败家买了个60%布局的小机械键盘，小键盘往笔记本一插，诶，您猜怎么着，新买的键盘输完密码登陆之后就不能用了，着实吓了一跳。","position":{"start":{"line":6,"column":1,"offset":216},"end":{"line":6,"column":84,"offset":299}}}],"position":{"start":{"line":6,"column":1,"offset":216},"end":{"line":6,"column":84,"offset":299}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"所以需要每次检查一遍输入设备的 id，然后把和触摸屏有关的 id（不止一个）从 ","position":{"start":{"line":8,"column":1,"offset":301},"end":{"line":8,"column":41,"offset":341}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput list","position":{"start":{"line":8,"column":41,"offset":341},"end":{"line":8,"column":54,"offset":354}}}],"position":{"start":{"line":8,"column":41,"offset":341},"end":{"line":8,"column":54,"offset":354}}},{"type":"text","value":" 的输出里摘出来赋值给一个变量，然后把变量带入 ","position":{"start":{"line":8,"column":54,"offset":354},"end":{"line":8,"column":78,"offset":378}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput disable #","position":{"start":{"line":8,"column":78,"offset":378},"end":{"line":8,"column":96,"offset":396}}}],"position":{"start":{"line":8,"column":78,"offset":378},"end":{"line":8,"column":96,"offset":396}}},{"type":"text","value":" 里面。这一套操作已经超出我的 bash 能力了，所以考虑用 python 完成中间步骤，也就是需要让 python 读 bash 的命令结果，写 bash 的命令语句。","position":{"start":{"line":8,"column":96,"offset":396},"end":{"line":8,"column":181,"offset":481}}}],"position":{"start":{"line":8,"column":1,"offset":301},"end":{"line":8,"column":181,"offset":481}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Googles搜索给到了这个结果：","position":{"start":{"line":10,"column":1,"offset":483},"end":{"line":10,"column":18,"offset":500}}},{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python"},"children":[{"type":"text","value":"https://stackoverflow.com/questions/4256107/running-bash-commands-in-python","position":{"start":{"line":10,"column":19,"offset":501},"end":{"line":10,"column":94,"offset":576}}}],"position":{"start":{"line":10,"column":18,"offset":500},"end":{"line":10,"column":172,"offset":654}}},{"type":"text","value":"，稍微看了一下 subprocess 的官方文档，写了下面的一段，存到 ","position":{"start":{"line":10,"column":172,"offset":654},"end":{"line":10,"column":208,"offset":690}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"~/disable_touchscreen.py","position":{"start":{"line":10,"column":208,"offset":690},"end":{"line":10,"column":234,"offset":716}}}],"position":{"start":{"line":10,"column":208,"offset":690},"end":{"line":10,"column":234,"offset":716}}},{"type":"text","value":", 然后在 ","position":{"start":{"line":10,"column":234,"offset":716},"end":{"line":10,"column":240,"offset":722}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"~/.bashrc","position":{"start":{"line":10,"column":240,"offset":722},"end":{"line":10,"column":251,"offset":733}}}],"position":{"start":{"line":10,"column":240,"offset":722},"end":{"line":10,"column":251,"offset":733}}},{"type":"text","value":" 里加一句 ","position":{"start":{"line":10,"column":251,"offset":733},"end":{"line":10,"column":257,"offset":739}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python ~/disable_touchscreen.py","position":{"start":{"line":10,"column":257,"offset":739},"end":{"line":10,"column":290,"offset":772}}}],"position":{"start":{"line":10,"column":257,"offset":739},"end":{"line":10,"column":290,"offset":772}}}],"position":{"start":{"line":10,"column":1,"offset":483},"end":{"line":10,"column":290,"offset":772}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark-dimmed","style":"background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" subprocess"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"check "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" subprcess.run(["}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"xinput\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"list\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"],"}]},{"type":"element","tagName":"span","properties":{"style":"color:#E36209;--shiki-dark:#F69D50"},"children":[{"type":"text","value":"capture_output"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"True"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" line "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" check.stdout.decode("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"utf-8\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":").split("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#F47067"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"):"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":" \"touchscreen\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":" in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" line:"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"        device "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" line.partition("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"id=\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":")["}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"].partition("}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#F47067"},"children":[{"type":"text","value":"\\t"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":")["}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"]"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"        disable "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" subprocess.run(["}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"xinput\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"disable\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"str"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"(device)])"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" disable.returncode"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":":"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"            print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"Successfully disabled touchscreen device "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#F47067"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"device"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#F47067"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"        else"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":":"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"            print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"f"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\"Failed to disable touchscreen device "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#F47067"},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"device"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#F47067"},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这段代码的核心是 ","position":{"start":{"line":25,"column":3,"offset":1270},"end":{"line":25,"column":12,"offset":1279}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"subprocess.run()","position":{"start":{"line":25,"column":12,"offset":1279},"end":{"line":25,"column":30,"offset":1297}}}],"position":{"start":{"line":25,"column":12,"offset":1279},"end":{"line":25,"column":30,"offset":1297}}},{"type":"text","value":" ，第一个参数就是传给 bash 的命令，这是一个list，其中每个元素就是 bash 语句用空格分割开的每一部分。要想得到命令的执行结果，需要添加参数 ","position":{"start":{"line":25,"column":30,"offset":1297},"end":{"line":25,"column":107,"offset":1374}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"capture_output=True","position":{"start":{"line":25,"column":107,"offset":1374},"end":{"line":25,"column":128,"offset":1395}}}],"position":{"start":{"line":25,"column":107,"offset":1374},"end":{"line":25,"column":128,"offset":1395}}}],"position":{"start":{"line":25,"column":1,"offset":1268},"end":{"line":25,"column":128,"offset":1395}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"上面函数的返回值是一个特殊的数据结构，命令顺利执行的话，结果会写在 ","position":{"start":{"line":26,"column":3,"offset":1398},"end":{"line":26,"column":37,"offset":1432}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".stdout","position":{"start":{"line":26,"column":37,"offset":1432},"end":{"line":26,"column":46,"offset":1441}}}],"position":{"start":{"line":26,"column":37,"offset":1432},"end":{"line":26,"column":46,"offset":1441}}},{"type":"text","value":" 里，这是一个二进制串 ","position":{"start":{"line":26,"column":46,"offset":1441},"end":{"line":26,"column":58,"offset":1453}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"b'xxx...'","position":{"start":{"line":26,"column":58,"offset":1453},"end":{"line":26,"column":69,"offset":1464}}}],"position":{"start":{"line":26,"column":58,"offset":1453},"end":{"line":26,"column":69,"offset":1464}}},{"type":"text","value":"，所以需要 ","position":{"start":{"line":26,"column":69,"offset":1464},"end":{"line":26,"column":75,"offset":1470}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".decode(\"utf-8\")","position":{"start":{"line":26,"column":75,"offset":1470},"end":{"line":26,"column":93,"offset":1488}}}],"position":{"start":{"line":26,"column":75,"offset":1470},"end":{"line":26,"column":93,"offset":1488}}},{"type":"text","value":" 转化成字符串。","position":{"start":{"line":26,"column":93,"offset":1488},"end":{"line":26,"column":101,"offset":1496}}}],"position":{"start":{"line":26,"column":1,"offset":1396},"end":{"line":26,"column":101,"offset":1496}}},{"type":"text","value":"\n"}],"position":{"start":{"line":25,"column":1,"offset":1268},"end":{"line":26,"column":101,"offset":1496}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果只用bash的话，","position":{"start":{"line":28,"column":1,"offset":1498},"end":{"line":28,"column":12,"offset":1509}}}],"position":{"start":{"line":28,"column":1,"offset":1498},"end":{"line":28,"column":12,"offset":1509}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"我的 bash 水平可以做到 ","position":{"start":{"line":30,"column":3,"offset":1513},"end":{"line":30,"column":18,"offset":1528}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput list | grep \"touchscreen\"","position":{"start":{"line":30,"column":18,"offset":1528},"end":{"line":30,"column":52,"offset":1562}}}],"position":{"start":{"line":30,"column":18,"offset":1528},"end":{"line":30,"column":52,"offset":1562}}},{"type":"text","value":", 这里的 ","position":{"start":{"line":30,"column":52,"offset":1562},"end":{"line":30,"column":58,"offset":1568}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"|","position":{"start":{"line":30,"column":58,"offset":1568},"end":{"line":30,"column":61,"offset":1571}}}],"position":{"start":{"line":30,"column":58,"offset":1568},"end":{"line":30,"column":61,"offset":1571}}},{"type":"text","value":" 是一个管道，也就是将前一条命令的输出传递给后一条作为输入。要想在 python 里使用管道，可以看这个问答：","position":{"start":{"line":30,"column":61,"offset":1571},"end":{"line":30,"column":116,"offset":1626}}},{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes"},"children":[{"type":"text","value":"https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes","position":{"start":{"line":30,"column":117,"offset":1627},"end":{"line":30,"column":202,"offset":1712}}}],"position":{"start":{"line":30,"column":116,"offset":1626},"end":{"line":30,"column":290,"offset":1800}}}],"position":{"start":{"line":30,"column":1,"offset":1511},"end":{"line":30,"column":290,"offset":1800}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"上面管道的结果还需要裁剪出 id 号，也就是 ","position":{"start":{"line":31,"column":3,"offset":1803},"end":{"line":31,"column":26,"offset":1826}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"line.partition(\"id=\")[2].partition(\"\\t\")[0]","position":{"start":{"line":31,"column":26,"offset":1826},"end":{"line":31,"column":71,"offset":1871}}}],"position":{"start":{"line":31,"column":26,"offset":1826},"end":{"line":31,"column":71,"offset":1871}}},{"type":"text","value":"，估计需要用到 awk, 虽然难，但可以学，至少知道该学什么；","position":{"start":{"line":31,"column":71,"offset":1871},"end":{"line":31,"column":102,"offset":1902}}}],"position":{"start":{"line":31,"column":1,"offset":1801},"end":{"line":31,"column":102,"offset":1902}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"但是把 id 号传递给一个变量，然后把这个变量填进 ","position":{"start":{"line":32,"column":3,"offset":1905},"end":{"line":32,"column":29,"offset":1931}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"xinput disable","position":{"start":{"line":32,"column":29,"offset":1931},"end":{"line":32,"column":45,"offset":1947}}}],"position":{"start":{"line":32,"column":29,"offset":1931},"end":{"line":32,"column":45,"offset":1947}}},{"type":"text","value":", 这一步就连该学什么也不知道了。","position":{"start":{"line":32,"column":45,"offset":1947},"end":{"line":32,"column":62,"offset":1964}}}],"position":{"start":{"line":32,"column":1,"offset":1903},"end":{"line":32,"column":62,"offset":1964}}},{"type":"text","value":"\n"}],"position":{"start":{"line":30,"column":1,"offset":1511},"end":{"line":32,"column":62,"offset":1964}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":33,"column":1,"offset":1965}}}},"__N_SSG":true}