{"pageProps":{"metadata":{"slug":"python-import-script-module-package","filename":"2021-12-11-python-import-script-module-package.md","date":"2021-12-11","title":".py | Import Existing Code","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\nLet's explain this using the directory structure provided on the official website:\n\n```\nsound/ Top-level package \n    init.py Initialize the sound package \n    formats/ Subpackage for file format conversions \n        init.py \n        wavread.py \n        wavwrite.py \n        aiffread.py \n        aiffwrite.py \n        auread.py \n        auwrite.py \n        ... \n    effects/ Subpackage for sound effects \n        init.py \n        echo.py \n        surround.py \n        reverse.py \n        ... \n    filters/ Subpackage for filters \n        init.py \n        equalizer.py \n        vocoder.py \n        karaoke.py \n        ...\n```\n\n## Using Existing Python Code\n\nMost programming tutorials start teaching syntax after setting up the environment. But let’s first discuss using code that’s already been written. The simplest way to do this is by installing packages through a package manager:\n\n```bash\npip install sound\n```\n\nThen, if you want to use a function in a specific file (let's say `wavwrite.py` has a function called `write()`), there are multiple ways to import it. Note the different ways to import and call the function:\n\n```python\nimport sound\nsound.formats.wavwrite.write()\n\nfrom sound import formats\nformats.wavwrite.write() \n\nfrom sound.formats import wavwrite\nwavwrite.write()\n\nfrom sound.formats.wavwrite import write\nwrite()\n```\n\nHowever, not all Python code can be installed directly. For example, if a research paper is published along with data processing code, often the code is simply shared in a folder. If you download that folder and try `import sound`, an error will occur, stating that Python can't find a library named sound.\n\n## How Python Locates Code Files\n\nIf you think about it, it’s normal that an error occurs. The previous simple command `import sound` solved the problem magically—finding the library without needing a file path—even though libraries can be located in different parts of the file system.\n\nThis is because Python doesn’t search the entire hard drive. Instead, it uses a variable, typically named `PYTHONPATH`, which holds a list of directories where Python library folders are located. When you enter a command in the terminal, Python will:\n\n- Search the current folder, meaning the folder where you launched the Python command.\n- Look through each folder in the `PYTHONPATH` variable.\n- Finally, check the default location for packages installed by the package manager, typically `<path to python>/site-packages`.\n\nIf the library is found, Python will import it; otherwise, an error occurs.\n\nIn the error mentioned above, if we happen to be in the `sound` folder and run Python, the first condition applies, and `import sound` won’t produce an error. But this won’t work in other locations.\n\n## Terminology: Interactive, Script, Module, Package\n\nExecutable Python commands can be found in the following contexts, with the first being interactive and the last three being file-based:\n\n1. interactive: The Python **interactive interface**, also known as calculator mode, which appears after entering `python` in the command line. Commands entered here display results immediately. Once Python exits, these commands are lost.\n2. script: A Python **script** file, like `somefile.py` when running `python somefile.py` from the command line.\n    1. Python is lightweight, and some commands are worth saving for later reuse, much like Linux commands and bash scripts.\n    2. However, as a fully-featured language, Python can also support complex object-oriented programming. In this sense, the main script file can be considered the main module, serving as the main file and program entry point.\n3. module: A Python **module** file, which you can call with `python -m another` (without a `.py` extension). Technically, any `.py` file is a module, but it’s generally used for files whose variables and functions are meant for other Python files to import.\n4. package: A Python **package**, which is a higher-level structure of related modules (typically a folder with `__init__.py` inside). But packages and modules aren’t defined solely by folder hierarchy—more on that in the next section.\n\n## Script vs. Module\n\nPython offers both scripting flexibility and the robustness of more complex languages. Unlike some languages, you don’t need a main file called `main.py` with a `Main` class and a `main()` function. But Python still needs a starting point in a complex program.\n\nThis starting point is the `.py` file after `python` (without the `-m` parameter). Python sets the `__name__` attribute of this main file to `\"__main__\"`. This allows Python to treat it as the main script file, even if it's part of a larger library, with no knowledge of sibling or other related modules.\n\nOther modules are used by importing them in the main module (or script). The import command tells Python where to find the module’s code and the relationships between modules in the package hierarchy. Alternatively, the `-m` option provides this structure, e.g., `python -m sound.formats.wavwrite`, which allows `wavwrite.py` to execute and know its relative position in the hierarchy.\n\n## Absolute Import vs. Relative Import\n\nThe examples at the beginning use absolute imports (no leading `.`), whereas relative imports (`.` for current directory, `..` for parent directory) are for internal code that's almost never run as the main module.\n\nReturning to the file structure above, if `sound/effects/surround.py` needs functions from `sound/formats/wavwrite.py` and `sound/effects/echo.py`, you could write:\n\n```python\n# in sound/effects/surround.py\nfrom ..formats import wavwrite\nfrom . import echo\n```\n\n## Organizing Code for Reuse\n\nFinally, after years of coding, I’m drafting a paper, and now I need to organize previous analysis code into a project. Each time I tried to unify everything, import errors between modules were an issue. This post resulted from that experience.\n\nHere's a recommended project structure from [this article](https://gist.github.com/ericmjl/27e50331f24db3e8f957d1fe7bbbe510):\n\n```\n|- notebooks/\n   |- 01-first-logical-notebook.ipynb\n   |- 02-second-logical-notebook.ipynb\n   |- prototype-notebook.ipynb\n   |- archive/\n      |- no-longer-useful.ipynb\n|- projectname/\n   |- projectname/\n      |- __init__.py\n      |- config.py\n      |- data.py\n      |- utils.py\n   |- setup.py\n|- README.md\n|- data/\n   |- raw/\n   |- processed/\n   |- cleaned/\n|- scripts/\n   |- script1.py\n   |- script2.py\n   |- archive/\n      |- no-longer-useful.py\n|- environment.yml\n```\n\nThis structure allows you to convert tools into an installable library. Now, you can use `projectname` in notebooks and scripts just like `numpy` or `pandas`.\n\nTo use the code, install it with:\n\n```bash\ncd projectname\npip install -e .\n```\n\n## References\n\n- [What’s the difference between a Python module and a Python package?](https://stackoverflow.com/questions/7948494/whats-the-difference-between-a-python-module-and-a-python-package) All Python files are modules, while a package is a specific kind of module.\n- Official explanation of Python modules: https://docs.python.org/3/tutorial/modules.html\n- [StackOverflow: \"run as module\" is different from \"run as script\".](https://stackoverflow.com/questions/14132789/relative-imports-for-the-billionth-time) Running as a module sets the `__name__` attribute to the module’s name, while running as a script sets it to `__main__`.\n- A project organization tutorial: https://realpython.com/python-application-layouts/\n- Official documentation on packaging: https://packaging.python.org/en/latest/tutorials/packaging-projects/\n"},"tocStr":"{\"index\":null,\"endIndex\":null,\"map\":{\"type\":\"list\",\"ordered\":false,\"spread\":false,\"children\":[{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#using-existing-python-code\",\"children\":[{\"type\":\"text\",\"value\":\"Using Existing Python Code\"}]}]}]},{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#how-python-locates-code-files\",\"children\":[{\"type\":\"text\",\"value\":\"How Python Locates Code Files\"}]}]}]},{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#terminology-interactive-script-module-package\",\"children\":[{\"type\":\"text\",\"value\":\"Terminology: Interactive, Script, Module, Package\"}]}]}]},{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#script-vs-module\",\"children\":[{\"type\":\"text\",\"value\":\"Script vs. Module\"}]}]}]},{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#absolute-import-vs-relative-import\",\"children\":[{\"type\":\"text\",\"value\":\"Absolute Import vs. Relative Import\"}]}]}]},{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#organizing-code-for-reuse\",\"children\":[{\"type\":\"text\",\"value\":\"Organizing Code for Reuse\"}]}]}]},{\"type\":\"listItem\",\"spread\":false,\"children\":[{\"type\":\"paragraph\",\"children\":[{\"type\":\"link\",\"title\":null,\"url\":\"#references\",\"children\":[{\"type\":\"text\",\"value\":\"References\"}]}]}]}]}}","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's explain this using the directory structure provided on the official website:","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":83,"offset":83}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":83,"offset":83}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"sound/ Top-level package \n    init.py Initialize the sound package \n    formats/ Subpackage for file format conversions \n        init.py \n        wavread.py \n        wavwrite.py \n        aiffread.py \n        aiffwrite.py \n        auread.py \n        auwrite.py \n        ... \n    effects/ Subpackage for sound effects \n        init.py \n        echo.py \n        surround.py \n        reverse.py \n        ... \n    filters/ Subpackage for filters \n        init.py \n        equalizer.py \n        vocoder.py \n        karaoke.py \n        ...\n"}],"position":{"start":{"line":4,"column":1,"offset":85},"end":{"line":28,"column":4,"offset":625}}}],"position":{"start":{"line":4,"column":1,"offset":85},"end":{"line":28,"column":4,"offset":625}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"using-existing-python-code"},"children":[{"type":"text","value":"Using Existing Python Code","position":{"start":{"line":30,"column":4,"offset":630},"end":{"line":30,"column":30,"offset":656}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#using-existing-python-code"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":30,"column":1,"offset":627},"end":{"line":30,"column":30,"offset":656}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Most programming tutorials start teaching syntax after setting up the environment. But let’s first discuss using code that’s already been written. The simplest way to do this is by installing packages through a package manager:","position":{"start":{"line":32,"column":1,"offset":658},"end":{"line":32,"column":228,"offset":885}}}],"position":{"start":{"line":32,"column":1,"offset":658},"end":{"line":32,"column":228,"offset":885}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark-dimmed","style":"background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#F69D50"},"children":[{"type":"text","value":"pip"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":" install"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":" sound"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then, if you want to use a function in a specific file (let's say ","position":{"start":{"line":38,"column":1,"offset":918},"end":{"line":38,"column":67,"offset":984}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"wavwrite.py","position":{"start":{"line":38,"column":67,"offset":984},"end":{"line":38,"column":80,"offset":997}}}],"position":{"start":{"line":38,"column":67,"offset":984},"end":{"line":38,"column":80,"offset":997}}},{"type":"text","value":" has a function called ","position":{"start":{"line":38,"column":80,"offset":997},"end":{"line":38,"column":103,"offset":1020}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"write()","position":{"start":{"line":38,"column":103,"offset":1020},"end":{"line":38,"column":112,"offset":1029}}}],"position":{"start":{"line":38,"column":103,"offset":1020},"end":{"line":38,"column":112,"offset":1029}}},{"type":"text","value":"), there are multiple ways to import it. Note the different ways to import and call the function:","position":{"start":{"line":38,"column":112,"offset":1029},"end":{"line":38,"column":209,"offset":1126}}}],"position":{"start":{"line":38,"column":1,"offset":918},"end":{"line":38,"column":209,"offset":1126}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark-dimmed","style":"background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" sound"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"sound.formats.wavwrite.write()"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"from"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" sound "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" formats"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"formats.wavwrite.write() "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"from"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" sound.formats "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" wavwrite"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"wavwrite.write()"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"from"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" sound.formats.wavwrite "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" write"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":"write()"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"However, not all Python code can be installed directly. For example, if a research paper is published along with data processing code, often the code is simply shared in a folder. If you download that folder and try ","position":{"start":{"line":54,"column":1,"offset":1343},"end":{"line":54,"column":217,"offset":1559}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"import sound","position":{"start":{"line":54,"column":217,"offset":1559},"end":{"line":54,"column":231,"offset":1573}}}],"position":{"start":{"line":54,"column":217,"offset":1559},"end":{"line":54,"column":231,"offset":1573}}},{"type":"text","value":", an error will occur, stating that Python can't find a library named sound.","position":{"start":{"line":54,"column":231,"offset":1573},"end":{"line":54,"column":307,"offset":1649}}}],"position":{"start":{"line":54,"column":1,"offset":1343},"end":{"line":54,"column":307,"offset":1649}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"how-python-locates-code-files"},"children":[{"type":"text","value":"How Python Locates Code Files","position":{"start":{"line":56,"column":4,"offset":1654},"end":{"line":56,"column":33,"offset":1683}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#how-python-locates-code-files"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":56,"column":1,"offset":1651},"end":{"line":56,"column":33,"offset":1683}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you think about it, it’s normal that an error occurs. The previous simple command ","position":{"start":{"line":58,"column":1,"offset":1685},"end":{"line":58,"column":86,"offset":1770}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"import sound","position":{"start":{"line":58,"column":86,"offset":1770},"end":{"line":58,"column":100,"offset":1784}}}],"position":{"start":{"line":58,"column":86,"offset":1770},"end":{"line":58,"column":100,"offset":1784}}},{"type":"text","value":" solved the problem magically—finding the library without needing a file path—even though libraries can be located in different parts of the file system.","position":{"start":{"line":58,"column":100,"offset":1784},"end":{"line":58,"column":253,"offset":1937}}}],"position":{"start":{"line":58,"column":1,"offset":1685},"end":{"line":58,"column":253,"offset":1937}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This is because Python doesn’t search the entire hard drive. Instead, it uses a variable, typically named ","position":{"start":{"line":60,"column":1,"offset":1939},"end":{"line":60,"column":107,"offset":2045}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"PYTHONPATH","position":{"start":{"line":60,"column":107,"offset":2045},"end":{"line":60,"column":119,"offset":2057}}}],"position":{"start":{"line":60,"column":107,"offset":2045},"end":{"line":60,"column":119,"offset":2057}}},{"type":"text","value":", which holds a list of directories where Python library folders are located. When you enter a command in the terminal, Python will:","position":{"start":{"line":60,"column":119,"offset":2057},"end":{"line":60,"column":251,"offset":2189}}}],"position":{"start":{"line":60,"column":1,"offset":1939},"end":{"line":60,"column":251,"offset":2189}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Search the current folder, meaning the folder where you launched the Python command.","position":{"start":{"line":62,"column":3,"offset":2193},"end":{"line":62,"column":87,"offset":2277}}}],"position":{"start":{"line":62,"column":1,"offset":2191},"end":{"line":62,"column":87,"offset":2277}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Look through each folder in the ","position":{"start":{"line":63,"column":3,"offset":2280},"end":{"line":63,"column":35,"offset":2312}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"PYTHONPATH","position":{"start":{"line":63,"column":35,"offset":2312},"end":{"line":63,"column":47,"offset":2324}}}],"position":{"start":{"line":63,"column":35,"offset":2312},"end":{"line":63,"column":47,"offset":2324}}},{"type":"text","value":" variable.","position":{"start":{"line":63,"column":47,"offset":2324},"end":{"line":63,"column":57,"offset":2334}}}],"position":{"start":{"line":63,"column":1,"offset":2278},"end":{"line":63,"column":57,"offset":2334}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Finally, check the default location for packages installed by the package manager, typically ","position":{"start":{"line":64,"column":3,"offset":2337},"end":{"line":64,"column":96,"offset":2430}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"<path to python>/site-packages","position":{"start":{"line":64,"column":96,"offset":2430},"end":{"line":64,"column":128,"offset":2462}}}],"position":{"start":{"line":64,"column":96,"offset":2430},"end":{"line":64,"column":128,"offset":2462}}},{"type":"text","value":".","position":{"start":{"line":64,"column":128,"offset":2462},"end":{"line":64,"column":129,"offset":2463}}}],"position":{"start":{"line":64,"column":1,"offset":2335},"end":{"line":64,"column":129,"offset":2463}}},{"type":"text","value":"\n"}],"position":{"start":{"line":62,"column":1,"offset":2191},"end":{"line":64,"column":129,"offset":2463}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If the library is found, Python will import it; otherwise, an error occurs.","position":{"start":{"line":66,"column":1,"offset":2465},"end":{"line":66,"column":76,"offset":2540}}}],"position":{"start":{"line":66,"column":1,"offset":2465},"end":{"line":66,"column":76,"offset":2540}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the error mentioned above, if we happen to be in the ","position":{"start":{"line":68,"column":1,"offset":2542},"end":{"line":68,"column":57,"offset":2598}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"sound","position":{"start":{"line":68,"column":57,"offset":2598},"end":{"line":68,"column":64,"offset":2605}}}],"position":{"start":{"line":68,"column":57,"offset":2598},"end":{"line":68,"column":64,"offset":2605}}},{"type":"text","value":" folder and run Python, the first condition applies, and ","position":{"start":{"line":68,"column":64,"offset":2605},"end":{"line":68,"column":121,"offset":2662}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"import sound","position":{"start":{"line":68,"column":121,"offset":2662},"end":{"line":68,"column":135,"offset":2676}}}],"position":{"start":{"line":68,"column":121,"offset":2662},"end":{"line":68,"column":135,"offset":2676}}},{"type":"text","value":" won’t produce an error. But this won’t work in other locations.","position":{"start":{"line":68,"column":135,"offset":2676},"end":{"line":68,"column":199,"offset":2740}}}],"position":{"start":{"line":68,"column":1,"offset":2542},"end":{"line":68,"column":199,"offset":2740}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"terminology-interactive-script-module-package"},"children":[{"type":"text","value":"Terminology: Interactive, Script, Module, Package","position":{"start":{"line":70,"column":4,"offset":2745},"end":{"line":70,"column":53,"offset":2794}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#terminology-interactive-script-module-package"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":70,"column":1,"offset":2742},"end":{"line":70,"column":53,"offset":2794}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Executable Python commands can be found in the following contexts, with the first being interactive and the last three being file-based:","position":{"start":{"line":72,"column":1,"offset":2796},"end":{"line":72,"column":137,"offset":2932}}}],"position":{"start":{"line":72,"column":1,"offset":2796},"end":{"line":72,"column":137,"offset":2932}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"interactive: The Python ","position":{"start":{"line":74,"column":4,"offset":2937},"end":{"line":74,"column":28,"offset":2961}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"interactive interface","position":{"start":{"line":74,"column":30,"offset":2963},"end":{"line":74,"column":51,"offset":2984}}}],"position":{"start":{"line":74,"column":28,"offset":2961},"end":{"line":74,"column":53,"offset":2986}}},{"type":"text","value":", also known as calculator mode, which appears after entering ","position":{"start":{"line":74,"column":53,"offset":2986},"end":{"line":74,"column":115,"offset":3048}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python","position":{"start":{"line":74,"column":115,"offset":3048},"end":{"line":74,"column":123,"offset":3056}}}],"position":{"start":{"line":74,"column":115,"offset":3048},"end":{"line":74,"column":123,"offset":3056}}},{"type":"text","value":" in the command line. Commands entered here display results immediately. Once Python exits, these commands are lost.","position":{"start":{"line":74,"column":123,"offset":3056},"end":{"line":74,"column":239,"offset":3172}}}],"position":{"start":{"line":74,"column":1,"offset":2934},"end":{"line":74,"column":239,"offset":3172}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"script: A Python ","position":{"start":{"line":75,"column":4,"offset":3176},"end":{"line":75,"column":21,"offset":3193}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"script","position":{"start":{"line":75,"column":23,"offset":3195},"end":{"line":75,"column":29,"offset":3201}}}],"position":{"start":{"line":75,"column":21,"offset":3193},"end":{"line":75,"column":31,"offset":3203}}},{"type":"text","value":" file, like ","position":{"start":{"line":75,"column":31,"offset":3203},"end":{"line":75,"column":43,"offset":3215}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"somefile.py","position":{"start":{"line":75,"column":43,"offset":3215},"end":{"line":75,"column":56,"offset":3228}}}],"position":{"start":{"line":75,"column":43,"offset":3215},"end":{"line":75,"column":56,"offset":3228}}},{"type":"text","value":" when running ","position":{"start":{"line":75,"column":56,"offset":3228},"end":{"line":75,"column":70,"offset":3242}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python somefile.py","position":{"start":{"line":75,"column":70,"offset":3242},"end":{"line":75,"column":90,"offset":3262}}}],"position":{"start":{"line":75,"column":70,"offset":3242},"end":{"line":75,"column":90,"offset":3262}}},{"type":"text","value":" from the command line.","position":{"start":{"line":75,"column":90,"offset":3262},"end":{"line":75,"column":113,"offset":3285}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Python is lightweight, and some commands are worth saving for later reuse, much like Linux commands and bash scripts.","position":{"start":{"line":76,"column":8,"offset":3293},"end":{"line":76,"column":125,"offset":3410}}}],"position":{"start":{"line":76,"column":5,"offset":3290},"end":{"line":76,"column":125,"offset":3410}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"However, as a fully-featured language, Python can also support complex object-oriented programming. In this sense, the main script file can be considered the main module, serving as the main file and program entry point.","position":{"start":{"line":77,"column":8,"offset":3418},"end":{"line":77,"column":228,"offset":3638}}}],"position":{"start":{"line":77,"column":5,"offset":3415},"end":{"line":77,"column":228,"offset":3638}}},{"type":"text","value":"\n"}],"position":{"start":{"line":76,"column":5,"offset":3290},"end":{"line":77,"column":228,"offset":3638}}},{"type":"text","value":"\n"}],"position":{"start":{"line":75,"column":1,"offset":3173},"end":{"line":77,"column":228,"offset":3638}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"module: A Python ","position":{"start":{"line":78,"column":4,"offset":3642},"end":{"line":78,"column":21,"offset":3659}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"module","position":{"start":{"line":78,"column":23,"offset":3661},"end":{"line":78,"column":29,"offset":3667}}}],"position":{"start":{"line":78,"column":21,"offset":3659},"end":{"line":78,"column":31,"offset":3669}}},{"type":"text","value":" file, which you can call with ","position":{"start":{"line":78,"column":31,"offset":3669},"end":{"line":78,"column":62,"offset":3700}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python -m another","position":{"start":{"line":78,"column":62,"offset":3700},"end":{"line":78,"column":81,"offset":3719}}}],"position":{"start":{"line":78,"column":62,"offset":3700},"end":{"line":78,"column":81,"offset":3719}}},{"type":"text","value":" (without a ","position":{"start":{"line":78,"column":81,"offset":3719},"end":{"line":78,"column":93,"offset":3731}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".py","position":{"start":{"line":78,"column":93,"offset":3731},"end":{"line":78,"column":98,"offset":3736}}}],"position":{"start":{"line":78,"column":93,"offset":3731},"end":{"line":78,"column":98,"offset":3736}}},{"type":"text","value":" extension). Technically, any ","position":{"start":{"line":78,"column":98,"offset":3736},"end":{"line":78,"column":128,"offset":3766}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".py","position":{"start":{"line":78,"column":128,"offset":3766},"end":{"line":78,"column":133,"offset":3771}}}],"position":{"start":{"line":78,"column":128,"offset":3766},"end":{"line":78,"column":133,"offset":3771}}},{"type":"text","value":" file is a module, but it’s generally used for files whose variables and functions are meant for other Python files to import.","position":{"start":{"line":78,"column":133,"offset":3771},"end":{"line":78,"column":259,"offset":3897}}}],"position":{"start":{"line":78,"column":1,"offset":3639},"end":{"line":78,"column":259,"offset":3897}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"package: A Python ","position":{"start":{"line":79,"column":4,"offset":3901},"end":{"line":79,"column":22,"offset":3919}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"package","position":{"start":{"line":79,"column":24,"offset":3921},"end":{"line":79,"column":31,"offset":3928}}}],"position":{"start":{"line":79,"column":22,"offset":3919},"end":{"line":79,"column":33,"offset":3930}}},{"type":"text","value":", which is a higher-level structure of related modules (typically a folder with ","position":{"start":{"line":79,"column":33,"offset":3930},"end":{"line":79,"column":113,"offset":4010}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"__init__.py","position":{"start":{"line":79,"column":113,"offset":4010},"end":{"line":79,"column":126,"offset":4023}}}],"position":{"start":{"line":79,"column":113,"offset":4010},"end":{"line":79,"column":126,"offset":4023}}},{"type":"text","value":" inside). But packages and modules aren’t defined solely by folder hierarchy—more on that in the next section.","position":{"start":{"line":79,"column":126,"offset":4023},"end":{"line":79,"column":236,"offset":4133}}}],"position":{"start":{"line":79,"column":1,"offset":3898},"end":{"line":79,"column":236,"offset":4133}}},{"type":"text","value":"\n"}],"position":{"start":{"line":74,"column":1,"offset":2934},"end":{"line":79,"column":236,"offset":4133}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"script-vs-module"},"children":[{"type":"text","value":"Script vs. Module","position":{"start":{"line":81,"column":4,"offset":4138},"end":{"line":81,"column":21,"offset":4155}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#script-vs-module"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":81,"column":1,"offset":4135},"end":{"line":81,"column":21,"offset":4155}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Python offers both scripting flexibility and the robustness of more complex languages. Unlike some languages, you don’t need a main file called ","position":{"start":{"line":83,"column":1,"offset":4157},"end":{"line":83,"column":145,"offset":4301}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"main.py","position":{"start":{"line":83,"column":145,"offset":4301},"end":{"line":83,"column":154,"offset":4310}}}],"position":{"start":{"line":83,"column":145,"offset":4301},"end":{"line":83,"column":154,"offset":4310}}},{"type":"text","value":" with a ","position":{"start":{"line":83,"column":154,"offset":4310},"end":{"line":83,"column":162,"offset":4318}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Main","position":{"start":{"line":83,"column":162,"offset":4318},"end":{"line":83,"column":168,"offset":4324}}}],"position":{"start":{"line":83,"column":162,"offset":4318},"end":{"line":83,"column":168,"offset":4324}}},{"type":"text","value":" class and a ","position":{"start":{"line":83,"column":168,"offset":4324},"end":{"line":83,"column":181,"offset":4337}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"main()","position":{"start":{"line":83,"column":181,"offset":4337},"end":{"line":83,"column":189,"offset":4345}}}],"position":{"start":{"line":83,"column":181,"offset":4337},"end":{"line":83,"column":189,"offset":4345}}},{"type":"text","value":" function. But Python still needs a starting point in a complex program.","position":{"start":{"line":83,"column":189,"offset":4345},"end":{"line":83,"column":261,"offset":4417}}}],"position":{"start":{"line":83,"column":1,"offset":4157},"end":{"line":83,"column":261,"offset":4417}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This starting point is the ","position":{"start":{"line":85,"column":1,"offset":4419},"end":{"line":85,"column":28,"offset":4446}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".py","position":{"start":{"line":85,"column":28,"offset":4446},"end":{"line":85,"column":33,"offset":4451}}}],"position":{"start":{"line":85,"column":28,"offset":4446},"end":{"line":85,"column":33,"offset":4451}}},{"type":"text","value":" file after ","position":{"start":{"line":85,"column":33,"offset":4451},"end":{"line":85,"column":45,"offset":4463}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python","position":{"start":{"line":85,"column":45,"offset":4463},"end":{"line":85,"column":53,"offset":4471}}}],"position":{"start":{"line":85,"column":45,"offset":4463},"end":{"line":85,"column":53,"offset":4471}}},{"type":"text","value":" (without the ","position":{"start":{"line":85,"column":53,"offset":4471},"end":{"line":85,"column":67,"offset":4485}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"-m","position":{"start":{"line":85,"column":67,"offset":4485},"end":{"line":85,"column":71,"offset":4489}}}],"position":{"start":{"line":85,"column":67,"offset":4485},"end":{"line":85,"column":71,"offset":4489}}},{"type":"text","value":" parameter). Python sets the ","position":{"start":{"line":85,"column":71,"offset":4489},"end":{"line":85,"column":100,"offset":4518}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"__name__","position":{"start":{"line":85,"column":100,"offset":4518},"end":{"line":85,"column":110,"offset":4528}}}],"position":{"start":{"line":85,"column":100,"offset":4518},"end":{"line":85,"column":110,"offset":4528}}},{"type":"text","value":" attribute of this main file to ","position":{"start":{"line":85,"column":110,"offset":4528},"end":{"line":85,"column":142,"offset":4560}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"\"__main__\"","position":{"start":{"line":85,"column":142,"offset":4560},"end":{"line":85,"column":154,"offset":4572}}}],"position":{"start":{"line":85,"column":142,"offset":4560},"end":{"line":85,"column":154,"offset":4572}}},{"type":"text","value":". This allows Python to treat it as the main script file, even if it's part of a larger library, with no knowledge of sibling or other related modules.","position":{"start":{"line":85,"column":154,"offset":4572},"end":{"line":85,"column":305,"offset":4723}}}],"position":{"start":{"line":85,"column":1,"offset":4419},"end":{"line":85,"column":305,"offset":4723}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Other modules are used by importing them in the main module (or script). The import command tells Python where to find the module’s code and the relationships between modules in the package hierarchy. Alternatively, the ","position":{"start":{"line":87,"column":1,"offset":4725},"end":{"line":87,"column":221,"offset":4945}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"-m","position":{"start":{"line":87,"column":221,"offset":4945},"end":{"line":87,"column":225,"offset":4949}}}],"position":{"start":{"line":87,"column":221,"offset":4945},"end":{"line":87,"column":225,"offset":4949}}},{"type":"text","value":" option provides this structure, e.g., ","position":{"start":{"line":87,"column":225,"offset":4949},"end":{"line":87,"column":264,"offset":4988}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"python -m sound.formats.wavwrite","position":{"start":{"line":87,"column":264,"offset":4988},"end":{"line":87,"column":298,"offset":5022}}}],"position":{"start":{"line":87,"column":264,"offset":4988},"end":{"line":87,"column":298,"offset":5022}}},{"type":"text","value":", which allows ","position":{"start":{"line":87,"column":298,"offset":5022},"end":{"line":87,"column":313,"offset":5037}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"wavwrite.py","position":{"start":{"line":87,"column":313,"offset":5037},"end":{"line":87,"column":326,"offset":5050}}}],"position":{"start":{"line":87,"column":313,"offset":5037},"end":{"line":87,"column":326,"offset":5050}}},{"type":"text","value":" to execute and know its relative position in the hierarchy.","position":{"start":{"line":87,"column":326,"offset":5050},"end":{"line":87,"column":386,"offset":5110}}}],"position":{"start":{"line":87,"column":1,"offset":4725},"end":{"line":87,"column":386,"offset":5110}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"absolute-import-vs-relative-import"},"children":[{"type":"text","value":"Absolute Import vs. Relative Import","position":{"start":{"line":89,"column":4,"offset":5115},"end":{"line":89,"column":39,"offset":5150}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#absolute-import-vs-relative-import"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":89,"column":1,"offset":5112},"end":{"line":89,"column":39,"offset":5150}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The examples at the beginning use absolute imports (no leading ","position":{"start":{"line":91,"column":1,"offset":5152},"end":{"line":91,"column":64,"offset":5215}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".","position":{"start":{"line":91,"column":64,"offset":5215},"end":{"line":91,"column":67,"offset":5218}}}],"position":{"start":{"line":91,"column":64,"offset":5215},"end":{"line":91,"column":67,"offset":5218}}},{"type":"text","value":"), whereas relative imports (","position":{"start":{"line":91,"column":67,"offset":5218},"end":{"line":91,"column":96,"offset":5247}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".","position":{"start":{"line":91,"column":96,"offset":5247},"end":{"line":91,"column":99,"offset":5250}}}],"position":{"start":{"line":91,"column":96,"offset":5247},"end":{"line":91,"column":99,"offset":5250}}},{"type":"text","value":" for current directory, ","position":{"start":{"line":91,"column":99,"offset":5250},"end":{"line":91,"column":123,"offset":5274}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"..","position":{"start":{"line":91,"column":123,"offset":5274},"end":{"line":91,"column":127,"offset":5278}}}],"position":{"start":{"line":91,"column":123,"offset":5274},"end":{"line":91,"column":127,"offset":5278}}},{"type":"text","value":" for parent directory) are for internal code that's almost never run as the main module.","position":{"start":{"line":91,"column":127,"offset":5278},"end":{"line":91,"column":215,"offset":5366}}}],"position":{"start":{"line":91,"column":1,"offset":5152},"end":{"line":91,"column":215,"offset":5366}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Returning to the file structure above, if ","position":{"start":{"line":93,"column":1,"offset":5368},"end":{"line":93,"column":43,"offset":5410}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"sound/effects/surround.py","position":{"start":{"line":93,"column":43,"offset":5410},"end":{"line":93,"column":70,"offset":5437}}}],"position":{"start":{"line":93,"column":43,"offset":5410},"end":{"line":93,"column":70,"offset":5437}}},{"type":"text","value":" needs functions from ","position":{"start":{"line":93,"column":70,"offset":5437},"end":{"line":93,"column":92,"offset":5459}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"sound/formats/wavwrite.py","position":{"start":{"line":93,"column":92,"offset":5459},"end":{"line":93,"column":119,"offset":5486}}}],"position":{"start":{"line":93,"column":92,"offset":5459},"end":{"line":93,"column":119,"offset":5486}}},{"type":"text","value":" and ","position":{"start":{"line":93,"column":119,"offset":5486},"end":{"line":93,"column":124,"offset":5491}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"sound/effects/echo.py","position":{"start":{"line":93,"column":124,"offset":5491},"end":{"line":93,"column":147,"offset":5514}}}],"position":{"start":{"line":93,"column":124,"offset":5491},"end":{"line":93,"column":147,"offset":5514}}},{"type":"text","value":", you could write:","position":{"start":{"line":93,"column":147,"offset":5514},"end":{"line":93,"column":165,"offset":5532}}}],"position":{"start":{"line":93,"column":1,"offset":5368},"end":{"line":93,"column":165,"offset":5532}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark-dimmed","style":"background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#768390"},"children":[{"type":"text","value":"# in sound/effects/surround.py"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"from"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" ..formats "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" wavwrite"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"from"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" . "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F47067"},"children":[{"type":"text","value":"import"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#ADBAC7"},"children":[{"type":"text","value":" echo"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"organizing-code-for-reuse"},"children":[{"type":"text","value":"Organizing Code for Reuse","position":{"start":{"line":101,"column":4,"offset":5633},"end":{"line":101,"column":29,"offset":5658}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#organizing-code-for-reuse"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":101,"column":1,"offset":5630},"end":{"line":101,"column":29,"offset":5658}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Finally, after years of coding, I’m drafting a paper, and now I need to organize previous analysis code into a project. Each time I tried to unify everything, import errors between modules were an issue. This post resulted from that experience.","position":{"start":{"line":103,"column":1,"offset":5660},"end":{"line":103,"column":245,"offset":5904}}}],"position":{"start":{"line":103,"column":1,"offset":5660},"end":{"line":103,"column":245,"offset":5904}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here's a recommended project structure from ","position":{"start":{"line":105,"column":1,"offset":5906},"end":{"line":105,"column":45,"offset":5950}}},{"type":"element","tagName":"a","properties":{"href":"https://gist.github.com/ericmjl/27e50331f24db3e8f957d1fe7bbbe510","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"this article","position":{"start":{"line":105,"column":46,"offset":5951},"end":{"line":105,"column":58,"offset":5963}}}],"position":{"start":{"line":105,"column":45,"offset":5950},"end":{"line":105,"column":125,"offset":6030}}},{"type":"text","value":":","position":{"start":{"line":105,"column":125,"offset":6030},"end":{"line":105,"column":126,"offset":6031}}}],"position":{"start":{"line":105,"column":1,"offset":5906},"end":{"line":105,"column":126,"offset":6031}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"|- notebooks/\n   |- 01-first-logical-notebook.ipynb\n   |- 02-second-logical-notebook.ipynb\n   |- prototype-notebook.ipynb\n   |- archive/\n      |- no-longer-useful.ipynb\n|- projectname/\n   |- projectname/\n      |- __init__.py\n      |- config.py\n      |- data.py\n      |- utils.py\n   |- setup.py\n|- README.md\n|- data/\n   |- raw/\n   |- processed/\n   |- cleaned/\n|- scripts/\n   |- script1.py\n   |- script2.py\n   |- archive/\n      |- no-longer-useful.py\n|- environment.yml\n"}],"position":{"start":{"line":107,"column":1,"offset":6033},"end":{"line":132,"column":4,"offset":6508}}}],"position":{"start":{"line":107,"column":1,"offset":6033},"end":{"line":132,"column":4,"offset":6508}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This structure allows you to convert tools into an installable library. Now, you can use ","position":{"start":{"line":134,"column":1,"offset":6510},"end":{"line":134,"column":90,"offset":6599}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"projectname","position":{"start":{"line":134,"column":90,"offset":6599},"end":{"line":134,"column":103,"offset":6612}}}],"position":{"start":{"line":134,"column":90,"offset":6599},"end":{"line":134,"column":103,"offset":6612}}},{"type":"text","value":" in notebooks and scripts just like ","position":{"start":{"line":134,"column":103,"offset":6612},"end":{"line":134,"column":139,"offset":6648}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"numpy","position":{"start":{"line":134,"column":139,"offset":6648},"end":{"line":134,"column":146,"offset":6655}}}],"position":{"start":{"line":134,"column":139,"offset":6648},"end":{"line":134,"column":146,"offset":6655}}},{"type":"text","value":" or ","position":{"start":{"line":134,"column":146,"offset":6655},"end":{"line":134,"column":150,"offset":6659}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pandas","position":{"start":{"line":134,"column":150,"offset":6659},"end":{"line":134,"column":158,"offset":6667}}}],"position":{"start":{"line":134,"column":150,"offset":6659},"end":{"line":134,"column":158,"offset":6667}}},{"type":"text","value":".","position":{"start":{"line":134,"column":158,"offset":6667},"end":{"line":134,"column":159,"offset":6668}}}],"position":{"start":{"line":134,"column":1,"offset":6510},"end":{"line":134,"column":159,"offset":6668}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To use the code, install it with:","position":{"start":{"line":136,"column":1,"offset":6670},"end":{"line":136,"column":34,"offset":6703}}}],"position":{"start":{"line":136,"column":1,"offset":6670},"end":{"line":136,"column":34,"offset":6703}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark-dimmed","style":"background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":"cd"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":" projectname"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#F69D50"},"children":[{"type":"text","value":"pip"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":" install"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#6CB6FF"},"children":[{"type":"text","value":" -e"}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#96D0FF"},"children":[{"type":"text","value":" ."}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"references"},"children":[{"type":"text","value":"References","position":{"start":{"line":143,"column":4,"offset":6753},"end":{"line":143,"column":14,"offset":6763}}},{"type":"element","tagName":"a","properties":{"ariaHidden":"true","tabIndex":-1,"href":"#references"},"children":[{"type":"element","tagName":"span","properties":{"className":["icon","icon-link"]},"children":[]}]}],"position":{"start":{"line":143,"column":1,"offset":6750},"end":{"line":143,"column":14,"offset":6763}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/7948494/whats-the-difference-between-a-python-module-and-a-python-package","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"What’s the difference between a Python module and a Python package?","position":{"start":{"line":145,"column":4,"offset":6768},"end":{"line":145,"column":71,"offset":6835}}}],"position":{"start":{"line":145,"column":3,"offset":6767},"end":{"line":145,"column":183,"offset":6947}}},{"type":"text","value":" All Python files are modules, while a package is a specific kind of module.","position":{"start":{"line":145,"column":183,"offset":6947},"end":{"line":145,"column":259,"offset":7023}}}],"position":{"start":{"line":145,"column":1,"offset":6765},"end":{"line":145,"column":259,"offset":7023}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Official explanation of Python modules: ","position":{"start":{"line":146,"column":3,"offset":7026},"end":{"line":146,"column":43,"offset":7066}}},{"type":"element","tagName":"a","properties":{"href":"https://docs.python.org/3/tutorial/modules.html","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"https://docs.python.org/3/tutorial/modules.html","position":{"start":{"line":146,"column":43,"offset":7066},"end":{"line":146,"column":90,"offset":7113}}}],"position":{"start":{"line":146,"column":43,"offset":7066},"end":{"line":146,"column":90,"offset":7113}}}],"position":{"start":{"line":146,"column":1,"offset":7024},"end":{"line":146,"column":90,"offset":7113}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/14132789/relative-imports-for-the-billionth-time","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"StackOverflow: \"run as module\" is different from \"run as script\".","position":{"start":{"line":147,"column":4,"offset":7117},"end":{"line":147,"column":69,"offset":7182}}}],"position":{"start":{"line":147,"column":3,"offset":7116},"end":{"line":147,"column":156,"offset":7269}}},{"type":"text","value":" Running as a module sets the ","position":{"start":{"line":147,"column":156,"offset":7269},"end":{"line":147,"column":186,"offset":7299}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"__name__","position":{"start":{"line":147,"column":186,"offset":7299},"end":{"line":147,"column":196,"offset":7309}}}],"position":{"start":{"line":147,"column":186,"offset":7299},"end":{"line":147,"column":196,"offset":7309}}},{"type":"text","value":" attribute to the module’s name, while running as a script sets it to ","position":{"start":{"line":147,"column":196,"offset":7309},"end":{"line":147,"column":266,"offset":7379}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"__main__","position":{"start":{"line":147,"column":266,"offset":7379},"end":{"line":147,"column":276,"offset":7389}}}],"position":{"start":{"line":147,"column":266,"offset":7379},"end":{"line":147,"column":276,"offset":7389}}},{"type":"text","value":".","position":{"start":{"line":147,"column":276,"offset":7389},"end":{"line":147,"column":277,"offset":7390}}}],"position":{"start":{"line":147,"column":1,"offset":7114},"end":{"line":147,"column":277,"offset":7390}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"A project organization tutorial: ","position":{"start":{"line":148,"column":3,"offset":7393},"end":{"line":148,"column":36,"offset":7426}}},{"type":"element","tagName":"a","properties":{"href":"https://realpython.com/python-application-layouts/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"https://realpython.com/python-application-layouts/","position":{"start":{"line":148,"column":36,"offset":7426},"end":{"line":148,"column":86,"offset":7476}}}],"position":{"start":{"line":148,"column":36,"offset":7426},"end":{"line":148,"column":86,"offset":7476}}}],"position":{"start":{"line":148,"column":1,"offset":7391},"end":{"line":148,"column":86,"offset":7476}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Official documentation on packaging: ","position":{"start":{"line":149,"column":3,"offset":7479},"end":{"line":149,"column":40,"offset":7516}}},{"type":"element","tagName":"a","properties":{"href":"https://packaging.python.org/en/latest/tutorials/packaging-projects/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"https://packaging.python.org/en/latest/tutorials/packaging-projects/","position":{"start":{"line":149,"column":40,"offset":7516},"end":{"line":149,"column":108,"offset":7584}}}],"position":{"start":{"line":149,"column":40,"offset":7516},"end":{"line":149,"column":108,"offset":7584}}}],"position":{"start":{"line":149,"column":1,"offset":7477},"end":{"line":149,"column":108,"offset":7584}}},{"type":"text","value":"\n"}],"position":{"start":{"line":145,"column":1,"offset":6765},"end":{"line":149,"column":108,"offset":7584}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":150,"column":1,"offset":7585}}},"collectedBy":[["md",[{"slug":"python-test-notes","filename":"2023-10-16-python-test-notes.md","date":"2023-10-16","title":".py | Python Testing Notes","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\n## Some Terms\n\n### Debugging and Testing\n\nDebugging is generally done by the code's author and is used to check the program's execution process for mismatches between thought process and implementation. Debugging code is usually written alongside the main program and includes error handling and logging. Simple debugging can use `print` and `assert` statements, while more complex programs can use the `logging` module.\n\nTesting, on the other hand, is generally done by a third party. The test code is separated from the program code, and the person writing the tests doesn’t need to understand the exact workings of the program—only whether the program produces the declared output given certain inputs.\n\n### Unit Testing\n\nUnit testing is a process that verifies the correctness of a module, function, or class.\n\nThe testing method involves writing a set of test cases, where the tester provides various inputs to the module to check if its output is correct, and also verifies if the program correctly identifies and handles invalid inputs by raising exceptions.\n\nPassing all unit tests doesn’t guarantee that the entire program is error-free, but failing any unit test definitely indicates a problem with the program.\n\n### Documentation Testing\n\nDocumentation provides an overview of a code’s functionality, often with examples that include sample code and expected output. This process is similar to unit testing, except that it's purely descriptive.\n\nDocumentation testing is an automated process that finds example code within the documentation, runs it, and compares the output with the documented results.\n\n### Integration Testing\n\nIntegration testing simulates user behavior by testing the interactions between various modules, ensuring that the program can work properly in a production environment.\n\n## Testing in Python\n\n### File Structure\n\nIn the previous article, I mentioned the `src-layout` structure, which is also discussed in an [official blog post on setuptools](https://blog.ionelmc.ro/2014/05/25/python-packaging/#the-structure). One advantage of this file structure is that the test folder is typically at the same level as `src/` instead of the package itself. This way, you need to install the package in a virtual environment before running the tests, avoiding potential discrepancies between test code and user-downloaded content.\n\n```\n<project_name> \n├── LICENSE \n├── pyproject.toml \n├── README.md \n├── src/ \n│ └── <package_name>/ \n│ ├── init.py \n│ └── example.py \n└── tests/\n```\n\n\n### Unit Testing with `unittest`\n\n`unittest` is Python’s built-in unit testing library.\n\nA basic test script looks like this:\n\n```python\nimport unittest\n\nclass TestName1(unittest.TestCase):\n\n    def test_sum(self):\n        self.assertEqual(sum([1, 2, 3]), 6, \"Should be 6\")\n\n    def test_sum_tuple(self):\n        self.assertEqual(sum((1, 2, 2)), 6, \"Should be 6\")\n\nclass TestName2(unittest.TestCase):\n\n    def test_sum(self):\n        self.assertEqual(sum([1, 2, 3]), 6, \"Should be 6\")\n\n    def test_sum_tuple(self):\n        self.assertEqual(sum((1, 2, 2)), 6, \"Should be 6\")\n\nif __name__ == '__main__':\n    unittest.main()\n```\n\n- The test cases are wrapped in a class that inherits from `unittest.TestCase`.\n- All test method names begin with \"test\". Limited properties are testable as they use built-in methods prefixed with `self.`. Some of these are in the table below, with `[assertTrue(x)](https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertTrue)` and `assertRaises(Exception)` being especially versatile.\n- When run as `'__main__'`, it executes the built-in `unittest.main()` function.\n- Running the script requires specifying the script filename in Python. If you install the `nose2` library, you can run `python -m nose2`, which will automatically discover and execute all tests. (`unittest` also seems to have an automatic discovery feature.)\n\n### Documentation Testing\n\nhttps://www.liaoxuefeng.com/wiki/1016959663602400/1017605739507840\n\nPython's documentation testing uses the `doctest` library, as shown below:\n\n```python\nclass Dict(dict):\n    '''\n    Simple dict but also supports access as x.y style.\n\n    >>> d1 = Dict()\n    >>> d1['x'] = 100\n    >>> d1.x\n    100\n    >>> d1.y = 200\n    >>> d1['y']\n    200\n    >>> d2 = Dict(a=1, b=2, c='3')\n    >>> d2.c\n    '3'\n    >>> d2['empty']\n    Traceback (most recent call last):\n        ...\n    KeyError: 'empty'\n    >>> d2.empty\n    Traceback (most recent call last):\n        ...\n    AttributeError: 'Dict' object has no attribute 'empty'\n    '''\n    def __init__(self, **kw):\n        super(Dict, self).__init__(**kw)\n\n    def __getattr__(self, key):\n        try:\n            return self[key]\n        except KeyError:\n            raise AttributeError(r\"'Dict' object has no attribute '%s'\" % key)\n\n    def __setattr__(self, key, value):\n        self[key] = value\n\nif __name__ == '__main__':\n    import doctest\n    doctest.testmod()\n```\n\nWith `docstring` indentation preserved, lines beginning with `>>>` are treated as tests, with the following lines as expected outputs. For expected errors, you can use `...` to omit intermediate error details.\n\nIntegration Testing\n\nYou can also use unittest for integration testing.\n\nThe main difference from unit testing is that integration tests often involve setting up a test dataset. This requires overriding unittest.TestCase.setup().\n\n```python\nclass TestComplexData(unittest.TestCase):\n    def setUp(self):\n        # load test data\n        self.app = App(database='fixtures/test_complex.json')\n\n    def test_customer_count(self):\n        self.assertEqual(len(self.app.customers), 10000)\n\n    def test_existence_of_customer(self):\n        customer = self.app.get_customer(id=9999)\n        self.assertEqual(customer.name, u\"バナナ\")\n        self.assertEqual(customer.address, \"10 Red Road, Akihabara, Tokyo\")\n\nif __name__ == '__main__':\n    unittest.main()\n```\n"},{"slug":"python-packaging","filename":"2023-10-13-python-packaging.md","date":"2023-10-13","title":".py | Making Your Code Usable by Others","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\n> Here, \"others\" also includes the version of yourself six months later, who may no longer remember how this code was written.\n\nSome time ago, I wrote an article called [**Using Import to Reference Existing Code**](https://mountaye.github.io/blog/articles/python-import-script-module-package), which explained how to use code written by others. I briefly mentioned a module's `setup.py` file at the end but didn’t go further. Now, let’s continue.\n\n- [https://packaging.python.org/en/latest/tutorials/packaging-projects/](https://packaging.python.org/en/latest/tutorials/packaging-projects/)\n- [https://setuptools.pypa.io/en/latest/userguide/quickstart.html](https://setuptools.pypa.io/en/latest/userguide/quickstart.html)\n\n## Basic Process\n\n- Write your code and structure the project files in a specific way (see next section).\n- According to your project structure, fill in a `pyproject.toml`, `setup.cfg`, **or** `setup.py` **file**.\n- Install the `build` library, then run `python -m build` to create a `dist/` folder with your built files. Optionally, upload the project to PyPi or Conda.\n\n## Project File Structure\n\nCommon file structures include the src-layout and flat-layout. Some small projects consist of a single Python file.\n\n### src-layout\n\nIn the src-layout, the folder containing the package source code has another folder above it, typically named `src` (although it could be named differently). The `pyproject.toml` file is on the same level as the `src/` folder.\n\n```\n<project_name> \n    ├── LICENSE \n    ├── pyproject.toml \n    ├── README.md \n    ├── src/ \n    │   └── <package_name>/\n    │   ├── init.py \n    │   └── example.py \n    └── tests/\n```\n\n### flat-layout\n\nIn a flat-layout, the folder containing the package source code is directly under the top level of the project, on the same level as `pyproject.toml`.\n\nThis structure is older and not generally recommended.\n\n```\n<project_name> \n    ├── pyproject.toml # and/or setup.cfg/setup.py\n    ├── <package_name> \n    |   ├── init.py \n    |   └── ... (other Python files) \n    ├── test \n    |   └── ... (test files) \n    ├── README.md \n    └── LICENSE \n```\n\n\n### Single-File Project\n\nThis can be considered a special case of flat-layout.\n\n```\n<project_name> \n    ├── pyproject.toml # and/or setup.cfg/setup.py \n    ├── <my_module>.py \n    ├── README.rst or README.md \n    └── LICENSE\n```\n\n\n## Filling in `pyproject.toml`, `setup.cfg`, **or** `setup.py` **File**\n\nTo package your code into an installable package, at least one of these three files must appear in the project root.\n\nThe file must contain project information in the syntax specific to its extension, most of which is self-explanatory.\n\nKey parameters, such as `name`, `packages`, and `package_dir`, are based on the file structure. If the file structure fully follows the structure outlined in the previous section, then [automatic discovery](https://setuptools.pypa.io/en/latest/userguide/package_discovery.html#automatic-discovery) with `setuptools.find_packages()` should suffice.\n\n### `name`\n\nThis is a required parameter.\n\nNote: In the file structure from the previous section, there are two names: `<project_name>` and `<package_name>`.\n\n- `<project_name>` is the name of the development project as a whole. If you are using a version control system like git, this is the name of your repository.\n- `<package_name>` can—but doesn’t have to—be the name you import in other code. This import name is specified by the `name` parameter in `pyproject.toml` / `setup.cfg` **/** `setup.py`. It cannot contain hyphens and can only use underscores.\n\nIf your `name` parameter differs from `<package_name>`, you must also set the `package_dir` parameter.\n\nThere is also a third name: the one used for `pip install __` when uploaded to PyPI. This name can contain hyphens, like `scikit-image`.\n\n### `packages`\n\nThis parameter is a list, but it typically takes the result of `setuptools.find_packages()`.\n\nThe `find_packages()` function commonly accepts three optional parameters:\n\n- `where`: A path relative to `setup.py`\n- `include`: A list of glob patterns\n- `exclude`: A list of glob patterns\n\nLeaving all parameters blank uses automatic discovery.\n\n### `package_dir`\n\nThis parameter is a dictionary with two main uses:\n\n- In a standard src-layout, simply write `{\"\": \"src/\"}`, indicating that all code is within this folder.\n- If the Python module structure differs from the code file structure, use this dictionary to define the mapping between modules and folders.\n\nFile paths are relative to `setup.py`.\n\n### `py_modules`\n\nThis parameter is a list of file paths, mostly used for single-file structures.\n\n## Building and Uploading\n\nInstall the build tool: `python3 -m pip install --upgrade build`\n\nRun the build: `python3 -m build`\n\nThis will create a `dist/` folder containing the build files.\n\nTo allow others to install your program using `pip install`, you need to upload the build to PyPI. Instructions are [here](https://packaging.python.org/en/latest/tutorials/packaging-projects/#uploading-the-distribution-archives).\n\n## Installation\n\n### Static Installation\n\nPackages already uploaded to PyPI can be installed with `pip install <package>`. This is called static installation.\n\n### Dynamic Installation\n\nFor packages still under development, run `pip install -e .` in the directory containing `setup.py`. This is called dynamic installation because changes in the code are reflected in the referencing projects in real time.\n\n## Exercises\n\nHere is the file structure of a [data analysis project](https://gist.github.com/ericmjl/27e50331f24db3e8f957d1fe7bbbe510), slightly modified:\n\n```\n/path/to/project/directory/ \n    |-- notebooks/ \n        |-- 01-first-logical-notebook.ipynb \n        |-- 02-second-logical-notebook.ipynb \n        |-- prototype-notebook.ipynb \n        |-- archive/ \n            |-- no-longer-useful.ipynb \n    |-- src/ \n        |-- projectname/ \n            |-- init.py \n            |-- config.py \n            |-- data.py \n            |-- utils.py \n            |-- setup.py \n    |-- README.md \n    |-- data/ \n    |-- raw/ \n    |-- processed/ \n    |-- cleaned/ \n    |-- scripts/ \n        |-- script1.py \n        |-- script2.py \n        |-- archive/ \n            |-- no-longer-useful.py \n    |-- environment.yml\n```\n\nQuestions:\n\n1. Is this a flat-layout or src-layout?\n2. How should setup.py be written? What would be the output of `pwd` when executing a dynamic installation?\n"},{"slug":"python-subprocess-run-bash","filename":"2022-07-08-python-subprocess-run-bash.md","date":"2022-07-08","title":".py | Executing Bash Commands with python.subprocess","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\nThe touchscreen on my laptop has a crack from a drop. At first, it wasn’t a problem, but in recent weeks, it has worsened, and sometimes the cursor goes wild and doesn’t respond to commands. So, I needed to disable the touchscreen as an input device.\n\nIn the Xorg desktop environment, you can use `xinput list` to display all input devices along with their corresponding ID numbers. Once you locate the device’s ID, you can disable it with `xinput disable ##`. Generally, the ID number is stable, so I directly added the disable command to `~/.bashrc`.\n\nHowever, I recently took out my long-neglected Raspberry Pi and, for fun, bought a compact 60% mechanical keyboard. After plugging in the keyboard and logging in with my password, guess what? The new keyboard stopped working, giving me a real scare.\n\nSo, now I need to check the input device IDs each time and pull out the IDs related to the touchscreen (there's more than one) from the `xinput list` output. I need to assign them to a variable and then input this variable into `xinput disable #`. This sequence of actions is beyond my Bash skills, so I considered using Python for the intermediate steps: that is, getting Python to read the Bash command results and write the Bash command statements.\n\nA Google search brought up this result: [https://stackoverflow.com/questions/4256107/running-bash-commands-in-python](https://stackoverflow.com/questions/4256107/running-bash-commands-in-python). After a quick look at the official `subprocess` documentation, I wrote the following snippet, saved it as `~/disable_touchscreen.py`, and added `python ~/disable_touchscreen.py` to my `~/.bashrc`.\n\n```python\nimport subprocess\ncheck = subprocess.run([\"xinput\",\"list\"],capture_output=True)\nfor line in check.stdout.decode(\"utf-8\").split(\"\\n\"):\n    if \"touchscreen\" in line:\n        device = line.partition(\"id=\")[2].partition(\"\\t\")[0]\n        disable = subprocess.run([\"xinput\",\"disable\",str(device)])\n        if disable.returncode == 0:\n            print(f\"Successfully disabled touchscreen device {device}\")\n        else:\n            print(f\"Failed to disable touchscreen device {device}\")\n```\n\n- The core of this code is `subprocess.run()`. The first parameter is the command passed to Bash, which is a list where each element corresponds to each part of the Bash command split by spaces. To get the command’s output, you need to add the `capture_output=True` parameter.\n- The return value of the function is a special data structure. If the command executes successfully, the result is in `.stdout`, which is a binary string `b'xxx...'`, so it needs to be converted to a string with `.decode(\"utf-8\")`.\n\nIf only using Bash:\n\n- My Bash skills can get as far as `xinput list | grep \"touchscreen\"`. Here, `|` is a pipe, which passes the output of the preceding command as input to the following command. To use a pipe in Python, you can refer to this question: https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes.\n- The result of the pipe still needs to be trimmed to get the ID, i.e., `line.partition(\"id=\")[2].partition(\"\\t\")[0]`. This would probably require `awk`, which is challenging but learnable, and at least I know what to learn.\n- But assigning the ID to a variable and then passing this variable into `xinput disable`—I don’t even know where to start with that.\n"},{"slug":"python-import-script-module-package","filename":"2021-12-11-python-import-script-module-package.md","date":"2021-12-11","title":".py | Import Existing Code","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\nLet's explain this using the directory structure provided on the official website:\n\n```\nsound/ Top-level package \n    init.py Initialize the sound package \n    formats/ Subpackage for file format conversions \n        init.py \n        wavread.py \n        wavwrite.py \n        aiffread.py \n        aiffwrite.py \n        auread.py \n        auwrite.py \n        ... \n    effects/ Subpackage for sound effects \n        init.py \n        echo.py \n        surround.py \n        reverse.py \n        ... \n    filters/ Subpackage for filters \n        init.py \n        equalizer.py \n        vocoder.py \n        karaoke.py \n        ...\n```\n\n## Using Existing Python Code\n\nMost programming tutorials start teaching syntax after setting up the environment. But let’s first discuss using code that’s already been written. The simplest way to do this is by installing packages through a package manager:\n\n```bash\npip install sound\n```\n\nThen, if you want to use a function in a specific file (let's say `wavwrite.py` has a function called `write()`), there are multiple ways to import it. Note the different ways to import and call the function:\n\n```python\nimport sound\nsound.formats.wavwrite.write()\n\nfrom sound import formats\nformats.wavwrite.write() \n\nfrom sound.formats import wavwrite\nwavwrite.write()\n\nfrom sound.formats.wavwrite import write\nwrite()\n```\n\nHowever, not all Python code can be installed directly. For example, if a research paper is published along with data processing code, often the code is simply shared in a folder. If you download that folder and try `import sound`, an error will occur, stating that Python can't find a library named sound.\n\n## How Python Locates Code Files\n\nIf you think about it, it’s normal that an error occurs. The previous simple command `import sound` solved the problem magically—finding the library without needing a file path—even though libraries can be located in different parts of the file system.\n\nThis is because Python doesn’t search the entire hard drive. Instead, it uses a variable, typically named `PYTHONPATH`, which holds a list of directories where Python library folders are located. When you enter a command in the terminal, Python will:\n\n- Search the current folder, meaning the folder where you launched the Python command.\n- Look through each folder in the `PYTHONPATH` variable.\n- Finally, check the default location for packages installed by the package manager, typically `<path to python>/site-packages`.\n\nIf the library is found, Python will import it; otherwise, an error occurs.\n\nIn the error mentioned above, if we happen to be in the `sound` folder and run Python, the first condition applies, and `import sound` won’t produce an error. But this won’t work in other locations.\n\n## Terminology: Interactive, Script, Module, Package\n\nExecutable Python commands can be found in the following contexts, with the first being interactive and the last three being file-based:\n\n1. interactive: The Python **interactive interface**, also known as calculator mode, which appears after entering `python` in the command line. Commands entered here display results immediately. Once Python exits, these commands are lost.\n2. script: A Python **script** file, like `somefile.py` when running `python somefile.py` from the command line.\n    1. Python is lightweight, and some commands are worth saving for later reuse, much like Linux commands and bash scripts.\n    2. However, as a fully-featured language, Python can also support complex object-oriented programming. In this sense, the main script file can be considered the main module, serving as the main file and program entry point.\n3. module: A Python **module** file, which you can call with `python -m another` (without a `.py` extension). Technically, any `.py` file is a module, but it’s generally used for files whose variables and functions are meant for other Python files to import.\n4. package: A Python **package**, which is a higher-level structure of related modules (typically a folder with `__init__.py` inside). But packages and modules aren’t defined solely by folder hierarchy—more on that in the next section.\n\n## Script vs. Module\n\nPython offers both scripting flexibility and the robustness of more complex languages. Unlike some languages, you don’t need a main file called `main.py` with a `Main` class and a `main()` function. But Python still needs a starting point in a complex program.\n\nThis starting point is the `.py` file after `python` (without the `-m` parameter). Python sets the `__name__` attribute of this main file to `\"__main__\"`. This allows Python to treat it as the main script file, even if it's part of a larger library, with no knowledge of sibling or other related modules.\n\nOther modules are used by importing them in the main module (or script). The import command tells Python where to find the module’s code and the relationships between modules in the package hierarchy. Alternatively, the `-m` option provides this structure, e.g., `python -m sound.formats.wavwrite`, which allows `wavwrite.py` to execute and know its relative position in the hierarchy.\n\n## Absolute Import vs. Relative Import\n\nThe examples at the beginning use absolute imports (no leading `.`), whereas relative imports (`.` for current directory, `..` for parent directory) are for internal code that's almost never run as the main module.\n\nReturning to the file structure above, if `sound/effects/surround.py` needs functions from `sound/formats/wavwrite.py` and `sound/effects/echo.py`, you could write:\n\n```python\n# in sound/effects/surround.py\nfrom ..formats import wavwrite\nfrom . import echo\n```\n\n## Organizing Code for Reuse\n\nFinally, after years of coding, I’m drafting a paper, and now I need to organize previous analysis code into a project. Each time I tried to unify everything, import errors between modules were an issue. This post resulted from that experience.\n\nHere's a recommended project structure from [this article](https://gist.github.com/ericmjl/27e50331f24db3e8f957d1fe7bbbe510):\n\n```\n|- notebooks/\n   |- 01-first-logical-notebook.ipynb\n   |- 02-second-logical-notebook.ipynb\n   |- prototype-notebook.ipynb\n   |- archive/\n      |- no-longer-useful.ipynb\n|- projectname/\n   |- projectname/\n      |- __init__.py\n      |- config.py\n      |- data.py\n      |- utils.py\n   |- setup.py\n|- README.md\n|- data/\n   |- raw/\n   |- processed/\n   |- cleaned/\n|- scripts/\n   |- script1.py\n   |- script2.py\n   |- archive/\n      |- no-longer-useful.py\n|- environment.yml\n```\n\nThis structure allows you to convert tools into an installable library. Now, you can use `projectname` in notebooks and scripts just like `numpy` or `pandas`.\n\nTo use the code, install it with:\n\n```bash\ncd projectname\npip install -e .\n```\n\n## References\n\n- [What’s the difference between a Python module and a Python package?](https://stackoverflow.com/questions/7948494/whats-the-difference-between-a-python-module-and-a-python-package) All Python files are modules, while a package is a specific kind of module.\n- Official explanation of Python modules: https://docs.python.org/3/tutorial/modules.html\n- [StackOverflow: \"run as module\" is different from \"run as script\".](https://stackoverflow.com/questions/14132789/relative-imports-for-the-billionth-time) Running as a module sets the `__name__` attribute to the module’s name, while running as a script sets it to `__main__`.\n- A project organization tutorial: https://realpython.com/python-application-layouts/\n- Official documentation on packaging: https://packaging.python.org/en/latest/tutorials/packaging-projects/\n"},{"slug":"install-pytorch-cpu-on-fedora","filename":"2021-10-13-install-pytorch-cpu-on-fedora.md","date":"2021-10-13","title":".py | Installing the CPU Version of PyTorch on Fedora","layout":"post","keywords":["md","py","ai"],"excerpt":"Translated by ChatGPT.","content":"\nI'm about to attend a summer school on deep learning applications in microscopic image processing.\n\nDeep learning is a branch of machine learning, where most data can be represented as vectors (first-order tensors) and most algorithms can be broken down into operations or transformations on vectors, represented as matrices (second-order tensors). This need for efficient tensor computation led to libraries like PyTorch, TensorFlow, and others such as Keras, Caffe, and more. In earlier versions, PyTorch and TensorFlow differed significantly, but over time, they've merged in features and have edged out other competitors; they're starting to look increasingly similar. \"They've become what they once hated.\" lol\n\nI'm not sure which machine learning framework will be used in the course, so I've decided to install both PyTorch and TensorFlow (shrug). This is also a continuation of my previous [Python tutorial](python-interpreter-editor-virtualenv).\n\nHere’s my software and hardware setup: an Intel CPU with integrated graphics (can't run *Civilization VI*). Even though my system isn't officially supported on Linux, I’ve managed to get Fedora running smoothly after a few kernel updates. I'm using Python version 3.9.6, pip as my package manager, and VS Code as my editor.\n\n## Creating a Virtual Environment\n\nI explained why to create a virtual environment in the previous post, so let's jump right in. I created two virtual environments, naming them `torch` and `tf`. In the command line snippets, I've added a prompt `(env)[me@mycomputer]$` to show which environment I'm in—remove this prompt when copying the commands.\n\n```bash\n[me@mycomputer]$ mkvirtualenv torch\n(torch)[me@mycomputer]$\n```\n\n## Installation\n\nOn the PyTorch website, find the installation command for your setup: https://pytorch.org/get-started/locally/. In my case, I chose `Stable` > `Linux` > `Pip` > `Python` > `CPU`. Copy the generated command and paste it into the terminal:\n\n```bash\n(torch)[me@mycomputer]$ pip3 install torch==1.9.1+cpu torchvision==0.10.1+cpu torchaudio==0.9.1 -f https://download.pytorch.org/whl/torch_stable.html\n```\n\nWait for the installation messages to confirm success.\n\n## Verification and Deactivation\n\nVerify the installation using the [official guide](https://pytorch.org/get-started/locally/#linux-verification):\n\n```python\nimport torch\nx = torch.rand(5, 3)\nprint(x)\n\n# tensor([[0.3799, 0.4494, 0.4296],\n#       [0.5800, 0.0180, 0.3110],\n#       [0.9847, 0.0125, 0.2648],\n#       [0.0296, 0.3142, 0.9266],\n#       [0.3192, 0.9645, 0.5545]])\n```\n\nNext, deactivate the environment to prepare for installing TensorFlow:\n\n```bash\n(torch)[me@mycomputer]$ deactivate\n[me@mycomputer]$\n```\n\n## What About TensorFlow?\n\nInitially, I planned to cover both PyTorch and TensorFlow in this post, but TensorFlow proved a bit more challenging.\n\n### Direct Installation\n\nGo to the [TensorFlow website](https://www.tensorflow.org/install) and click the \"Install\" button in the top navigation. Then, on the left sidebar, find the package/pip section; the [installation command](https://www.tensorflow.org/install/pip#3.-install-the-tensorflow-pip-package) is just one line:\n\n```bash\npip install --upgrade tensorflow\n```\n\nHowever, this command didn’t work as expected. The installation completed without errors, but running a test produced numerous error messages.\n\nThe error log included `Could not load dynamic library 'libcudart.so.11.0'`, suggesting that this command installed the GPU version by mistake.\n\n### Installing the CPU Version\n\nI found the CPU version download link in the \"Package Location\" section of the page: `https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow_cpu-2.6.0-cp39-cp39-manylinux2010_x86_64.whl`. I deleted the virtual environment, created it again, and reinstalled TensorFlow:\n\n```bash\n(tf)[me@mycomputer]$ deactivate\n[me@mycomputer]$ rmvirtualenv tf\n[me@mycomputer]$ mkvirtualenv tf\n(tf)[me@mycomputer]$ pip install --upgrade pip\n(tf)[me@mycomputer]$ pip install https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow_cpu-2.6.0-cp39-cp39-manylinux2010_x86_64.whl\n```\n\nAfter testing with the official command, I still got warnings:\n\n```bash\n(tf) [shixing@yoga-laptop ~]$ python -c \"import tensorflow as tf;print(tf.reduce_sum(tf.random.normal([1000, 1000])))\"\n20XX-XX-XX XX:XX:XX.XXXXXX: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\ntf.Tensor(-1338.4773, shape=(), dtype=float32)\n```\n\nThis Stack Overflow answer mentions that to avoid this warning, TensorFlow needs to be compiled from source. The official guide to building from source provides more details, but this is quite a hassle, so I’ll cover it in another post (to be continued).\n"},{"slug":"python-interpreter-editor-virtualenv","filename":"2021-06-29-python-interpreter-editor-virtualenv.md","date":"2021-06-29","title":".py | Python's Interpreter, Editor, and Virtual Environment","layout":"post","keywords":["md","py"],"excerpt":"Really, what are Python's interpreter, editor, and virtual environment","content":"\n\nIn the previous post \"[Configuring Python Development Environment on Windows 10](python-installation-and-configuration)\", I did roughly three things:\n- First, I installed the Python interpreter.\n- Second, I installed VSCode on the computer.\n- Third, as we know, is the virtual environment, virtualenv.\n\nIf there's something else worth mentioning, it's to add a bit of \"what\" alongside the \"how\". To make the article flow better, I plan to rearrange the order: first, talk about the editor, then the interpreter, and finally, the virtual environment. Although the article is based on Python, these concepts apply to almost all general-purpose programming languages. Because I'm not from a computer science background, this article is just my study notes, so if there are any inaccuracies, feel free to point them out.\n\n## Editor\n\nFirst, let's do an experiment. Rename the Python file `hello.py` created in the previous tutorial, change the extension `.py` to `.txt`, then double-click to open the file. What happens? In the Windows system, the most ordinary Notepad window pops up, displaying Python statements in black text on a white background, unlike in VSCode where different statements have different colors, but the content is exactly the same.\n\nFurthermore, you can directly execute the content of a `.txt` file in the command line with the Python interpreter (`py -m hello.txt`), with the same effect as `.py`.\n\nThe `.py` extension doesn't do anything special; like a `.txt` file, its content is simply a string of characters readable by humans. Such files are called [text files](https://en.wikipedia.org/wiki/Text_file). An editor is a program that handles text files. Notepad is one type of editor, as is VSCode.\n\nSince Notepad can already write Python code, why bother installing VSCode? Indeed, some people really only use Notepad or other built-in editors of the operating system to write Python code (there's even a video on YouTube of someone writing code in Microsoft Word); then debug the program using the command line. However, VSCode is specifically developed for programmers, providing many features that default editors lack, such as syntax highlighting, which highlights functions, variables, and keywords in different colors.\n\n## Compiler / Interpreter\n\nIn addition to text files, the second type of file mentioned in this article is a [binary file](https://en.wikipedia.org/wiki/Binary_file).\n\nComputers cannot directly understand characters recognized by humans. At the lowest level, classic computers understand only 0s and 1s represented in different ways. Although all files are ultimately binary at the lowest level, the term \"binary file\" is generally used specifically to refer to files other than text files. Since image files, video files, etc., have their own names, the files referred to by this term are basically related to software programs, files that can be executed by computers.\n\nHumans recognize characters, computers recognize only 0s and 1s, so the most intuitive approach is to translate text files into binary files. This translation process is called [compilation](https://en.wikipedia.org/wiki/Compiler), and the software that can accomplish this is called a compiler. Once compilation is complete, the compiler exits, and to execute the program, the computer simply executes the compiled executable file.\n\nHowever, compilation has a problem: the entire software needs to be compiled into a complete executable with all source code text files written. As the scale of the software grows, the resources and time required for compilation increase; once a modification is made, the entire project needs to be recompiled. Many times, we only want to quickly know the effect of a command in a large project; compilation is not suitable for such scenarios.\n\nThus, the [interpreter](https://en.wikipedia.org/wiki/Interpreter_(computing)) emerged. This type of program is much more complex than a compiler. It runs whenever we execute a command in a programming language, allowing us to enter commands one by one, remembering the context of the code, and even remembering the results of our previous commands. The cost is that even for large projects, it needs to analyze and interpret line by line, and its computational resource overhead and speed are not as efficient as compilation.\n\nPython is a (official implementation) programming language that uses an interpreter. The `python-***.exe` file we download from the official website is the Python interpreter. This also means that Python programs tend to perform less well than programs written by C/C++ programmers of the same level. However, due to its suitability for trial and error with single-line execution, Python is quite popular in research fields.\n\nOf course, Python's characteristics are far more than just being an interpreted language. It is also:\n- [Scripting language](https://program-think.blogspot.com/2009/08/why-choose-python-1-script.html)\n- [Dynamic language](https://program-think.blogspot.com/2009/08/why-choose-python-2-dynamic.html)\n- [Object-oriented language](https://program-think.blogspot.com/2010/08/why-choose-python-3-oop.html)\n- [Functional programming language](https://program-think.blogspot.com/2010/08/why-choose-python-3-oop.html)\n- [...](https://program-think.blogspot.com/2010/08/why-choose-python-5-tools.html)\n\n## Virtual Environment\n\nOnce I asked my girlfriend what IDE she uses to write Python, and she proudly replied that her MacBook comes with Python, so she can run it directly from the command line... The problem wasn't that she didn't answer my question directly (actually, thinking about it, she did answer part of the question), but rather that running the system's built-in Python interpreter or other programming language interpreters or compilers directly from the command line is a dangerous practice common among beginner programmers.\n\nFortunately, Windows is fine; after all, it's an operating system aimed at the general consumer, so it doesn't come with Python pre-installed. However, for more geek-oriented operating systems like Linux and the BSD family, things are different. These operating systems (or their distributions) often come pre-installed with Python. This Python isn't intended for users to develop their own programs but rather for the many system tools written in Python to call upon. Since the version of Python is usually controlled by the package manager of the distribution, it often lags behind the latest Python version for some time to avoid bugs in the new version and to give developers of system tools time to update their code. So, if you use this version of Python for development and accidentally upgrade Python, it's likely to cause some system functionality to malfunction.\n\nA virtual environment is Python's solution to this problem. We can install a version of Python different from the system's default version but not add this interpreter to the system path, so the operating system is unaware of the existence of this version of Python. When creating a virtual environment, we specify the use of this specific version of Python. So, after activating the virtual environment, it becomes the Python we need for development, and exiting the virtual environment returns to the Python used by system tools.\n\nMoreover, even if two projects use the same version of Python and both use the system's default version, virtual environments still have a place. Most programs require dependency onlibrary code written by others, called libraries. Different projects may depend on different library code, or different versions of the same library. In this case, you can create separate virtual environments and install the libraries corresponding to each project. Projects can be isolated from each other.\n\n## Editor + Interpreter / Compiler + Virtual Environment Management + ... = IDE\n\nIt's too cumbersome to install so many different programs for Python development. Can't it be done with just one click? Of course it can. A program that integrates various tools used in the development process is called an [integrated development environment (IDE)](https://en.wikipedia.org/wiki/Integrated_development_environment). For Python, the most famous IDE is undoubtedly [Anaconda](https://www.anaconda.com/).\n\nThen why don't I use it? Of course, I've used it before, but after hearing about the fame of VSCode and trying it out, I don't want to go back. Writing Python requires editing `.py` files, writing blog posts requires editing `.md` files, and some blog features require JavaScript. Essentially, all these tasks involve editing text files. In an editor like VSCode, everything is done together. So, programs like Spyder and Jupyter Lab in Anaconda seem redundant.\n\n\"Doing one thing well\" is also part of the [Unix philosophy](https://en.wikipedia.org/wiki/Unix_philosophy). But the problem is that different people have different definitions of \"one thing\". Some people think making breakfast is one thing, while others think it involves several things like heating milk, frying eggs, and toasting bread. Who is right?\n\nPerhaps both are right, but Editor + Interpreter + ... is upstream on the chain of contempt compared to IDE. You may disagree with this, but you should know it; otherwise, when others show off, you might feel embarrassed for not being prepared.\n"},{"slug":"python-installation-and-configuration","filename":"2021-03-07-python-installation-and-configuration.md","date":"2021-03-07","title":".py | Setup a Python Dev Environment","layout":"post","keywords":["md"],"excerpt":"Setup a Python dev environment on a Windows machine, using barebone Python, virtualenvwrapper, vscode, and without Conda.","content":"\nMy Python version has been stuck at 3.7 for a while, but now the latest version is already at 3.9. Recently, I needed to study a piece of Python code written by someone else, who specifically requested Python version 3.6. So, I uninstalled the 3.7 version and reinstalled both Python versions 3.9 and 3.6.\n\nI've been trying to encourage my parents to learn programming for a long time, and I owe them a tutorial. Whether it's for those who are committed to continuous improvement in their first programming language or for those who intend to dabble lightly in programming, Python is an excellent choice. So, even though my parents have no interest in programming whatsoever, I still completed this tutorial, hoping it could help others. Since it's aimed at complete beginners, it's based on the Windows 10 operating system. And because I also use this setup myself, based on personal preference, I didn't directly use `conda`.\n\n## Table of Content\n- python\n    - Download `python` interpreter from the official website\n    - Install `python` interpreter\n- Virtual Environment\n    - Set environment variable\n    - Install `virtualenv` with `pip`\n    - Install `virtualenvwrapper` with `pip`\n    - Create a virtual env, and install `jupyter`\n- Editor/IDE\n    - Download `vscode` from official website\n    - Install `vscode` and related plugins\n    - Verify it works\n\n## Let's go\n\n### Download `python` interpreter from the official website\n\nDownload from the official website of Python ([https://www.python.org/downloads/](https://www.python.org/downloads/)).\n\n![](/blog/photos/2021-03-07-python-official-website.png)\n\n### Install `python` interpreter\n\nAfter executing the downloaded file, you'll see the interface as shown in the screenshot below. Click on the option highlighted in red box because I want to change the installation path. It seems that you can also check the \"Add Python 3.9 to PATH\" at the bottom. I didn't select it during installation, but later I found out that this step needs to be done manually.\n\n![](/blog/photos/2021-03-07-python-install.png)\n\nFollowing that, check each option in the next interface, then click \"Next\".\n\n![](/blog/photos/2021-03-07-python-next.png)\n\nIn the upcoming interface, select \"Install for all users\" and then choose an installation path you prefer. The reason I choose C:\\Python39 for this location is because:\n\n1. The C drive is the system drive and it's a solid-state drive on my machine, which is faster.\n2. The default path is in the personal folder, which is quite hard to find.\n3. `C:\\Program Files` requires administrator permissions, which is inconvenient for using pip for package management.\n\n![](/blog/photos/2021-03-07-python-install-path.png)\n\nAfter the installation is complete, open the command prompt and type `py`. You should see a string of Python version information, and then the command prompt will change to `>>>`, indicating that you have entered the Python environment, where you can execute Python commands line by line. Type `exit()` to exit Python.\n\n### Set environment variable\n\nIn the Windows search bar, type \"environment variables,\" and before you finish typing, you should see the suggested result as shown in the image below:\n\n![](/blog/photos/2021-03-07-environment-variable-search.png)\n\nThen, follow the steps in the image below to complete two tasks:\n1. Add two new values, `C:\\Python39` and `C:\\Python39\\Scripts`, to the `Path` variable.\n2. Create a new folder for storing Python virtual environments (such as `C:\\PythonEnvs`). Create a new variable named `WORKON_HOME` and set its value to `C:\\PythonEnvs`.\n\n![](/blog/photos/2021-03-07-environment-variable-box.png)\n\n### Install `virtualenv` and `virtualenvwrapper` with `pip`\n\nFollowing the steps just now, `pip` should now be installed. You should see similar feedback in the command line after entering the commands along the way:\n\n![](/blog/photos/2021-03-07-pip-check.png)\n\nIf the command line indicates that `pip` is not found, you may need to reinstall it using the method outlined in [this link](https://pip.pypa.io/en/stable/installing/#installing-with-get-pip-py).\n\nType `py -m pip install virtualenv` in the command line to install the virtual environment manager:\n\n![](/blog/photos/2021-03-07-virtualenv-install.png)\n\nAfter a successful installation message appears, type `py -m pip install virtualenvwrapper-win` in the command line. The result should be similar to the image above; I forgot to take a screenshot.\n\n### Create a virtual env, and install `jupyter`\n\nAfter installing `virtualenv` and `virtualenvwrapper`, enter `mkvirtualenv base` in the command line to create a new virtual environment named base.\n\nThen enter `workon base`. At this point, you should see `(base)` at the beginning of the command prompt, indicating that we are now working within the base virtual environment. Now, when you check `pip --version`, you'll notice that the Python location has changed from before.\n\n![Example Image](/blog/photos/2021-03-07-virtualenvwrapper-check.png)\n\nWithin this environment, install Jupyter by typing `pip install jupyter`. While this step is not mandatory, it allows us to have a similar experience to Spyder, which comes with Conda, once we install VSCode. This makes it very convenient for beginners to debug line by line.\n\n### Download and install `vscode`\n\nDownload the installation package from the official website of VS Code ([link here](https://code.visualstudio.com/)), where you'll find a prominent download button:\n\n![](/blog/photos/2021-03-07-vscode-download.png)\n\nAfter downloading, the installation process is similar to that of any other program (it's been a while, so no screenshots).\n\nOnce installed, open the program and click on the icon outlined in red on the left toolbar, then search for Python-related VS Code plugins. For Python development, you generally need `python`, `pylance`, and `jupyter`:\n\n![](/blog/photos/2021-03-07-vscode-plugin.png)\n\nIn the future, when you want to run VS Code, right-click in the folder where you want to start coding and select \"Open with Code\":\n\n![](/blog/photos/2021-03-07-vscode-folder-open.png)\n\nNext, in the VS Code interface, click on the button outlined in red in the file tree to create a new file, name it `*.py`, and here I just wrote something like \"hello.\"\n\n![](/blog/photos/2021-03-07-vscode-new-file.png)\n\nIn the subsequently opened document editing area, type `print(\"Hello World\")`, place the cursor on this line, and press `Shift`+`Enter` to execute this line:\n\n![](/blog/photos/2021-03-07-vscode-run.png)\n\nAs it's the first time executing and since `jupyter` is installed, you should see a prompt in the bottom right corner of VS Code asking if you want to execute the code using the Jupyter interactive window. Then close the terminal below (the cross in the top right corner of the bottom half). Press `Shift`+`Enter` again to execute. At this point, the result should look like the image below. Click on the variable explorer in the red circle, and it's almost the same experience as Spyder.\n\n![](/blog/photos/2021-03-07-vscode-interactive.png)\n\nIn the future, the Jupyter Interactive Window could be called up by typing `Ctrl` + `Shift` + `P` and searching \"interactive\" in the command line that appears on top of the screen.\n"}]],["py",[{"slug":"python-test-notes","filename":"2023-10-16-python-test-notes.md","date":"2023-10-16","title":".py | Python Testing Notes","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\n## Some Terms\n\n### Debugging and Testing\n\nDebugging is generally done by the code's author and is used to check the program's execution process for mismatches between thought process and implementation. Debugging code is usually written alongside the main program and includes error handling and logging. Simple debugging can use `print` and `assert` statements, while more complex programs can use the `logging` module.\n\nTesting, on the other hand, is generally done by a third party. The test code is separated from the program code, and the person writing the tests doesn’t need to understand the exact workings of the program—only whether the program produces the declared output given certain inputs.\n\n### Unit Testing\n\nUnit testing is a process that verifies the correctness of a module, function, or class.\n\nThe testing method involves writing a set of test cases, where the tester provides various inputs to the module to check if its output is correct, and also verifies if the program correctly identifies and handles invalid inputs by raising exceptions.\n\nPassing all unit tests doesn’t guarantee that the entire program is error-free, but failing any unit test definitely indicates a problem with the program.\n\n### Documentation Testing\n\nDocumentation provides an overview of a code’s functionality, often with examples that include sample code and expected output. This process is similar to unit testing, except that it's purely descriptive.\n\nDocumentation testing is an automated process that finds example code within the documentation, runs it, and compares the output with the documented results.\n\n### Integration Testing\n\nIntegration testing simulates user behavior by testing the interactions between various modules, ensuring that the program can work properly in a production environment.\n\n## Testing in Python\n\n### File Structure\n\nIn the previous article, I mentioned the `src-layout` structure, which is also discussed in an [official blog post on setuptools](https://blog.ionelmc.ro/2014/05/25/python-packaging/#the-structure). One advantage of this file structure is that the test folder is typically at the same level as `src/` instead of the package itself. This way, you need to install the package in a virtual environment before running the tests, avoiding potential discrepancies between test code and user-downloaded content.\n\n```\n<project_name> \n├── LICENSE \n├── pyproject.toml \n├── README.md \n├── src/ \n│ └── <package_name>/ \n│ ├── init.py \n│ └── example.py \n└── tests/\n```\n\n\n### Unit Testing with `unittest`\n\n`unittest` is Python’s built-in unit testing library.\n\nA basic test script looks like this:\n\n```python\nimport unittest\n\nclass TestName1(unittest.TestCase):\n\n    def test_sum(self):\n        self.assertEqual(sum([1, 2, 3]), 6, \"Should be 6\")\n\n    def test_sum_tuple(self):\n        self.assertEqual(sum((1, 2, 2)), 6, \"Should be 6\")\n\nclass TestName2(unittest.TestCase):\n\n    def test_sum(self):\n        self.assertEqual(sum([1, 2, 3]), 6, \"Should be 6\")\n\n    def test_sum_tuple(self):\n        self.assertEqual(sum((1, 2, 2)), 6, \"Should be 6\")\n\nif __name__ == '__main__':\n    unittest.main()\n```\n\n- The test cases are wrapped in a class that inherits from `unittest.TestCase`.\n- All test method names begin with \"test\". Limited properties are testable as they use built-in methods prefixed with `self.`. Some of these are in the table below, with `[assertTrue(x)](https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertTrue)` and `assertRaises(Exception)` being especially versatile.\n- When run as `'__main__'`, it executes the built-in `unittest.main()` function.\n- Running the script requires specifying the script filename in Python. If you install the `nose2` library, you can run `python -m nose2`, which will automatically discover and execute all tests. (`unittest` also seems to have an automatic discovery feature.)\n\n### Documentation Testing\n\nhttps://www.liaoxuefeng.com/wiki/1016959663602400/1017605739507840\n\nPython's documentation testing uses the `doctest` library, as shown below:\n\n```python\nclass Dict(dict):\n    '''\n    Simple dict but also supports access as x.y style.\n\n    >>> d1 = Dict()\n    >>> d1['x'] = 100\n    >>> d1.x\n    100\n    >>> d1.y = 200\n    >>> d1['y']\n    200\n    >>> d2 = Dict(a=1, b=2, c='3')\n    >>> d2.c\n    '3'\n    >>> d2['empty']\n    Traceback (most recent call last):\n        ...\n    KeyError: 'empty'\n    >>> d2.empty\n    Traceback (most recent call last):\n        ...\n    AttributeError: 'Dict' object has no attribute 'empty'\n    '''\n    def __init__(self, **kw):\n        super(Dict, self).__init__(**kw)\n\n    def __getattr__(self, key):\n        try:\n            return self[key]\n        except KeyError:\n            raise AttributeError(r\"'Dict' object has no attribute '%s'\" % key)\n\n    def __setattr__(self, key, value):\n        self[key] = value\n\nif __name__ == '__main__':\n    import doctest\n    doctest.testmod()\n```\n\nWith `docstring` indentation preserved, lines beginning with `>>>` are treated as tests, with the following lines as expected outputs. For expected errors, you can use `...` to omit intermediate error details.\n\nIntegration Testing\n\nYou can also use unittest for integration testing.\n\nThe main difference from unit testing is that integration tests often involve setting up a test dataset. This requires overriding unittest.TestCase.setup().\n\n```python\nclass TestComplexData(unittest.TestCase):\n    def setUp(self):\n        # load test data\n        self.app = App(database='fixtures/test_complex.json')\n\n    def test_customer_count(self):\n        self.assertEqual(len(self.app.customers), 10000)\n\n    def test_existence_of_customer(self):\n        customer = self.app.get_customer(id=9999)\n        self.assertEqual(customer.name, u\"バナナ\")\n        self.assertEqual(customer.address, \"10 Red Road, Akihabara, Tokyo\")\n\nif __name__ == '__main__':\n    unittest.main()\n```\n"},{"slug":"python-packaging","filename":"2023-10-13-python-packaging.md","date":"2023-10-13","title":".py | Making Your Code Usable by Others","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\n> Here, \"others\" also includes the version of yourself six months later, who may no longer remember how this code was written.\n\nSome time ago, I wrote an article called [**Using Import to Reference Existing Code**](https://mountaye.github.io/blog/articles/python-import-script-module-package), which explained how to use code written by others. I briefly mentioned a module's `setup.py` file at the end but didn’t go further. Now, let’s continue.\n\n- [https://packaging.python.org/en/latest/tutorials/packaging-projects/](https://packaging.python.org/en/latest/tutorials/packaging-projects/)\n- [https://setuptools.pypa.io/en/latest/userguide/quickstart.html](https://setuptools.pypa.io/en/latest/userguide/quickstart.html)\n\n## Basic Process\n\n- Write your code and structure the project files in a specific way (see next section).\n- According to your project structure, fill in a `pyproject.toml`, `setup.cfg`, **or** `setup.py` **file**.\n- Install the `build` library, then run `python -m build` to create a `dist/` folder with your built files. Optionally, upload the project to PyPi or Conda.\n\n## Project File Structure\n\nCommon file structures include the src-layout and flat-layout. Some small projects consist of a single Python file.\n\n### src-layout\n\nIn the src-layout, the folder containing the package source code has another folder above it, typically named `src` (although it could be named differently). The `pyproject.toml` file is on the same level as the `src/` folder.\n\n```\n<project_name> \n    ├── LICENSE \n    ├── pyproject.toml \n    ├── README.md \n    ├── src/ \n    │   └── <package_name>/\n    │   ├── init.py \n    │   └── example.py \n    └── tests/\n```\n\n### flat-layout\n\nIn a flat-layout, the folder containing the package source code is directly under the top level of the project, on the same level as `pyproject.toml`.\n\nThis structure is older and not generally recommended.\n\n```\n<project_name> \n    ├── pyproject.toml # and/or setup.cfg/setup.py\n    ├── <package_name> \n    |   ├── init.py \n    |   └── ... (other Python files) \n    ├── test \n    |   └── ... (test files) \n    ├── README.md \n    └── LICENSE \n```\n\n\n### Single-File Project\n\nThis can be considered a special case of flat-layout.\n\n```\n<project_name> \n    ├── pyproject.toml # and/or setup.cfg/setup.py \n    ├── <my_module>.py \n    ├── README.rst or README.md \n    └── LICENSE\n```\n\n\n## Filling in `pyproject.toml`, `setup.cfg`, **or** `setup.py` **File**\n\nTo package your code into an installable package, at least one of these three files must appear in the project root.\n\nThe file must contain project information in the syntax specific to its extension, most of which is self-explanatory.\n\nKey parameters, such as `name`, `packages`, and `package_dir`, are based on the file structure. If the file structure fully follows the structure outlined in the previous section, then [automatic discovery](https://setuptools.pypa.io/en/latest/userguide/package_discovery.html#automatic-discovery) with `setuptools.find_packages()` should suffice.\n\n### `name`\n\nThis is a required parameter.\n\nNote: In the file structure from the previous section, there are two names: `<project_name>` and `<package_name>`.\n\n- `<project_name>` is the name of the development project as a whole. If you are using a version control system like git, this is the name of your repository.\n- `<package_name>` can—but doesn’t have to—be the name you import in other code. This import name is specified by the `name` parameter in `pyproject.toml` / `setup.cfg` **/** `setup.py`. It cannot contain hyphens and can only use underscores.\n\nIf your `name` parameter differs from `<package_name>`, you must also set the `package_dir` parameter.\n\nThere is also a third name: the one used for `pip install __` when uploaded to PyPI. This name can contain hyphens, like `scikit-image`.\n\n### `packages`\n\nThis parameter is a list, but it typically takes the result of `setuptools.find_packages()`.\n\nThe `find_packages()` function commonly accepts three optional parameters:\n\n- `where`: A path relative to `setup.py`\n- `include`: A list of glob patterns\n- `exclude`: A list of glob patterns\n\nLeaving all parameters blank uses automatic discovery.\n\n### `package_dir`\n\nThis parameter is a dictionary with two main uses:\n\n- In a standard src-layout, simply write `{\"\": \"src/\"}`, indicating that all code is within this folder.\n- If the Python module structure differs from the code file structure, use this dictionary to define the mapping between modules and folders.\n\nFile paths are relative to `setup.py`.\n\n### `py_modules`\n\nThis parameter is a list of file paths, mostly used for single-file structures.\n\n## Building and Uploading\n\nInstall the build tool: `python3 -m pip install --upgrade build`\n\nRun the build: `python3 -m build`\n\nThis will create a `dist/` folder containing the build files.\n\nTo allow others to install your program using `pip install`, you need to upload the build to PyPI. Instructions are [here](https://packaging.python.org/en/latest/tutorials/packaging-projects/#uploading-the-distribution-archives).\n\n## Installation\n\n### Static Installation\n\nPackages already uploaded to PyPI can be installed with `pip install <package>`. This is called static installation.\n\n### Dynamic Installation\n\nFor packages still under development, run `pip install -e .` in the directory containing `setup.py`. This is called dynamic installation because changes in the code are reflected in the referencing projects in real time.\n\n## Exercises\n\nHere is the file structure of a [data analysis project](https://gist.github.com/ericmjl/27e50331f24db3e8f957d1fe7bbbe510), slightly modified:\n\n```\n/path/to/project/directory/ \n    |-- notebooks/ \n        |-- 01-first-logical-notebook.ipynb \n        |-- 02-second-logical-notebook.ipynb \n        |-- prototype-notebook.ipynb \n        |-- archive/ \n            |-- no-longer-useful.ipynb \n    |-- src/ \n        |-- projectname/ \n            |-- init.py \n            |-- config.py \n            |-- data.py \n            |-- utils.py \n            |-- setup.py \n    |-- README.md \n    |-- data/ \n    |-- raw/ \n    |-- processed/ \n    |-- cleaned/ \n    |-- scripts/ \n        |-- script1.py \n        |-- script2.py \n        |-- archive/ \n            |-- no-longer-useful.py \n    |-- environment.yml\n```\n\nQuestions:\n\n1. Is this a flat-layout or src-layout?\n2. How should setup.py be written? What would be the output of `pwd` when executing a dynamic installation?\n"},{"slug":"python-subprocess-run-bash","filename":"2022-07-08-python-subprocess-run-bash.md","date":"2022-07-08","title":".py | Executing Bash Commands with python.subprocess","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\nThe touchscreen on my laptop has a crack from a drop. At first, it wasn’t a problem, but in recent weeks, it has worsened, and sometimes the cursor goes wild and doesn’t respond to commands. So, I needed to disable the touchscreen as an input device.\n\nIn the Xorg desktop environment, you can use `xinput list` to display all input devices along with their corresponding ID numbers. Once you locate the device’s ID, you can disable it with `xinput disable ##`. Generally, the ID number is stable, so I directly added the disable command to `~/.bashrc`.\n\nHowever, I recently took out my long-neglected Raspberry Pi and, for fun, bought a compact 60% mechanical keyboard. After plugging in the keyboard and logging in with my password, guess what? The new keyboard stopped working, giving me a real scare.\n\nSo, now I need to check the input device IDs each time and pull out the IDs related to the touchscreen (there's more than one) from the `xinput list` output. I need to assign them to a variable and then input this variable into `xinput disable #`. This sequence of actions is beyond my Bash skills, so I considered using Python for the intermediate steps: that is, getting Python to read the Bash command results and write the Bash command statements.\n\nA Google search brought up this result: [https://stackoverflow.com/questions/4256107/running-bash-commands-in-python](https://stackoverflow.com/questions/4256107/running-bash-commands-in-python). After a quick look at the official `subprocess` documentation, I wrote the following snippet, saved it as `~/disable_touchscreen.py`, and added `python ~/disable_touchscreen.py` to my `~/.bashrc`.\n\n```python\nimport subprocess\ncheck = subprocess.run([\"xinput\",\"list\"],capture_output=True)\nfor line in check.stdout.decode(\"utf-8\").split(\"\\n\"):\n    if \"touchscreen\" in line:\n        device = line.partition(\"id=\")[2].partition(\"\\t\")[0]\n        disable = subprocess.run([\"xinput\",\"disable\",str(device)])\n        if disable.returncode == 0:\n            print(f\"Successfully disabled touchscreen device {device}\")\n        else:\n            print(f\"Failed to disable touchscreen device {device}\")\n```\n\n- The core of this code is `subprocess.run()`. The first parameter is the command passed to Bash, which is a list where each element corresponds to each part of the Bash command split by spaces. To get the command’s output, you need to add the `capture_output=True` parameter.\n- The return value of the function is a special data structure. If the command executes successfully, the result is in `.stdout`, which is a binary string `b'xxx...'`, so it needs to be converted to a string with `.decode(\"utf-8\")`.\n\nIf only using Bash:\n\n- My Bash skills can get as far as `xinput list | grep \"touchscreen\"`. Here, `|` is a pipe, which passes the output of the preceding command as input to the following command. To use a pipe in Python, you can refer to this question: https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes.\n- The result of the pipe still needs to be trimmed to get the ID, i.e., `line.partition(\"id=\")[2].partition(\"\\t\")[0]`. This would probably require `awk`, which is challenging but learnable, and at least I know what to learn.\n- But assigning the ID to a variable and then passing this variable into `xinput disable`—I don’t even know where to start with that.\n"},{"slug":"python-import-script-module-package","filename":"2021-12-11-python-import-script-module-package.md","date":"2021-12-11","title":".py | Import Existing Code","layout":"post","keywords":["md","py"],"excerpt":"Translated by ChatGPT.","content":"\nLet's explain this using the directory structure provided on the official website:\n\n```\nsound/ Top-level package \n    init.py Initialize the sound package \n    formats/ Subpackage for file format conversions \n        init.py \n        wavread.py \n        wavwrite.py \n        aiffread.py \n        aiffwrite.py \n        auread.py \n        auwrite.py \n        ... \n    effects/ Subpackage for sound effects \n        init.py \n        echo.py \n        surround.py \n        reverse.py \n        ... \n    filters/ Subpackage for filters \n        init.py \n        equalizer.py \n        vocoder.py \n        karaoke.py \n        ...\n```\n\n## Using Existing Python Code\n\nMost programming tutorials start teaching syntax after setting up the environment. But let’s first discuss using code that’s already been written. The simplest way to do this is by installing packages through a package manager:\n\n```bash\npip install sound\n```\n\nThen, if you want to use a function in a specific file (let's say `wavwrite.py` has a function called `write()`), there are multiple ways to import it. Note the different ways to import and call the function:\n\n```python\nimport sound\nsound.formats.wavwrite.write()\n\nfrom sound import formats\nformats.wavwrite.write() \n\nfrom sound.formats import wavwrite\nwavwrite.write()\n\nfrom sound.formats.wavwrite import write\nwrite()\n```\n\nHowever, not all Python code can be installed directly. For example, if a research paper is published along with data processing code, often the code is simply shared in a folder. If you download that folder and try `import sound`, an error will occur, stating that Python can't find a library named sound.\n\n## How Python Locates Code Files\n\nIf you think about it, it’s normal that an error occurs. The previous simple command `import sound` solved the problem magically—finding the library without needing a file path—even though libraries can be located in different parts of the file system.\n\nThis is because Python doesn’t search the entire hard drive. Instead, it uses a variable, typically named `PYTHONPATH`, which holds a list of directories where Python library folders are located. When you enter a command in the terminal, Python will:\n\n- Search the current folder, meaning the folder where you launched the Python command.\n- Look through each folder in the `PYTHONPATH` variable.\n- Finally, check the default location for packages installed by the package manager, typically `<path to python>/site-packages`.\n\nIf the library is found, Python will import it; otherwise, an error occurs.\n\nIn the error mentioned above, if we happen to be in the `sound` folder and run Python, the first condition applies, and `import sound` won’t produce an error. But this won’t work in other locations.\n\n## Terminology: Interactive, Script, Module, Package\n\nExecutable Python commands can be found in the following contexts, with the first being interactive and the last three being file-based:\n\n1. interactive: The Python **interactive interface**, also known as calculator mode, which appears after entering `python` in the command line. Commands entered here display results immediately. Once Python exits, these commands are lost.\n2. script: A Python **script** file, like `somefile.py` when running `python somefile.py` from the command line.\n    1. Python is lightweight, and some commands are worth saving for later reuse, much like Linux commands and bash scripts.\n    2. However, as a fully-featured language, Python can also support complex object-oriented programming. In this sense, the main script file can be considered the main module, serving as the main file and program entry point.\n3. module: A Python **module** file, which you can call with `python -m another` (without a `.py` extension). Technically, any `.py` file is a module, but it’s generally used for files whose variables and functions are meant for other Python files to import.\n4. package: A Python **package**, which is a higher-level structure of related modules (typically a folder with `__init__.py` inside). But packages and modules aren’t defined solely by folder hierarchy—more on that in the next section.\n\n## Script vs. Module\n\nPython offers both scripting flexibility and the robustness of more complex languages. Unlike some languages, you don’t need a main file called `main.py` with a `Main` class and a `main()` function. But Python still needs a starting point in a complex program.\n\nThis starting point is the `.py` file after `python` (without the `-m` parameter). Python sets the `__name__` attribute of this main file to `\"__main__\"`. This allows Python to treat it as the main script file, even if it's part of a larger library, with no knowledge of sibling or other related modules.\n\nOther modules are used by importing them in the main module (or script). The import command tells Python where to find the module’s code and the relationships between modules in the package hierarchy. Alternatively, the `-m` option provides this structure, e.g., `python -m sound.formats.wavwrite`, which allows `wavwrite.py` to execute and know its relative position in the hierarchy.\n\n## Absolute Import vs. Relative Import\n\nThe examples at the beginning use absolute imports (no leading `.`), whereas relative imports (`.` for current directory, `..` for parent directory) are for internal code that's almost never run as the main module.\n\nReturning to the file structure above, if `sound/effects/surround.py` needs functions from `sound/formats/wavwrite.py` and `sound/effects/echo.py`, you could write:\n\n```python\n# in sound/effects/surround.py\nfrom ..formats import wavwrite\nfrom . import echo\n```\n\n## Organizing Code for Reuse\n\nFinally, after years of coding, I’m drafting a paper, and now I need to organize previous analysis code into a project. Each time I tried to unify everything, import errors between modules were an issue. This post resulted from that experience.\n\nHere's a recommended project structure from [this article](https://gist.github.com/ericmjl/27e50331f24db3e8f957d1fe7bbbe510):\n\n```\n|- notebooks/\n   |- 01-first-logical-notebook.ipynb\n   |- 02-second-logical-notebook.ipynb\n   |- prototype-notebook.ipynb\n   |- archive/\n      |- no-longer-useful.ipynb\n|- projectname/\n   |- projectname/\n      |- __init__.py\n      |- config.py\n      |- data.py\n      |- utils.py\n   |- setup.py\n|- README.md\n|- data/\n   |- raw/\n   |- processed/\n   |- cleaned/\n|- scripts/\n   |- script1.py\n   |- script2.py\n   |- archive/\n      |- no-longer-useful.py\n|- environment.yml\n```\n\nThis structure allows you to convert tools into an installable library. Now, you can use `projectname` in notebooks and scripts just like `numpy` or `pandas`.\n\nTo use the code, install it with:\n\n```bash\ncd projectname\npip install -e .\n```\n\n## References\n\n- [What’s the difference between a Python module and a Python package?](https://stackoverflow.com/questions/7948494/whats-the-difference-between-a-python-module-and-a-python-package) All Python files are modules, while a package is a specific kind of module.\n- Official explanation of Python modules: https://docs.python.org/3/tutorial/modules.html\n- [StackOverflow: \"run as module\" is different from \"run as script\".](https://stackoverflow.com/questions/14132789/relative-imports-for-the-billionth-time) Running as a module sets the `__name__` attribute to the module’s name, while running as a script sets it to `__main__`.\n- A project organization tutorial: https://realpython.com/python-application-layouts/\n- Official documentation on packaging: https://packaging.python.org/en/latest/tutorials/packaging-projects/\n"},{"slug":"install-pytorch-cpu-on-fedora","filename":"2021-10-13-install-pytorch-cpu-on-fedora.md","date":"2021-10-13","title":".py | Installing the CPU Version of PyTorch on Fedora","layout":"post","keywords":["md","py","ai"],"excerpt":"Translated by ChatGPT.","content":"\nI'm about to attend a summer school on deep learning applications in microscopic image processing.\n\nDeep learning is a branch of machine learning, where most data can be represented as vectors (first-order tensors) and most algorithms can be broken down into operations or transformations on vectors, represented as matrices (second-order tensors). This need for efficient tensor computation led to libraries like PyTorch, TensorFlow, and others such as Keras, Caffe, and more. In earlier versions, PyTorch and TensorFlow differed significantly, but over time, they've merged in features and have edged out other competitors; they're starting to look increasingly similar. \"They've become what they once hated.\" lol\n\nI'm not sure which machine learning framework will be used in the course, so I've decided to install both PyTorch and TensorFlow (shrug). This is also a continuation of my previous [Python tutorial](python-interpreter-editor-virtualenv).\n\nHere’s my software and hardware setup: an Intel CPU with integrated graphics (can't run *Civilization VI*). Even though my system isn't officially supported on Linux, I’ve managed to get Fedora running smoothly after a few kernel updates. I'm using Python version 3.9.6, pip as my package manager, and VS Code as my editor.\n\n## Creating a Virtual Environment\n\nI explained why to create a virtual environment in the previous post, so let's jump right in. I created two virtual environments, naming them `torch` and `tf`. In the command line snippets, I've added a prompt `(env)[me@mycomputer]$` to show which environment I'm in—remove this prompt when copying the commands.\n\n```bash\n[me@mycomputer]$ mkvirtualenv torch\n(torch)[me@mycomputer]$\n```\n\n## Installation\n\nOn the PyTorch website, find the installation command for your setup: https://pytorch.org/get-started/locally/. In my case, I chose `Stable` > `Linux` > `Pip` > `Python` > `CPU`. Copy the generated command and paste it into the terminal:\n\n```bash\n(torch)[me@mycomputer]$ pip3 install torch==1.9.1+cpu torchvision==0.10.1+cpu torchaudio==0.9.1 -f https://download.pytorch.org/whl/torch_stable.html\n```\n\nWait for the installation messages to confirm success.\n\n## Verification and Deactivation\n\nVerify the installation using the [official guide](https://pytorch.org/get-started/locally/#linux-verification):\n\n```python\nimport torch\nx = torch.rand(5, 3)\nprint(x)\n\n# tensor([[0.3799, 0.4494, 0.4296],\n#       [0.5800, 0.0180, 0.3110],\n#       [0.9847, 0.0125, 0.2648],\n#       [0.0296, 0.3142, 0.9266],\n#       [0.3192, 0.9645, 0.5545]])\n```\n\nNext, deactivate the environment to prepare for installing TensorFlow:\n\n```bash\n(torch)[me@mycomputer]$ deactivate\n[me@mycomputer]$\n```\n\n## What About TensorFlow?\n\nInitially, I planned to cover both PyTorch and TensorFlow in this post, but TensorFlow proved a bit more challenging.\n\n### Direct Installation\n\nGo to the [TensorFlow website](https://www.tensorflow.org/install) and click the \"Install\" button in the top navigation. Then, on the left sidebar, find the package/pip section; the [installation command](https://www.tensorflow.org/install/pip#3.-install-the-tensorflow-pip-package) is just one line:\n\n```bash\npip install --upgrade tensorflow\n```\n\nHowever, this command didn’t work as expected. The installation completed without errors, but running a test produced numerous error messages.\n\nThe error log included `Could not load dynamic library 'libcudart.so.11.0'`, suggesting that this command installed the GPU version by mistake.\n\n### Installing the CPU Version\n\nI found the CPU version download link in the \"Package Location\" section of the page: `https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow_cpu-2.6.0-cp39-cp39-manylinux2010_x86_64.whl`. I deleted the virtual environment, created it again, and reinstalled TensorFlow:\n\n```bash\n(tf)[me@mycomputer]$ deactivate\n[me@mycomputer]$ rmvirtualenv tf\n[me@mycomputer]$ mkvirtualenv tf\n(tf)[me@mycomputer]$ pip install --upgrade pip\n(tf)[me@mycomputer]$ pip install https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow_cpu-2.6.0-cp39-cp39-manylinux2010_x86_64.whl\n```\n\nAfter testing with the official command, I still got warnings:\n\n```bash\n(tf) [shixing@yoga-laptop ~]$ python -c \"import tensorflow as tf;print(tf.reduce_sum(tf.random.normal([1000, 1000])))\"\n20XX-XX-XX XX:XX:XX.XXXXXX: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\ntf.Tensor(-1338.4773, shape=(), dtype=float32)\n```\n\nThis Stack Overflow answer mentions that to avoid this warning, TensorFlow needs to be compiled from source. The official guide to building from source provides more details, but this is quite a hassle, so I’ll cover it in another post (to be continued).\n"},{"slug":"python-interpreter-editor-virtualenv","filename":"2021-06-29-python-interpreter-editor-virtualenv.md","date":"2021-06-29","title":".py | Python's Interpreter, Editor, and Virtual Environment","layout":"post","keywords":["md","py"],"excerpt":"Really, what are Python's interpreter, editor, and virtual environment","content":"\n\nIn the previous post \"[Configuring Python Development Environment on Windows 10](python-installation-and-configuration)\", I did roughly three things:\n- First, I installed the Python interpreter.\n- Second, I installed VSCode on the computer.\n- Third, as we know, is the virtual environment, virtualenv.\n\nIf there's something else worth mentioning, it's to add a bit of \"what\" alongside the \"how\". To make the article flow better, I plan to rearrange the order: first, talk about the editor, then the interpreter, and finally, the virtual environment. Although the article is based on Python, these concepts apply to almost all general-purpose programming languages. Because I'm not from a computer science background, this article is just my study notes, so if there are any inaccuracies, feel free to point them out.\n\n## Editor\n\nFirst, let's do an experiment. Rename the Python file `hello.py` created in the previous tutorial, change the extension `.py` to `.txt`, then double-click to open the file. What happens? In the Windows system, the most ordinary Notepad window pops up, displaying Python statements in black text on a white background, unlike in VSCode where different statements have different colors, but the content is exactly the same.\n\nFurthermore, you can directly execute the content of a `.txt` file in the command line with the Python interpreter (`py -m hello.txt`), with the same effect as `.py`.\n\nThe `.py` extension doesn't do anything special; like a `.txt` file, its content is simply a string of characters readable by humans. Such files are called [text files](https://en.wikipedia.org/wiki/Text_file). An editor is a program that handles text files. Notepad is one type of editor, as is VSCode.\n\nSince Notepad can already write Python code, why bother installing VSCode? Indeed, some people really only use Notepad or other built-in editors of the operating system to write Python code (there's even a video on YouTube of someone writing code in Microsoft Word); then debug the program using the command line. However, VSCode is specifically developed for programmers, providing many features that default editors lack, such as syntax highlighting, which highlights functions, variables, and keywords in different colors.\n\n## Compiler / Interpreter\n\nIn addition to text files, the second type of file mentioned in this article is a [binary file](https://en.wikipedia.org/wiki/Binary_file).\n\nComputers cannot directly understand characters recognized by humans. At the lowest level, classic computers understand only 0s and 1s represented in different ways. Although all files are ultimately binary at the lowest level, the term \"binary file\" is generally used specifically to refer to files other than text files. Since image files, video files, etc., have their own names, the files referred to by this term are basically related to software programs, files that can be executed by computers.\n\nHumans recognize characters, computers recognize only 0s and 1s, so the most intuitive approach is to translate text files into binary files. This translation process is called [compilation](https://en.wikipedia.org/wiki/Compiler), and the software that can accomplish this is called a compiler. Once compilation is complete, the compiler exits, and to execute the program, the computer simply executes the compiled executable file.\n\nHowever, compilation has a problem: the entire software needs to be compiled into a complete executable with all source code text files written. As the scale of the software grows, the resources and time required for compilation increase; once a modification is made, the entire project needs to be recompiled. Many times, we only want to quickly know the effect of a command in a large project; compilation is not suitable for such scenarios.\n\nThus, the [interpreter](https://en.wikipedia.org/wiki/Interpreter_(computing)) emerged. This type of program is much more complex than a compiler. It runs whenever we execute a command in a programming language, allowing us to enter commands one by one, remembering the context of the code, and even remembering the results of our previous commands. The cost is that even for large projects, it needs to analyze and interpret line by line, and its computational resource overhead and speed are not as efficient as compilation.\n\nPython is a (official implementation) programming language that uses an interpreter. The `python-***.exe` file we download from the official website is the Python interpreter. This also means that Python programs tend to perform less well than programs written by C/C++ programmers of the same level. However, due to its suitability for trial and error with single-line execution, Python is quite popular in research fields.\n\nOf course, Python's characteristics are far more than just being an interpreted language. It is also:\n- [Scripting language](https://program-think.blogspot.com/2009/08/why-choose-python-1-script.html)\n- [Dynamic language](https://program-think.blogspot.com/2009/08/why-choose-python-2-dynamic.html)\n- [Object-oriented language](https://program-think.blogspot.com/2010/08/why-choose-python-3-oop.html)\n- [Functional programming language](https://program-think.blogspot.com/2010/08/why-choose-python-3-oop.html)\n- [...](https://program-think.blogspot.com/2010/08/why-choose-python-5-tools.html)\n\n## Virtual Environment\n\nOnce I asked my girlfriend what IDE she uses to write Python, and she proudly replied that her MacBook comes with Python, so she can run it directly from the command line... The problem wasn't that she didn't answer my question directly (actually, thinking about it, she did answer part of the question), but rather that running the system's built-in Python interpreter or other programming language interpreters or compilers directly from the command line is a dangerous practice common among beginner programmers.\n\nFortunately, Windows is fine; after all, it's an operating system aimed at the general consumer, so it doesn't come with Python pre-installed. However, for more geek-oriented operating systems like Linux and the BSD family, things are different. These operating systems (or their distributions) often come pre-installed with Python. This Python isn't intended for users to develop their own programs but rather for the many system tools written in Python to call upon. Since the version of Python is usually controlled by the package manager of the distribution, it often lags behind the latest Python version for some time to avoid bugs in the new version and to give developers of system tools time to update their code. So, if you use this version of Python for development and accidentally upgrade Python, it's likely to cause some system functionality to malfunction.\n\nA virtual environment is Python's solution to this problem. We can install a version of Python different from the system's default version but not add this interpreter to the system path, so the operating system is unaware of the existence of this version of Python. When creating a virtual environment, we specify the use of this specific version of Python. So, after activating the virtual environment, it becomes the Python we need for development, and exiting the virtual environment returns to the Python used by system tools.\n\nMoreover, even if two projects use the same version of Python and both use the system's default version, virtual environments still have a place. Most programs require dependency onlibrary code written by others, called libraries. Different projects may depend on different library code, or different versions of the same library. In this case, you can create separate virtual environments and install the libraries corresponding to each project. Projects can be isolated from each other.\n\n## Editor + Interpreter / Compiler + Virtual Environment Management + ... = IDE\n\nIt's too cumbersome to install so many different programs for Python development. Can't it be done with just one click? Of course it can. A program that integrates various tools used in the development process is called an [integrated development environment (IDE)](https://en.wikipedia.org/wiki/Integrated_development_environment). For Python, the most famous IDE is undoubtedly [Anaconda](https://www.anaconda.com/).\n\nThen why don't I use it? Of course, I've used it before, but after hearing about the fame of VSCode and trying it out, I don't want to go back. Writing Python requires editing `.py` files, writing blog posts requires editing `.md` files, and some blog features require JavaScript. Essentially, all these tasks involve editing text files. In an editor like VSCode, everything is done together. So, programs like Spyder and Jupyter Lab in Anaconda seem redundant.\n\n\"Doing one thing well\" is also part of the [Unix philosophy](https://en.wikipedia.org/wiki/Unix_philosophy). But the problem is that different people have different definitions of \"one thing\". Some people think making breakfast is one thing, while others think it involves several things like heating milk, frying eggs, and toasting bread. Who is right?\n\nPerhaps both are right, but Editor + Interpreter + ... is upstream on the chain of contempt compared to IDE. You may disagree with this, but you should know it; otherwise, when others show off, you might feel embarrassed for not being prepared.\n"}]]]},"__N_SSG":true}