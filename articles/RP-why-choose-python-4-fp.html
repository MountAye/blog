<!DOCTYPE html><html><head><title>.py | 转载：为什么俺推荐 Python[4]·作为函数式编程语言的 Python | 阿掖山·博客</title><meta property="og:title" content=".py | 转载：为什么俺推荐 Python[4]·作为函数式编程语言的 Python | 阿掖山·博客"/><meta name="twitter:title" content=".py | 转载：为什么俺推荐 Python[4]·作为函数式编程语言的 Python | 阿掖山·博客"/><meta name="description" content="聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。"/><meta property="og:description" content="聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。"/><meta name="twitter:description" content="聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。"/><meta property="og:image" content="https://mountaye.github.io/blog/assets/img/before_h2.png"/><meta name="twitter:image" content="https://mountaye.github.io/blog/assets/img/before_h2.png"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/><meta name="generator" content="Next.js v14.2.6"/><link rel="canonical" href="https://mountaye.github.io/blog/articles/RP-why-choose-python-4-fp"/><link rel="icon" href="/blog/favicon.ico" type="image/x-icon"/><meta property="og:locale" content="zh-CN"/><meta property="og:url" content="https://mountaye.github.io/blog/articles/RP-why-choose-python-4-fp"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="18"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css"/><link rel="preload" href="/blog/_next/static/css/199b2c80616090b1.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/199b2c80616090b1.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/a95e7284258f3909.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/a95e7284258f3909.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/blog/_next/static/chunks/webpack-79757a214e82a958.js" defer=""></script><script src="/blog/_next/static/chunks/framework-ecc4130bc7a58a64.js" defer=""></script><script src="/blog/_next/static/chunks/main-7c5f4f22418d3757.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-e21aa0f8ad1821c4.js" defer=""></script><script src="/blog/_next/static/chunks/898-92d4a0dfd9341165.js" defer=""></script><script src="/blog/_next/static/chunks/380-0aefe1b9275aea5d.js" defer=""></script><script src="/blog/_next/static/chunks/928-6ba20451960ba562.js" defer=""></script><script src="/blog/_next/static/chunks/pages/articles/%5Bid%5D-d481ee0e3bc3006f.js" defer=""></script><script src="/blog/_next/static/buildID/_buildManifest.js" defer=""></script><script src="/blog/_next/static/buildID/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="responsive_all__53fOT"><div class="responsive_top__Qhpaa shadow-lg dark:shadow-gray-700"><a class="whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 text-primary underline-offset-4 hover:underline h-10 py-2 w-max px-2 flex flex-row justify-end items-center grow-0 shrink-0" href="/blog"><span class="relative flex shrink-0 overflow-hidden rounded-full h-9 w-9 sm:h-12 sm:w-12"><span class="flex h-full w-full items-center justify-center rounded-full bg-muted">Aye</span></span><div id="site title" class="pl-2 hidden sm:block"><span class="text-2xl font-serif">阿掖山</span> <span class="text-base font-sans hidden lg:inline">博客</span></div></a><div class=" grow-0 shrink flex w-[25%]"><input type="text" class="flex h-10 w-full rounded-md border border-input px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 rounded-r-none bg-inherit dark:border-gray-700" id="search-input" placeholder="Search"/><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 border border-input hover:bg-accent hover:text-accent-foreground h-10 w-10 rounded-none border-x-0 bg-inherit dark:border-gray-700" type="button" id="radix-:Rad6:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><span class="relative flex shrink-0 overflow-hidden h-5 w-5 rounded-none"><span class="flex h-full w-full items-center justify-center rounded-full bg-muted">Aye</span></span></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 border border-input hover:bg-accent hover:text-accent-foreground h-10 w-10 rounded-l-none bg-inherit dark:border-gray-700"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-4 w-4"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></button></div><div class="flex flex-row"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 md:hidden px-1 md:px-2 lg:px-3" type="button" id="radix-:Rnd6:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layers"><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"></path><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"></path><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down w-5 h-5"><path d="m6 9 6 6 6-6"></path></svg></button><div class="hidden md:block "><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1 md:px-2 lg:px-3" href="/blog/history"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-history"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path><path d="M12 7v5l4 2"></path></svg></a><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1 md:px-2 lg:px-3" href="/blog/topics"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tags"><path d="m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19"></path><path d="M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z"></path><circle cx="6.5" cy="9.5" r=".5" fill="currentColor"></circle></svg></a><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1 md:px-2 lg:px-3" href="/blog/discuss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-messages-square"><path d="M14 9a2 2 0 0 1-2 2H6l-4 4V4c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2z"></path><path d="M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1"></path></svg></a></div><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1 md:px-2 lg:px-3" type="button" id="radix-:Rbd6:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-languages w-5 h-5"><path d="m5 8 6 6"></path><path d="m4 14 6-6 2-3"></path><path d="M2 5h12"></path><path d="M7 2h1"></path><path d="m22 22-5-10-5 10"></path><path d="M14 18h6"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down w-4 h-4"><path d="m6 9 6 6 6-6"></path></svg></button><div class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1 md:px-2 lg:px-3 flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><button type="button" role="switch" aria-checked="false" data-state="unchecked" value="off" class="peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input" id="night-mode"><span data-state="unchecked" class="pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0 dark:bg-slate-500"></span></button><input type="checkbox" aria-hidden="true" style="transform:translateX(-100%);position:absolute;pointer-events:none;opacity:0;margin:0" tabindex="-1" value="off"/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70" for="night-mode"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></div></div></div><div class="responsive_main__BcQ7m"><aside class="responsive_side__jszNy shadow-2xl dark:shadow-gray-700"><div class="py-20 px-1 overflow-x-auto text-wrap text-base font-serif dark:font-sans utils_right2left__q5Pl7 utils_verticalLines__s6Q8n"><p id="quote-line">智力活动是一种生活态度</p><p>——<span id="quote-author">阿掖山，一个博客</span></p></div><footer class="pt-2 grow-0 shrink-0 flex flex-col items-center"><div class="flex flex-row"><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1" href="/blog/feed.xml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rss stroke-[#3c70c6]"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1" href="https://www.github.com/MountAye"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github stroke-[#3c70c6]"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1" href="https://www.twitter.com/MountAye"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-twitter stroke-[#3c70c6]"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path></svg></a><a class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 hover:bg-accent hover:text-accent-foreground h-10 py-2 px-1" href="https://github.com/MountAye/comments/discussions/categories/blog"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail stroke-[#3c70c6]"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg></a></div><div class="text-sm"><p>阿掖山<!-- --> © <!-- -->2024<br/>作者保留版权</p></div></footer></aside><div class="responsive_field__loO20"><div class="rounded-lg bg-card text-card-foreground responsive_doc__3scNK shadow-2xl relative top-5 border-0 dark:shadow-gray-700"><div class="rounded-lg bg-card text-card-foreground w-full h-full border-0 shadow-lg dark:shadow-gray-700" id="top" style="background-size:cover"><div class="p-6 pt-0 backdrop-blur-sm bg-gray-50/70 dark:bg-black/70"><div data-orientation="vertical"><div data-state="closed" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="closed" class="flex"><button type="button" aria-controls="radix-:R4ml6:" aria-expanded="false" data-state="closed" data-orientation="vertical" id="radix-:Rml6:" class="flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180" data-radix-collection-item=""><div style="position:relative;width:100%;padding-bottom:25%" data-radix-aspect-ratio-wrapper=""><div class="h-full flex flex-col justify-end items-start" style="position:absolute;top:0;right:0;bottom:0;left:0"><p id="date">2019 年 1 月 6 日</p><h1 id="title" class="text-start text-lg sm:text-2xl md:text-4xl text-[#3c70c6] font-semibold font-serif dark:font-sans">.py | 转载：为什么俺推荐 Python[4]·作为函数式编程语言的 Python</h1><div id="tags" class="mt-1"><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-primary hover:bg-primary/80 text-white dark:text-slate-400 text-sm mr-1 font-mono"><a alt="转载和二次创作" href="/blog/topics#html">html</a></div><div class="inline-flex items-center rounded-full border px-2.5 py-0.5 font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-primary hover:bg-primary/80 text-white dark:text-slate-400 text-sm mr-1 font-mono"><a alt="Python学习笔记" href="/blog/topics#py">py</a></div></div></div></div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="closed" id="radix-:R4ml6:" hidden="" role="region" aria-labelledby="radix-:Rml6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"></div></div></div></div></div><div class="hidden xl:block absolute -left-48 top-0 h-full"><div class="rounded-lg bg-card text-card-foreground sticky top-5 w-48 border-0 shadow-xl"><div class="p-6 py-4 pl-4 pr-0 text-nowrap overflow-clip text-ellipsis font-serif dark:font-sans"><div data-orientation="vertical"><div data-state="open" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="open" class="flex"><button type="button" aria-controls="radix-:R56l6:" aria-expanded="true" data-state="open" data-orientation="vertical" id="radix-:R16l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""><a href="#">目录</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="open" id="radix-:R56l6:" role="region" aria-labelledby="radix-:R16l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"><div class="pt-0 pl-4 pb-0"><ul><li><div data-orientation="vertical"><div data-state="open" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="open" class="flex"><button type="button" aria-controls="radix-:R13d6l6:" aria-expanded="true" data-state="open" data-orientation="vertical" id="radix-:R3d6l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="open" id="radix-:R13d6l6:" role="region" aria-labelledby="radix-:R3d6l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"><div class="pt-0 pl-4 pb-0"><ul><li><div data-orientation="vertical"><div data-state="open" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="open" class="flex"><button type="button" aria-controls="radix-:R1r3d6l6:" aria-expanded="true" data-state="open" data-orientation="vertical" id="radix-:Rr3d6l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="open" id="radix-:R1r3d6l6:" role="region" aria-labelledby="radix-:Rr3d6l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"><div class="pt-0 pl-4 pb-0"><ul><li><a href="#%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95">文章目录</a></li></ul></div></div></div></div></li></ul></div></div></div></div></li><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B">什么是函数式编程</a></li><li><div data-orientation="vertical"><div data-state="closed" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="closed" class="flex"><button type="button" aria-controls="radix-:R17d6l6:" aria-expanded="false" data-state="closed" data-orientation="vertical" id="radix-:R7d6l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""><a href="#fp%E7%9A%84%E7%89%B9%E7%82%B9">FP的特点</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="closed" id="radix-:R17d6l6:" hidden="" role="region" aria-labelledby="radix-:R7d6l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"></div></div></div></li><li><div data-orientation="vertical"><div data-state="closed" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="closed" class="flex"><button type="button" aria-controls="radix-:R19d6l6:" aria-expanded="false" data-state="closed" data-orientation="vertical" id="radix-:R9d6l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""><a href="#fp-%E7%9A%84%E4%BC%98%E7%82%B9">FP 的优点</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="closed" id="radix-:R19d6l6:" hidden="" role="region" aria-labelledby="radix-:R9d6l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"></div></div></div></li><li><div data-orientation="vertical"><div data-state="closed" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="closed" class="flex"><button type="button" aria-controls="radix-:R1bd6l6:" aria-expanded="false" data-state="closed" data-orientation="vertical" id="radix-:Rbd6l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""><a href="#python-%E7%9A%84%E5%87%BD%E6%95%B0%E8%AF%AD%E6%B3%95">Python 的函数语法</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="closed" id="radix-:R1bd6l6:" hidden="" role="region" aria-labelledby="radix-:Rbd6l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"></div></div></div></li><li><div data-orientation="vertical"><div data-state="closed" data-orientation="vertical" class="border-b border-none"><h3 data-orientation="vertical" data-state="closed" class="flex"><button type="button" aria-controls="radix-:R1dd6l6:" aria-expanded="false" data-state="closed" data-orientation="vertical" id="radix-:Rdd6l6:" class="flex flex-1 items-center justify-between font-medium transition-all hover:underline [&amp;[data-state=open]&gt;svg]:rotate-180 py-0" data-radix-collection-item=""><a href="#%E5%92%8C-fp-%E7%9B%B8%E5%85%B3%E7%9A%84%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0">和 FP 相关的内置函数</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4 shrink-0 transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg></button></h3><div data-state="closed" id="radix-:R1dd6l6:" hidden="" role="region" aria-labelledby="radix-:Rdd6l6:" data-orientation="vertical" class="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down" style="--radix-accordion-content-height:var(--radix-collapsible-content-height);--radix-accordion-content-width:var(--radix-collapsible-content-width)"></div></div></div></li><li><a href="#%E6%B6%88%E9%99%A4%E6%8E%A7%E5%88%B6%E6%B5%81">消除控制流</a></li><li><a href="#list-comprehension">List Comprehension</a></li><li><a href="#%E9%97%AD%E5%8C%85">闭包</a></li><li><a href="#%E7%BB%93%E5%B0%BE">结尾</a></li></ul></div></div></div></div></div></div></div><div class="p-6 typeset_written___p4iY pt-10 pb-20"><h3 id="文章目录"><a href="#文章目录">文章目录</a></h3>
<ul>
<li>什么是函数式编程</li>
<li>FP 的特点</li>
<li>FP 的优点</li>
<li>Python 的函数语法</li>
<li>和 FP 相关的内置函数</li>
<li>消除控制流</li>
<li>List Comprehension</li>
<li>闭包</li>
<li>结尾</li>
</ul>
<p>春节前看到热心读者留言，提醒俺：Python 系列好久没更新了（不知不觉又过了一年多）。俺当时回复说：春节假期补上后一篇。昨天听到鞭炮声才发觉元宵已经到了，赶忙写出本文。</p>
<p>前一个帖子介绍了 Python 作为“面向对象编程”（以下简称 OOP）语言的特点，今天来聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。</p>
<h1 id="什么是函数式编程"><a href="#什么是函数式编程">什么是函数式编程</a></h1>
<p>说实话，“函数式编程语言”是一个很大的话题。由于篇幅有限，本文不可能对这个话题做全面介绍。俺干脆偷一下懒，只简单说说。</p>
<p>从字面上看，所谓的函数式编程，就是以“函数”为中心的“编程范式”。估计有同学又会问了，啥是“编程范式”捏？哎呦，这又是一个很大的话题。通俗来讲，“编程范式”就是指编程的套路。比方说大家很熟悉的 OOP，就是一种“编程范式”。FP 跟 OOP 一样，都是一种编程的套路。做个简单类比：OOP 以“对象/类”作为程序设计的核心，而 FP 以“函数”作为程序设计的核心。</p>
<h1 id="fp的特点"><a href="#fp的特点">FP的特点</a></h1>
<p>既然说到 FP，自然要稍微说一下 FP 的特色。</p>
<h2 id="函数很牛x"><a href="#函数很牛x">函数很牛X</a></h2>
<p>刚才说了，FP 是以函数为中心。既然如此，在支持 FP 的语言中，函数的功能自然十分牛X。通俗地说，OOP 语言中，类/对象能干的事情，FP 语言中的函数也能干。下面做一些对比，以加深大伙儿的印象。</p>
<p>OOP 中，对象可以互相赋值；FP 中，函数可以互相赋值。</p>
<p>OOP 中，对象可以作为函数的参数/返回值，FP 中，函数可以作为函数的参数/返回值。</p>
<p>某些 OOP 中，类可以嵌套定义；FP 中，函数可以嵌套定义。</p>
<p>某些 OOP 中，可以有匿名类；FP 中，可以有匿名函数。</p>
<h2 id="避免副作用"><a href="#避免副作用">避免副作用</a></h2>
<p>在 FP 中，特别强调函数不要有“副作用”（洋文叫“side effect”）。没有副作用的函数，又称之为纯函数（pure function）。其输出完全依赖于输入。换句话说，只要输入一样，输出就一样。</p>
<p>要成为纯函数，函数内部不能读写函数外部变量、不能有设备 I/O（比如读写文件）......</p>
<p>无副作用是 FP 的重要特性。FP的很多优点来自于此特性。</p>
<h2 id="避免控制流"><a href="#避免控制流">避免控制流</a></h2>
<p>在 FP 中，尽量避免用控制流语句（循环语句、判断语句）。对于控制流语句，FP 有另外的替代方式。比如：常用递归或高阶函数来替代循环。如此一来，FP 的代码会显得更简洁，更可读。</p>
<h2 id="多态"><a href="#多态">多态</a></h2>
<p>大部分支持 FP 的语言，也都支持多态。函数参数支持多态化，便可实现非常灵活的功能。</p>
<p>说了这么多，不知道大伙儿明白了没？还是没整明白的同学，请看维基百科的英文词条（中文词条太简单，看不明白滴）。</p>
<p>洋文实在看不下去吗？那不妨看看 IT 大牛 Joel 写的《你的编程语言能这样做吗？》（中文版在“这里”）。此文以 JavaScript 来阐述 FP 的妙处。</p>
<h1 id="fp-的优点"><a href="#fp-的优点">FP 的优点</a></h1>
<p>再稍微说一下 FP 的好处，以强化大伙儿学习的动力。</p>
<h2 id="模块化"><a href="#模块化">模块化</a></h2>
<p>在 FP 的思想中，函数最好是“纯”的，而且最好只完成“单一”的任务。在这种指导思想下，函数的模块化程度自然就高。</p>
<h2 id="可复用性"><a href="#可复用性">可复用性</a></h2>
<p>模块化程度高，直接的好处就是可复用性好。</p>
<h2 id="可读性"><a href="#可读性">可读性</a></h2>
<p>刚才说了，FP 的思想强调函数又纯又小。这样的函数，代码的可读性自然好，修改起来也方便。</p>
<h2 id="易于调试"><a href="#易于调试">易于调试</a></h2>
<p>前面提到了纯函数。如果你的程序中大部分函数都是纯函数，则调试 Bug 会容易很多。像 OOP 中，类的多个成员函数都可以修改类的成员变量，有时候会导致调试极其困难。而纯函数没有此问题。</p>
<p>另外，多线程是调试的一大噩梦。当年俺还专门写过帖子，介绍 C++ 多线程的注意事项（在“这里”）。而纯函数由于没有副作用，不必担心各种“互斥”、“死锁”等问题。</p>
<h2 id="易于测试"><a href="#易于测试">易于测试</a></h2>
<p>除了易于调试，纯函数的输出仅仅依赖于输入，这一特点注定了它很容易进行单元测试。</p>
<h2 id="适合并行"><a href="#适合并行">适合并行</a></h2>
<p>在 FP 中，由于纯函数无副作用，很适合编写并行处理的代码。最典型并且在工业界获得巨大成功的例子就是 Erlang。</p>
<h2 id="其它"><a href="#其它">其它</a></h2>
<p>当然啦，FP 的好处远不止上述这些（比如还有：利于形式化证明）。限于篇幅，俺就不展开了。</p>
<h1 id="python-的函数语法"><a href="#python-的函数语法">Python 的函数语法</a></h1>
<p>Python 中，常见的函数定义和函数调用，想必各位都晓得了。下面说几种不太常见的，且跟 FP 有关的语法。</p>
<h2 id="函数赋值"><a href="#函数赋值">函数赋值</a></h2>
<p>Python 可以把函数直接赋值给一个变量。举例如下：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> square</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(n) :  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 这是一个计算平方的小函数，后面会反复用它举例</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> n </span><span style="color:#D73A49;--shiki-dark:#F97583">**</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">f </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> square  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 此处赋值给变量 f</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">f(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">10</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 此处返回100。注意：对该变量使用小括号，等同于调用函数</span></span>
<span class="line"></span></code></pre>
<h2 id="匿名定义"><a href="#匿名定义">匿名定义</a></h2>
<p>Python 可以用 lambda 关键字定义【单行】的匿名函数。套用刚才的例子</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">square </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> lambda</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x : x</span><span style="color:#D73A49;--shiki-dark:#F97583">**</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#6A737D;--shiki-dark:#6A737D">  # 定义一个单参数的匿名函数，并把该函数赋值给变量</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">square(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">10</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 此处返回 100</span></span>
<span class="line"></span></code></pre>
<h2 id="嵌套定义"><a href="#嵌套定义">嵌套定义</a></h2>
<p>Python 支持函数的嵌套定义（请看如下例子）。这种语法，在“闭包”中经常出现（后面会具体介绍“闭包”）。</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> outer</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() :  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 外层函数</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    s </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &quot;hello&quot;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> inner</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() :  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 内层函数</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s)  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 此处引用的是外层作用域的变量</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    inner()  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 输出 hello</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    s </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &quot;world&quot;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    inner()  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 输出 world</span></span>
<span class="line"></span></code></pre>
<h1 id="和-fp-相关的内置函数"><a href="#和-fp-相关的内置函数">和 FP 相关的内置函数</a></h1>
<p>Python 内置了一大坨用于 FP 的函数，以方便程序猿写出简洁的代码。在接下去聊之前，俺有必要先介绍其中的2个。</p>
<h2 id="mapfunc-iter"><a href="#mapfunc-iter">map(func, iter)</a></h2>
<p>为了省事，俺只介绍2参数的 map（正宗的 map 支持 N 参数）。</p>
<p>参数 func 是个函数，参数 iter 是个迭代器（也可以理解为集合）</p>
<p>map() 会把 iter 的每个元素传给 func，并把每次调用的结果保存到一个 list 中，然后返回此 list。</p>
<p>举例：</p>
<p>挨个计算整数 list 的平方：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">map</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(square, [</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">])  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 返回 [1, 4, 9]</span></span>
<span class="line"></span></code></pre>
<h2 id="filterfunc-iter"><a href="#filterfunc-iter">filter(func, iter)</a></h2>
<p>参数含义同 map</p>
<p>filter() 会把 iter 的每个元素传给 func，如果 func 返回结果为 True，就把元素保存在一个 list 中，最后返回此 list。</p>
<p>举例：</p>
<p>要过滤出所有奇数，代码如下：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> odd</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(n) :</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (n</span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">==</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">filter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(odd, [</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">])  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 返回[1, 3]</span></span>
<span class="line"></span></code></pre>
<p>此处可以用上 lambda，把代码简化为一行：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">filter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">lambda</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> n: (n</span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span><span style="color:#D73A49;--shiki-dark:#F97583">==</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, lst)</span></span></code></pre>
<h1 id="消除控制流"><a href="#消除控制流">消除控制流</a></h1>
<p>为了让大伙儿更深刻体会 FP 风格同传统风格的差别，俺把刚才两个例子组合一下——要求返回整数list 中所有奇数的平方。</p>
<p>传统的写法（有控制流）：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> func1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(old_lst) :</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    new_lst </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> n </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> old_lst :</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> odd(n) :</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            new_lst.append(square(n))</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> new_lst</span></span>
<span class="line"></span></code></pre>
<p>FP 的写法（无控制流）：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> func2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(lst) :</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> map</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(square, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">filter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(odd, lst))</span></span>
<span class="line"></span></code></pre>
<p>怎么样？是不是更简洁？连 for / if 这两个关键字都不需要了。</p>
<h1 id="list-comprehension"><a href="#list-comprehension">List Comprehension</a></h1>
<p>这个洋文比较难翻译。有人叫做“列表推导”，也有人称为“列表展开”或“列表解析”。（俺比较喜欢头一个翻译——不禁让人联想到“推倒”:）</p>
<p>在 Python 中，这是一个很好吃的语法糖——可以让你写出很简洁、很优雅的代码。</p>
<p>举例1：</p>
<p>还拿刚才过滤奇数的例子。</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">filter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">lambda</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> n: (n</span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span><span style="color:#D73A49;--shiki-dark:#F97583">==</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, lst)</span></span>
<span class="line"></span></code></pre>
<p>上述写法可以等价替换为列表推导：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">[n </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> n </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> lst </span><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (n</span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span><span style="color:#D73A49;--shiki-dark:#F97583">==</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span></code></pre>
<p>举例2：
　　
再来一个稍微复杂的例子。假设有两个整数 list，分别存储矩形的宽度和高度。现在想把所有的宽度和高度进行两两组合，把大于 10 的面积打印出来。
　　
传统的写法（2层循环，4行代码）</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> w </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> width :</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> h </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> height :</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> w</span><span style="color:#D73A49;--shiki-dark:#F97583">*</span><span style="color:#24292E;--shiki-dark:#E1E4E8">h </span><span style="color:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> :</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">            print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(w</span><span style="color:#D73A49;--shiki-dark:#F97583">*</span><span style="color:#24292E;--shiki-dark:#E1E4E8">h)</span></span>
<span class="line"></span></code></pre>
<p>FP 的写法（无循环，1行代码，多精致啊）</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">( [w</span><span style="color:#D73A49;--shiki-dark:#F97583">*</span><span style="color:#24292E;--shiki-dark:#E1E4E8">h </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> w </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> width </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> h </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> height </span><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> w</span><span style="color:#D73A49;--shiki-dark:#F97583">*</span><span style="color:#24292E;--shiki-dark:#E1E4E8">h </span><span style="color:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="color:#24292E;--shiki-dark:#E1E4E8">] )</span></span>
<span class="line"></span></code></pre>
<p>除了列表推导，Python 中还有字典推导、集合推导等等。为了省点口水，暂且打住。</p>
<h1 id="闭包"><a href="#闭包">闭包</a></h1>
<p>闭包，洋文叫“closure”，解释在“这里”。它是 FP 的常见手法。那闭包到底有啥用捏？俺举一个微积分中，函数求导的例子。（不懂微积分或者对高数有心理阴影的同学，别担心，请把注意力集中在代码上）</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> d</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(f) :</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> calc</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(x) :</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        dx </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0.000001</span><span style="color:#6A737D;--shiki-dark:#6A737D">  # 表示无穷小的Δx</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (f(x</span><span style="color:#D73A49;--shiki-dark:#F97583">+</span><span style="color:#24292E;--shiki-dark:#E1E4E8">dx) </span><span style="color:#D73A49;--shiki-dark:#F97583">-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> f(x)) </span><span style="color:#D73A49;--shiki-dark:#F97583">/</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> dx  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 计算斜率。注意，此处引用了外层作用域的变量 f</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> calc  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 此处用函数作为返回值（也就是函数 f 的导数）</span></span>
<span class="line"></span></code></pre>
<p>现在，假设要计算二次函数 f(x) = x2 + x + 1 的导数，只需如下代码：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">f </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> lambda</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x : x</span><span style="color:#D73A49;--shiki-dark:#F97583">**</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x </span><span style="color:#D73A49;--shiki-dark:#F97583">+</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="color:#6A737D;--shiki-dark:#6A737D">  # 先把二次函数用代码表达出来</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">f1 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> d(f)  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># 这个f1 就是 f 的一阶导数啦。注意，导数依然是个函数</span></span>
<span class="line"></span></code></pre>
<p>有了一阶导数，就可以很容易地计算该函数在某点的斜率</p>
<p>比如要计算 x=3 的斜率，只需：</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">f1(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span></code></pre>
<p>如果要想得到二阶导数（导数的导数），只需依样画葫芦（瞧这代码写得多优雅）</p>
<pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">f2 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> d(f1)</span></span>
<span class="line"></span></code></pre>
<p>看到这里，大伙儿不妨设想一下：如果不用 FP，改用 OOP，上述需求该如何实现？俺觉得吧，用 OOP 来求导，这代码写起来多半是又丑又臭。</p>
<h1 id="结尾"><a href="#结尾">结尾</a></h1>
<p>今天聊了不少 FP 的语法特性，可惜还是没聊完。由于俺比较懒，而且怕写得太长没人看，所以一些高级话题（比如：迭代器、生成器、等），今天就不介绍了。假如列位看官对那些玩意儿感兴趣，再抽空单独写一帖。</p>
<p><a href="RP-why-choose-python-0-overview">回到本系列的目录</a></p>
<blockquote>
<p><strong>版权声明</strong>
本博客（编程随想的博客）所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者编程随想和本文原始地址：<!-- -->
<a href="https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html">https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html</a></p>
</blockquote></div><div class="absolute right-4 lg:-right-20 top-0 h-full"><div class="sticky top-[calc(100vh-140px)] lg:top-[calc(100vh-320px)] flex flex-row-reverse lg:flex-col"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 text-primary-foreground hover:bg-primary/90 bg-[#3c70c6] h-fit w-fit px-2 py-2 m-2 rounded-full opacity-40 lg:opacity-100 hover:opacity-100" title="顶部" href="/blog/articles/RP-why-choose-python-4-fp#top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-big-up stroke-white dark:stroke-slate-400"><path d="M9 18v-6H5l7-7 7 7h-4v6H9z"></path></svg></a><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 text-primary-foreground hover:bg-primary/90 bg-[#3c70c6] h-fit w-fit px-2 py-2 m-2 rounded-full opacity-40 lg:opacity-100 hover:opacity-100" title="评论" href="/blog/articles/RP-why-choose-python-4-fp#comments"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle-more stroke-white dark:stroke-slate-400"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path><path d="M8 12h.01"></path><path d="M12 12h.01"></path><path d="M16 12h.01"></path></svg></a><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 text-primary-foreground hover:bg-primary/90 bg-[#3c70c6] h-fit w-fit px-2 py-2 m-2 rounded-full opacity-40 lg:opacity-100 hover:opacity-100" title="分享"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share2 stroke-white dark:stroke-slate-400"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"></line><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"></line></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:text-slate-400 text-primary-foreground hover:bg-primary/90 bg-[#3c70c6] h-fit w-fit px-2 py-2 m-2 rounded-full opacity-40 lg:opacity-100 hover:opacity-100" title="恰饭"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hand-heart stroke-white dark:stroke-slate-400"><path d="M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16"></path><path d="m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9"></path><path d="m2 15 6 6"></path><path d="M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z"></path></svg></button></div></div></div><div class="rounded-lg bg-card text-card-foreground responsive_doc__3scNK relative top-20 pb-40 shadow-2xl border-0 dark:shadow-gray-700" id="comments"><div class="p-6 pt-0"><div id="giscus" class="pt-16 utils_giscus__lppxx"></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{"slug":"RP-why-choose-python-4-fp","date":"2019-02-07","title":".py | 转载：为什么俺推荐 Python[4]·作为函数式编程语言的 Python","filename":"2019-02-07-RP-why-choose-python-4-fp.md","url":"RP-why-choose-python-4-fp","layout":"post","author":"编程随想","keywords":["html","py"],"excerpt":"聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。","categories":"post","milestoneID":2,"content":"\n### 文章目录\n\n* 什么是函数式编程\n* FP 的特点\n* FP 的优点\n* Python 的函数语法\n* 和 FP 相关的内置函数\n* 消除控制流\n* List Comprehension\n* 闭包\n* 结尾\n\n春节前看到热心读者留言，提醒俺：Python 系列好久没更新了（不知不觉又过了一年多）。俺当时回复说：春节假期补上后一篇。昨天听到鞭炮声才发觉元宵已经到了，赶忙写出本文。\n\n前一个帖子介绍了 Python 作为“面向对象编程”（以下简称 OOP）语言的特点，今天来聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。\n\n# 什么是函数式编程\n\n说实话，“函数式编程语言”是一个很大的话题。由于篇幅有限，本文不可能对这个话题做全面介绍。俺干脆偷一下懒，只简单说说。\n\n从字面上看，所谓的函数式编程，就是以“函数”为中心的“编程范式”。估计有同学又会问了，啥是“编程范式”捏？哎呦，这又是一个很大的话题。通俗来讲，“编程范式”就是指编程的套路。比方说大家很熟悉的 OOP，就是一种“编程范式”。FP 跟 OOP 一样，都是一种编程的套路。做个简单类比：OOP 以“对象/类”作为程序设计的核心，而 FP 以“函数”作为程序设计的核心。\n\n# FP的特点\n\n既然说到 FP，自然要稍微说一下 FP 的特色。\n\n## 函数很牛X\n\n刚才说了，FP 是以函数为中心。既然如此，在支持 FP 的语言中，函数的功能自然十分牛X。通俗地说，OOP 语言中，类/对象能干的事情，FP 语言中的函数也能干。下面做一些对比，以加深大伙儿的印象。\n\nOOP 中，对象可以互相赋值；FP 中，函数可以互相赋值。\n\nOOP 中，对象可以作为函数的参数/返回值，FP 中，函数可以作为函数的参数/返回值。\n\n某些 OOP 中，类可以嵌套定义；FP 中，函数可以嵌套定义。\n\n某些 OOP 中，可以有匿名类；FP 中，可以有匿名函数。\n\n## 避免副作用\n\n在 FP 中，特别强调函数不要有“副作用”（洋文叫“side effect”）。没有副作用的函数，又称之为纯函数（pure function）。其输出完全依赖于输入。换句话说，只要输入一样，输出就一样。\n\n要成为纯函数，函数内部不能读写函数外部变量、不能有设备 I/O（比如读写文件）......\n\n无副作用是 FP 的重要特性。FP的很多优点来自于此特性。\n\n## 避免控制流\n\n在 FP 中，尽量避免用控制流语句（循环语句、判断语句）。对于控制流语句，FP 有另外的替代方式。比如：常用递归或高阶函数来替代循环。如此一来，FP 的代码会显得更简洁，更可读。\n\n## 多态\n\n大部分支持 FP 的语言，也都支持多态。函数参数支持多态化，便可实现非常灵活的功能。\n\n说了这么多，不知道大伙儿明白了没？还是没整明白的同学，请看维基百科的英文词条（中文词条太简单，看不明白滴）。\n\n洋文实在看不下去吗？那不妨看看 IT 大牛 Joel 写的《你的编程语言能这样做吗？》（中文版在“这里”）。此文以 JavaScript 来阐述 FP 的妙处。\n\n# FP 的优点\n\n再稍微说一下 FP 的好处，以强化大伙儿学习的动力。\n\n## 模块化\n\n在 FP 的思想中，函数最好是“纯”的，而且最好只完成“单一”的任务。在这种指导思想下，函数的模块化程度自然就高。\n\n## 可复用性\n\n模块化程度高，直接的好处就是可复用性好。\n\n## 可读性\n\n刚才说了，FP 的思想强调函数又纯又小。这样的函数，代码的可读性自然好，修改起来也方便。\n\n## 易于调试\n\n前面提到了纯函数。如果你的程序中大部分函数都是纯函数，则调试 Bug 会容易很多。像 OOP 中，类的多个成员函数都可以修改类的成员变量，有时候会导致调试极其困难。而纯函数没有此问题。\n\n另外，多线程是调试的一大噩梦。当年俺还专门写过帖子，介绍 C++ 多线程的注意事项（在“这里”）。而纯函数由于没有副作用，不必担心各种“互斥”、“死锁”等问题。\n\n## 易于测试\n\n除了易于调试，纯函数的输出仅仅依赖于输入，这一特点注定了它很容易进行单元测试。\n\n## 适合并行\n\n在 FP 中，由于纯函数无副作用，很适合编写并行处理的代码。最典型并且在工业界获得巨大成功的例子就是 Erlang。\n\n## 其它\n\n当然啦，FP 的好处远不止上述这些（比如还有：利于形式化证明）。限于篇幅，俺就不展开了。\n\n# Python 的函数语法\n\nPython 中，常见的函数定义和函数调用，想必各位都晓得了。下面说几种不太常见的，且跟 FP 有关的语法。\n\n## 函数赋值\n\nPython 可以把函数直接赋值给一个变量。举例如下：\n\n```python\n\ndef square(n) :  # 这是一个计算平方的小函数，后面会反复用它举例\n    return n ** 2\n\nf = square  # 此处赋值给变量 f\nf(10)  # 此处返回100。注意：对该变量使用小括号，等同于调用函数\n\n```\n\n## 匿名定义\n\nPython 可以用 lambda 关键字定义【单行】的匿名函数。套用刚才的例子\n\n```python\n\nsquare = lambda x : x**2  # 定义一个单参数的匿名函数，并把该函数赋值给变量\nsquare(10)  # 此处返回 100\n\n```\n\n## 嵌套定义\n\nPython 支持函数的嵌套定义（请看如下例子）。这种语法，在“闭包”中经常出现（后面会具体介绍“闭包”）。\n\n```python\n\ndef outer() :  # 外层函数\n    s = \"hello\"\n    def inner() :  # 内层函数\n        print(s)  # 此处引用的是外层作用域的变量\n\n    inner()  # 输出 hello\n    s = \"world\"\n    inner()  # 输出 world\n\n```\n\n# 和 FP 相关的内置函数\n\nPython 内置了一大坨用于 FP 的函数，以方便程序猿写出简洁的代码。在接下去聊之前，俺有必要先介绍其中的2个。\n\n## map(func, iter)\n\n为了省事，俺只介绍2参数的 map（正宗的 map 支持 N 参数）。\n\n参数 func 是个函数，参数 iter 是个迭代器（也可以理解为集合）\n\nmap() 会把 iter 的每个元素传给 func，并把每次调用的结果保存到一个 list 中，然后返回此 list。\n\n举例：\n\n挨个计算整数 list 的平方：\n\n```python\n\nmap(square, [1, 2, 3])  # 返回 [1, 4, 9]\n\n```\n\n## filter(func, iter)\n\n参数含义同 map\n\nfilter() 会把 iter 的每个元素传给 func，如果 func 返回结果为 True，就把元素保存在一个 list 中，最后返回此 list。\n\n举例：\n\n要过滤出所有奇数，代码如下：\n\n```python\n\ndef odd(n) :\n    return (n%2) == 1\n\nfilter(odd, [1, 2, 3])  # 返回[1, 3]\n\n```\n\n此处可以用上 lambda，把代码简化为一行：\n\n```python\nfilter(lambda n: (n%2)==1, lst)\n```\n\n# 消除控制流\n\n为了让大伙儿更深刻体会 FP 风格同传统风格的差别，俺把刚才两个例子组合一下——要求返回整数list 中所有奇数的平方。\n\n传统的写法（有控制流）：\n\n```python\n\ndef func1(old_lst) :\n    new_lst = []\n    for n in old_lst :\n        if odd(n) :\n            new_lst.append(square(n))\n    return new_lst\n\n```\n\nFP 的写法（无控制流）：\n\n```python\n\ndef func2(lst) :\n    return map(square, filter(odd, lst))\n\n```\n\n怎么样？是不是更简洁？连 for / if 这两个关键字都不需要了。\n\n# List Comprehension\n\n这个洋文比较难翻译。有人叫做“列表推导”，也有人称为“列表展开”或“列表解析”。（俺比较喜欢头一个翻译——不禁让人联想到“推倒”:）\n\n在 Python 中，这是一个很好吃的语法糖——可以让你写出很简洁、很优雅的代码。\n\n举例1：\n\n还拿刚才过滤奇数的例子。\n\n```python\n\nfilter(lambda n: (n%2)==1, lst)\n\n```\n\n上述写法可以等价替换为列表推导：\n\n```python\n\n[n for n in lst if (n%2)==1]\n\n```\n\n举例2：\n　　\n再来一个稍微复杂的例子。假设有两个整数 list，分别存储矩形的宽度和高度。现在想把所有的宽度和高度进行两两组合，把大于 10 的面积打印出来。\n　　\n传统的写法（2层循环，4行代码）\n\n```python\n\nfor w in width :\n    for h in height :\n        if w*h \u003e 10 :\n            print(w*h)\n\n```\n\nFP 的写法（无循环，1行代码，多精致啊）\n\n```python\n\nprint( [w*h for w in width for h in height if w*h \u003e 10] )\n\n```\n\n除了列表推导，Python 中还有字典推导、集合推导等等。为了省点口水，暂且打住。\n\n# 闭包\n\n闭包，洋文叫“closure”，解释在“这里”。它是 FP 的常见手法。那闭包到底有啥用捏？俺举一个微积分中，函数求导的例子。（不懂微积分或者对高数有心理阴影的同学，别担心，请把注意力集中在代码上）\n\n```python\n\ndef d(f) :\n    def calc(x) :\n        dx = 0.000001  # 表示无穷小的Δx\n        return (f(x+dx) - f(x)) / dx  # 计算斜率。注意，此处引用了外层作用域的变量 f\n    return calc  # 此处用函数作为返回值（也就是函数 f 的导数）\n\n```\n\n现在，假设要计算二次函数 f(x) = x2 + x + 1 的导数，只需如下代码：\n\n```python\n\nf = lambda x : x**2 + x + 1  # 先把二次函数用代码表达出来\nf1 = d(f)  # 这个f1 就是 f 的一阶导数啦。注意，导数依然是个函数\n\n```\n\n有了一阶导数，就可以很容易地计算该函数在某点的斜率\n\n比如要计算 x=3 的斜率，只需：\n\n```python\n\nf1(3)\n\n```\n\n如果要想得到二阶导数（导数的导数），只需依样画葫芦（瞧这代码写得多优雅）\n\n```python\n\nf2 = d(f1)\n\n```\n\n看到这里，大伙儿不妨设想一下：如果不用 FP，改用 OOP，上述需求该如何实现？俺觉得吧，用 OOP 来求导，这代码写起来多半是又丑又臭。\n\n# 结尾\n\n今天聊了不少 FP 的语法特性，可惜还是没聊完。由于俺比较懒，而且怕写得太长没人看，所以一些高级话题（比如：迭代器、生成器、等），今天就不介绍了。假如列位看官对那些玩意儿感兴趣，再抽空单独写一帖。\n\n[回到本系列的目录](RP-why-choose-python-0-overview)\n\n\u003e **版权声明**\u003cbr\u003e\n\u003e 本博客（编程随想的博客）所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者编程随想和本文原始地址：\u003cbr\u003e\n\u003e \u003ca href=\"https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html\"\u003ehttps://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html\u003c/a\u003e\n"},"mdAst":{"type":"root","children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"文章目录","position":{"start":{"line":2,"column":5,"offset":5},"end":{"line":2,"column":9,"offset":9}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":9,"offset":9}}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"什么是函数式编程","position":{"start":{"line":4,"column":3,"offset":13},"end":{"line":4,"column":11,"offset":21}}}],"position":{"start":{"line":4,"column":3,"offset":13},"end":{"line":4,"column":11,"offset":21}}}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":11,"offset":21}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"FP 的特点","position":{"start":{"line":5,"column":3,"offset":24},"end":{"line":5,"column":9,"offset":30}}}],"position":{"start":{"line":5,"column":3,"offset":24},"end":{"line":5,"column":9,"offset":30}}}],"position":{"start":{"line":5,"column":1,"offset":22},"end":{"line":5,"column":9,"offset":30}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"FP 的优点","position":{"start":{"line":6,"column":3,"offset":33},"end":{"line":6,"column":9,"offset":39}}}],"position":{"start":{"line":6,"column":3,"offset":33},"end":{"line":6,"column":9,"offset":39}}}],"position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":9,"offset":39}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Python 的函数语法","position":{"start":{"line":7,"column":3,"offset":42},"end":{"line":7,"column":15,"offset":54}}}],"position":{"start":{"line":7,"column":3,"offset":42},"end":{"line":7,"column":15,"offset":54}}}],"position":{"start":{"line":7,"column":1,"offset":40},"end":{"line":7,"column":15,"offset":54}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"和 FP 相关的内置函数","position":{"start":{"line":8,"column":3,"offset":57},"end":{"line":8,"column":15,"offset":69}}}],"position":{"start":{"line":8,"column":3,"offset":57},"end":{"line":8,"column":15,"offset":69}}}],"position":{"start":{"line":8,"column":1,"offset":55},"end":{"line":8,"column":15,"offset":69}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"消除控制流","position":{"start":{"line":9,"column":3,"offset":72},"end":{"line":9,"column":8,"offset":77}}}],"position":{"start":{"line":9,"column":3,"offset":72},"end":{"line":9,"column":8,"offset":77}}}],"position":{"start":{"line":9,"column":1,"offset":70},"end":{"line":9,"column":8,"offset":77}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"List Comprehension","position":{"start":{"line":10,"column":3,"offset":80},"end":{"line":10,"column":21,"offset":98}}}],"position":{"start":{"line":10,"column":3,"offset":80},"end":{"line":10,"column":21,"offset":98}}}],"position":{"start":{"line":10,"column":1,"offset":78},"end":{"line":10,"column":21,"offset":98}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"闭包","position":{"start":{"line":11,"column":3,"offset":101},"end":{"line":11,"column":5,"offset":103}}}],"position":{"start":{"line":11,"column":3,"offset":101},"end":{"line":11,"column":5,"offset":103}}}],"position":{"start":{"line":11,"column":1,"offset":99},"end":{"line":11,"column":5,"offset":103}}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"结尾","position":{"start":{"line":12,"column":3,"offset":106},"end":{"line":12,"column":5,"offset":108}}}],"position":{"start":{"line":12,"column":3,"offset":106},"end":{"line":12,"column":5,"offset":108}}}],"position":{"start":{"line":12,"column":1,"offset":104},"end":{"line":12,"column":5,"offset":108}}}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":12,"column":5,"offset":108}}},{"type":"paragraph","children":[{"type":"text","value":"春节前看到热心读者留言，提醒俺：Python 系列好久没更新了（不知不觉又过了一年多）。俺当时回复说：春节假期补上后一篇。昨天听到鞭炮声才发觉元宵已经到了，赶忙写出本文。","position":{"start":{"line":14,"column":1,"offset":110},"end":{"line":14,"column":86,"offset":195}}}],"position":{"start":{"line":14,"column":1,"offset":110},"end":{"line":14,"column":86,"offset":195}}},{"type":"paragraph","children":[{"type":"text","value":"前一个帖子介绍了 Python 作为“面向对象编程”（以下简称 OOP）语言的特点，今天来聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。","position":{"start":{"line":16,"column":1,"offset":197},"end":{"line":16,"column":129,"offset":325}}}],"position":{"start":{"line":16,"column":1,"offset":197},"end":{"line":16,"column":129,"offset":325}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"什么是函数式编程","position":{"start":{"line":18,"column":3,"offset":329},"end":{"line":18,"column":11,"offset":337}}}],"position":{"start":{"line":18,"column":1,"offset":327},"end":{"line":18,"column":11,"offset":337}}},{"type":"paragraph","children":[{"type":"text","value":"说实话，“函数式编程语言”是一个很大的话题。由于篇幅有限，本文不可能对这个话题做全面介绍。俺干脆偷一下懒，只简单说说。","position":{"start":{"line":20,"column":1,"offset":339},"end":{"line":20,"column":60,"offset":398}}}],"position":{"start":{"line":20,"column":1,"offset":339},"end":{"line":20,"column":60,"offset":398}}},{"type":"paragraph","children":[{"type":"text","value":"从字面上看，所谓的函数式编程，就是以“函数”为中心的“编程范式”。估计有同学又会问了，啥是“编程范式”捏？哎呦，这又是一个很大的话题。通俗来讲，“编程范式”就是指编程的套路。比方说大家很熟悉的 OOP，就是一种“编程范式”。FP 跟 OOP 一样，都是一种编程的套路。做个简单类比：OOP 以“对象/类”作为程序设计的核心，而 FP 以“函数”作为程序设计的核心。","position":{"start":{"line":22,"column":1,"offset":400},"end":{"line":22,"column":183,"offset":582}}}],"position":{"start":{"line":22,"column":1,"offset":400},"end":{"line":22,"column":183,"offset":582}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"FP的特点","position":{"start":{"line":24,"column":3,"offset":586},"end":{"line":24,"column":8,"offset":591}}}],"position":{"start":{"line":24,"column":1,"offset":584},"end":{"line":24,"column":8,"offset":591}}},{"type":"paragraph","children":[{"type":"text","value":"既然说到 FP，自然要稍微说一下 FP 的特色。","position":{"start":{"line":26,"column":1,"offset":593},"end":{"line":26,"column":25,"offset":617}}}],"position":{"start":{"line":26,"column":1,"offset":593},"end":{"line":26,"column":25,"offset":617}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"函数很牛X","position":{"start":{"line":28,"column":4,"offset":622},"end":{"line":28,"column":9,"offset":627}}}],"position":{"start":{"line":28,"column":1,"offset":619},"end":{"line":28,"column":9,"offset":627}}},{"type":"paragraph","children":[{"type":"text","value":"刚才说了，FP 是以函数为中心。既然如此，在支持 FP 的语言中，函数的功能自然十分牛X。通俗地说，OOP 语言中，类/对象能干的事情，FP 语言中的函数也能干。下面做一些对比，以加深大伙儿的印象。","position":{"start":{"line":30,"column":1,"offset":629},"end":{"line":30,"column":100,"offset":728}}}],"position":{"start":{"line":30,"column":1,"offset":629},"end":{"line":30,"column":100,"offset":728}}},{"type":"paragraph","children":[{"type":"text","value":"OOP 中，对象可以互相赋值；FP 中，函数可以互相赋值。","position":{"start":{"line":32,"column":1,"offset":730},"end":{"line":32,"column":30,"offset":759}}}],"position":{"start":{"line":32,"column":1,"offset":730},"end":{"line":32,"column":30,"offset":759}}},{"type":"paragraph","children":[{"type":"text","value":"OOP 中，对象可以作为函数的参数/返回值，FP 中，函数可以作为函数的参数/返回值。","position":{"start":{"line":34,"column":1,"offset":761},"end":{"line":34,"column":44,"offset":804}}}],"position":{"start":{"line":34,"column":1,"offset":761},"end":{"line":34,"column":44,"offset":804}}},{"type":"paragraph","children":[{"type":"text","value":"某些 OOP 中，类可以嵌套定义；FP 中，函数可以嵌套定义。","position":{"start":{"line":36,"column":1,"offset":806},"end":{"line":36,"column":32,"offset":837}}}],"position":{"start":{"line":36,"column":1,"offset":806},"end":{"line":36,"column":32,"offset":837}}},{"type":"paragraph","children":[{"type":"text","value":"某些 OOP 中，可以有匿名类；FP 中，可以有匿名函数。","position":{"start":{"line":38,"column":1,"offset":839},"end":{"line":38,"column":30,"offset":868}}}],"position":{"start":{"line":38,"column":1,"offset":839},"end":{"line":38,"column":30,"offset":868}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"避免副作用","position":{"start":{"line":40,"column":4,"offset":873},"end":{"line":40,"column":9,"offset":878}}}],"position":{"start":{"line":40,"column":1,"offset":870},"end":{"line":40,"column":9,"offset":878}}},{"type":"paragraph","children":[{"type":"text","value":"在 FP 中，特别强调函数不要有“副作用”（洋文叫“side effect”）。没有副作用的函数，又称之为纯函数（pure function）。其输出完全依赖于输入。换句话说，只要输入一样，输出就一样。","position":{"start":{"line":42,"column":1,"offset":880},"end":{"line":42,"column":102,"offset":981}}}],"position":{"start":{"line":42,"column":1,"offset":880},"end":{"line":42,"column":102,"offset":981}}},{"type":"paragraph","children":[{"type":"text","value":"要成为纯函数，函数内部不能读写函数外部变量、不能有设备 I/O（比如读写文件）......","position":{"start":{"line":44,"column":1,"offset":983},"end":{"line":44,"column":46,"offset":1028}}}],"position":{"start":{"line":44,"column":1,"offset":983},"end":{"line":44,"column":46,"offset":1028}}},{"type":"paragraph","children":[{"type":"text","value":"无副作用是 FP 的重要特性。FP的很多优点来自于此特性。","position":{"start":{"line":46,"column":1,"offset":1030},"end":{"line":46,"column":30,"offset":1059}}}],"position":{"start":{"line":46,"column":1,"offset":1030},"end":{"line":46,"column":30,"offset":1059}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"避免控制流","position":{"start":{"line":48,"column":4,"offset":1064},"end":{"line":48,"column":9,"offset":1069}}}],"position":{"start":{"line":48,"column":1,"offset":1061},"end":{"line":48,"column":9,"offset":1069}}},{"type":"paragraph","children":[{"type":"text","value":"在 FP 中，尽量避免用控制流语句（循环语句、判断语句）。对于控制流语句，FP 有另外的替代方式。比如：常用递归或高阶函数来替代循环。如此一来，FP 的代码会显得更简洁，更可读。","position":{"start":{"line":50,"column":1,"offset":1071},"end":{"line":50,"column":90,"offset":1160}}}],"position":{"start":{"line":50,"column":1,"offset":1071},"end":{"line":50,"column":90,"offset":1160}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"多态","position":{"start":{"line":52,"column":4,"offset":1165},"end":{"line":52,"column":6,"offset":1167}}}],"position":{"start":{"line":52,"column":1,"offset":1162},"end":{"line":52,"column":6,"offset":1167}}},{"type":"paragraph","children":[{"type":"text","value":"大部分支持 FP 的语言，也都支持多态。函数参数支持多态化，便可实现非常灵活的功能。","position":{"start":{"line":54,"column":1,"offset":1169},"end":{"line":54,"column":43,"offset":1211}}}],"position":{"start":{"line":54,"column":1,"offset":1169},"end":{"line":54,"column":43,"offset":1211}}},{"type":"paragraph","children":[{"type":"text","value":"说了这么多，不知道大伙儿明白了没？还是没整明白的同学，请看维基百科的英文词条（中文词条太简单，看不明白滴）。","position":{"start":{"line":56,"column":1,"offset":1213},"end":{"line":56,"column":55,"offset":1267}}}],"position":{"start":{"line":56,"column":1,"offset":1213},"end":{"line":56,"column":55,"offset":1267}}},{"type":"paragraph","children":[{"type":"text","value":"洋文实在看不下去吗？那不妨看看 IT 大牛 Joel 写的《你的编程语言能这样做吗？》（中文版在“这里”）。此文以 JavaScript 来阐述 FP 的妙处。","position":{"start":{"line":58,"column":1,"offset":1269},"end":{"line":58,"column":81,"offset":1349}}}],"position":{"start":{"line":58,"column":1,"offset":1269},"end":{"line":58,"column":81,"offset":1349}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"FP 的优点","position":{"start":{"line":60,"column":3,"offset":1353},"end":{"line":60,"column":9,"offset":1359}}}],"position":{"start":{"line":60,"column":1,"offset":1351},"end":{"line":60,"column":9,"offset":1359}}},{"type":"paragraph","children":[{"type":"text","value":"再稍微说一下 FP 的好处，以强化大伙儿学习的动力。","position":{"start":{"line":62,"column":1,"offset":1361},"end":{"line":62,"column":27,"offset":1387}}}],"position":{"start":{"line":62,"column":1,"offset":1361},"end":{"line":62,"column":27,"offset":1387}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"模块化","position":{"start":{"line":64,"column":4,"offset":1392},"end":{"line":64,"column":7,"offset":1395}}}],"position":{"start":{"line":64,"column":1,"offset":1389},"end":{"line":64,"column":7,"offset":1395}}},{"type":"paragraph","children":[{"type":"text","value":"在 FP 的思想中，函数最好是“纯”的，而且最好只完成“单一”的任务。在这种指导思想下，函数的模块化程度自然就高。","position":{"start":{"line":66,"column":1,"offset":1397},"end":{"line":66,"column":58,"offset":1454}}}],"position":{"start":{"line":66,"column":1,"offset":1397},"end":{"line":66,"column":58,"offset":1454}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"可复用性","position":{"start":{"line":68,"column":4,"offset":1459},"end":{"line":68,"column":8,"offset":1463}}}],"position":{"start":{"line":68,"column":1,"offset":1456},"end":{"line":68,"column":8,"offset":1463}}},{"type":"paragraph","children":[{"type":"text","value":"模块化程度高，直接的好处就是可复用性好。","position":{"start":{"line":70,"column":1,"offset":1465},"end":{"line":70,"column":21,"offset":1485}}}],"position":{"start":{"line":70,"column":1,"offset":1465},"end":{"line":70,"column":21,"offset":1485}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"可读性","position":{"start":{"line":72,"column":4,"offset":1490},"end":{"line":72,"column":7,"offset":1493}}}],"position":{"start":{"line":72,"column":1,"offset":1487},"end":{"line":72,"column":7,"offset":1493}}},{"type":"paragraph","children":[{"type":"text","value":"刚才说了，FP 的思想强调函数又纯又小。这样的函数，代码的可读性自然好，修改起来也方便。","position":{"start":{"line":74,"column":1,"offset":1495},"end":{"line":74,"column":45,"offset":1539}}}],"position":{"start":{"line":74,"column":1,"offset":1495},"end":{"line":74,"column":45,"offset":1539}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"易于调试","position":{"start":{"line":76,"column":4,"offset":1544},"end":{"line":76,"column":8,"offset":1548}}}],"position":{"start":{"line":76,"column":1,"offset":1541},"end":{"line":76,"column":8,"offset":1548}}},{"type":"paragraph","children":[{"type":"text","value":"前面提到了纯函数。如果你的程序中大部分函数都是纯函数，则调试 Bug 会容易很多。像 OOP 中，类的多个成员函数都可以修改类的成员变量，有时候会导致调试极其困难。而纯函数没有此问题。","position":{"start":{"line":78,"column":1,"offset":1550},"end":{"line":78,"column":93,"offset":1642}}}],"position":{"start":{"line":78,"column":1,"offset":1550},"end":{"line":78,"column":93,"offset":1642}}},{"type":"paragraph","children":[{"type":"text","value":"另外，多线程是调试的一大噩梦。当年俺还专门写过帖子，介绍 C++ 多线程的注意事项（在“这里”）。而纯函数由于没有副作用，不必担心各种“互斥”、“死锁”等问题。","position":{"start":{"line":80,"column":1,"offset":1644},"end":{"line":80,"column":81,"offset":1724}}}],"position":{"start":{"line":80,"column":1,"offset":1644},"end":{"line":80,"column":81,"offset":1724}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"易于测试","position":{"start":{"line":82,"column":4,"offset":1729},"end":{"line":82,"column":8,"offset":1733}}}],"position":{"start":{"line":82,"column":1,"offset":1726},"end":{"line":82,"column":8,"offset":1733}}},{"type":"paragraph","children":[{"type":"text","value":"除了易于调试，纯函数的输出仅仅依赖于输入，这一特点注定了它很容易进行单元测试。","position":{"start":{"line":84,"column":1,"offset":1735},"end":{"line":84,"column":40,"offset":1774}}}],"position":{"start":{"line":84,"column":1,"offset":1735},"end":{"line":84,"column":40,"offset":1774}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"适合并行","position":{"start":{"line":86,"column":4,"offset":1779},"end":{"line":86,"column":8,"offset":1783}}}],"position":{"start":{"line":86,"column":1,"offset":1776},"end":{"line":86,"column":8,"offset":1783}}},{"type":"paragraph","children":[{"type":"text","value":"在 FP 中，由于纯函数无副作用，很适合编写并行处理的代码。最典型并且在工业界获得巨大成功的例子就是 Erlang。","position":{"start":{"line":88,"column":1,"offset":1785},"end":{"line":88,"column":59,"offset":1843}}}],"position":{"start":{"line":88,"column":1,"offset":1785},"end":{"line":88,"column":59,"offset":1843}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"其它","position":{"start":{"line":90,"column":4,"offset":1848},"end":{"line":90,"column":6,"offset":1850}}}],"position":{"start":{"line":90,"column":1,"offset":1845},"end":{"line":90,"column":6,"offset":1850}}},{"type":"paragraph","children":[{"type":"text","value":"当然啦，FP 的好处远不止上述这些（比如还有：利于形式化证明）。限于篇幅，俺就不展开了。","position":{"start":{"line":92,"column":1,"offset":1852},"end":{"line":92,"column":45,"offset":1896}}}],"position":{"start":{"line":92,"column":1,"offset":1852},"end":{"line":92,"column":45,"offset":1896}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Python 的函数语法","position":{"start":{"line":94,"column":3,"offset":1900},"end":{"line":94,"column":15,"offset":1912}}}],"position":{"start":{"line":94,"column":1,"offset":1898},"end":{"line":94,"column":15,"offset":1912}}},{"type":"paragraph","children":[{"type":"text","value":"Python 中，常见的函数定义和函数调用，想必各位都晓得了。下面说几种不太常见的，且跟 FP 有关的语法。","position":{"start":{"line":96,"column":1,"offset":1914},"end":{"line":96,"column":55,"offset":1968}}}],"position":{"start":{"line":96,"column":1,"offset":1914},"end":{"line":96,"column":55,"offset":1968}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"函数赋值","position":{"start":{"line":98,"column":4,"offset":1973},"end":{"line":98,"column":8,"offset":1977}}}],"position":{"start":{"line":98,"column":1,"offset":1970},"end":{"line":98,"column":8,"offset":1977}}},{"type":"paragraph","children":[{"type":"text","value":"Python 可以把函数直接赋值给一个变量。举例如下：","position":{"start":{"line":100,"column":1,"offset":1979},"end":{"line":100,"column":28,"offset":2006}}}],"position":{"start":{"line":100,"column":1,"offset":1979},"end":{"line":100,"column":28,"offset":2006}}},{"type":"code","lang":"python","meta":null,"value":"\ndef square(n) :  # 这是一个计算平方的小函数，后面会反复用它举例\n    return n ** 2\n\nf = square  # 此处赋值给变量 f\nf(10)  # 此处返回100。注意：对该变量使用小括号，等同于调用函数\n","position":{"start":{"line":102,"column":1,"offset":2008},"end":{"line":110,"column":4,"offset":2146}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"匿名定义","position":{"start":{"line":112,"column":4,"offset":2151},"end":{"line":112,"column":8,"offset":2155}}}],"position":{"start":{"line":112,"column":1,"offset":2148},"end":{"line":112,"column":8,"offset":2155}}},{"type":"paragraph","children":[{"type":"text","value":"Python 可以用 lambda 关键字定义【单行】的匿名函数。套用刚才的例子","position":{"start":{"line":114,"column":1,"offset":2157},"end":{"line":114,"column":41,"offset":2197}}}],"position":{"start":{"line":114,"column":1,"offset":2157},"end":{"line":114,"column":41,"offset":2197}}},{"type":"code","lang":"python","meta":null,"value":"\nsquare = lambda x : x**2  # 定义一个单参数的匿名函数，并把该函数赋值给变量\nsquare(10)  # 此处返回 100\n","position":{"start":{"line":116,"column":1,"offset":2199},"end":{"line":121,"column":4,"offset":2289}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"嵌套定义","position":{"start":{"line":123,"column":4,"offset":2294},"end":{"line":123,"column":8,"offset":2298}}}],"position":{"start":{"line":123,"column":1,"offset":2291},"end":{"line":123,"column":8,"offset":2298}}},{"type":"paragraph","children":[{"type":"text","value":"Python 支持函数的嵌套定义（请看如下例子）。这种语法，在“闭包”中经常出现（后面会具体介绍“闭包”）。","position":{"start":{"line":125,"column":1,"offset":2300},"end":{"line":125,"column":55,"offset":2354}}}],"position":{"start":{"line":125,"column":1,"offset":2300},"end":{"line":125,"column":55,"offset":2354}}},{"type":"code","lang":"python","meta":null,"value":"\ndef outer() :  # 外层函数\n    s = \"hello\"\n    def inner() :  # 内层函数\n        print(s)  # 此处引用的是外层作用域的变量\n\n    inner()  # 输出 hello\n    s = \"world\"\n    inner()  # 输出 world\n","position":{"start":{"line":127,"column":1,"offset":2356},"end":{"line":138,"column":4,"offset":2535}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"和 FP 相关的内置函数","position":{"start":{"line":140,"column":3,"offset":2539},"end":{"line":140,"column":15,"offset":2551}}}],"position":{"start":{"line":140,"column":1,"offset":2537},"end":{"line":140,"column":15,"offset":2551}}},{"type":"paragraph","children":[{"type":"text","value":"Python 内置了一大坨用于 FP 的函数，以方便程序猿写出简洁的代码。在接下去聊之前，俺有必要先介绍其中的2个。","position":{"start":{"line":142,"column":1,"offset":2553},"end":{"line":142,"column":59,"offset":2611}}}],"position":{"start":{"line":142,"column":1,"offset":2553},"end":{"line":142,"column":59,"offset":2611}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"map(func, iter)","position":{"start":{"line":144,"column":4,"offset":2616},"end":{"line":144,"column":19,"offset":2631}}}],"position":{"start":{"line":144,"column":1,"offset":2613},"end":{"line":144,"column":19,"offset":2631}}},{"type":"paragraph","children":[{"type":"text","value":"为了省事，俺只介绍2参数的 map（正宗的 map 支持 N 参数）。","position":{"start":{"line":146,"column":1,"offset":2633},"end":{"line":146,"column":36,"offset":2668}}}],"position":{"start":{"line":146,"column":1,"offset":2633},"end":{"line":146,"column":36,"offset":2668}}},{"type":"paragraph","children":[{"type":"text","value":"参数 func 是个函数，参数 iter 是个迭代器（也可以理解为集合）","position":{"start":{"line":148,"column":1,"offset":2670},"end":{"line":148,"column":37,"offset":2706}}}],"position":{"start":{"line":148,"column":1,"offset":2670},"end":{"line":148,"column":37,"offset":2706}}},{"type":"paragraph","children":[{"type":"text","value":"map() 会把 iter 的每个元素传给 func，并把每次调用的结果保存到一个 list 中，然后返回此 list。","position":{"start":{"line":150,"column":1,"offset":2708},"end":{"line":150,"column":61,"offset":2768}}}],"position":{"start":{"line":150,"column":1,"offset":2708},"end":{"line":150,"column":61,"offset":2768}}},{"type":"paragraph","children":[{"type":"text","value":"举例：","position":{"start":{"line":152,"column":1,"offset":2770},"end":{"line":152,"column":4,"offset":2773}}}],"position":{"start":{"line":152,"column":1,"offset":2770},"end":{"line":152,"column":4,"offset":2773}}},{"type":"paragraph","children":[{"type":"text","value":"挨个计算整数 list 的平方：","position":{"start":{"line":154,"column":1,"offset":2775},"end":{"line":154,"column":17,"offset":2791}}}],"position":{"start":{"line":154,"column":1,"offset":2775},"end":{"line":154,"column":17,"offset":2791}}},{"type":"code","lang":"python","meta":null,"value":"\nmap(square, [1, 2, 3])  # 返回 [1, 4, 9]\n","position":{"start":{"line":156,"column":1,"offset":2793},"end":{"line":160,"column":4,"offset":2847}}},{"type":"heading","depth":2,"children":[{"type":"text","value":"filter(func, iter)","position":{"start":{"line":162,"column":4,"offset":2852},"end":{"line":162,"column":22,"offset":2870}}}],"position":{"start":{"line":162,"column":1,"offset":2849},"end":{"line":162,"column":22,"offset":2870}}},{"type":"paragraph","children":[{"type":"text","value":"参数含义同 map","position":{"start":{"line":164,"column":1,"offset":2872},"end":{"line":164,"column":10,"offset":2881}}}],"position":{"start":{"line":164,"column":1,"offset":2872},"end":{"line":164,"column":10,"offset":2881}}},{"type":"paragraph","children":[{"type":"text","value":"filter() 会把 iter 的每个元素传给 func，如果 func 返回结果为 True，就把元素保存在一个 list 中，最后返回此 list。","position":{"start":{"line":166,"column":1,"offset":2883},"end":{"line":166,"column":78,"offset":2960}}}],"position":{"start":{"line":166,"column":1,"offset":2883},"end":{"line":166,"column":78,"offset":2960}}},{"type":"paragraph","children":[{"type":"text","value":"举例：","position":{"start":{"line":168,"column":1,"offset":2962},"end":{"line":168,"column":4,"offset":2965}}}],"position":{"start":{"line":168,"column":1,"offset":2962},"end":{"line":168,"column":4,"offset":2965}}},{"type":"paragraph","children":[{"type":"text","value":"要过滤出所有奇数，代码如下：","position":{"start":{"line":170,"column":1,"offset":2967},"end":{"line":170,"column":15,"offset":2981}}}],"position":{"start":{"line":170,"column":1,"offset":2967},"end":{"line":170,"column":15,"offset":2981}}},{"type":"code","lang":"python","meta":null,"value":"\ndef odd(n) :\n    return (n%2) == 1\n\nfilter(odd, [1, 2, 3])  # 返回[1, 3]\n","position":{"start":{"line":172,"column":1,"offset":2983},"end":{"line":179,"column":4,"offset":3069}}},{"type":"paragraph","children":[{"type":"text","value":"此处可以用上 lambda，把代码简化为一行：","position":{"start":{"line":181,"column":1,"offset":3071},"end":{"line":181,"column":24,"offset":3094}}}],"position":{"start":{"line":181,"column":1,"offset":3071},"end":{"line":181,"column":24,"offset":3094}}},{"type":"code","lang":"python","meta":null,"value":"filter(lambda n: (n%2)==1, lst)","position":{"start":{"line":183,"column":1,"offset":3096},"end":{"line":185,"column":4,"offset":3141}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"消除控制流","position":{"start":{"line":187,"column":3,"offset":3145},"end":{"line":187,"column":8,"offset":3150}}}],"position":{"start":{"line":187,"column":1,"offset":3143},"end":{"line":187,"column":8,"offset":3150}}},{"type":"paragraph","children":[{"type":"text","value":"为了让大伙儿更深刻体会 FP 风格同传统风格的差别，俺把刚才两个例子组合一下——要求返回整数list 中所有奇数的平方。","position":{"start":{"line":189,"column":1,"offset":3152},"end":{"line":189,"column":61,"offset":3212}}}],"position":{"start":{"line":189,"column":1,"offset":3152},"end":{"line":189,"column":61,"offset":3212}}},{"type":"paragraph","children":[{"type":"text","value":"传统的写法（有控制流）：","position":{"start":{"line":191,"column":1,"offset":3214},"end":{"line":191,"column":13,"offset":3226}}}],"position":{"start":{"line":191,"column":1,"offset":3214},"end":{"line":191,"column":13,"offset":3226}}},{"type":"code","lang":"python","meta":null,"value":"\ndef func1(old_lst) :\n    new_lst = []\n    for n in old_lst :\n        if odd(n) :\n            new_lst.append(square(n))\n    return new_lst\n","position":{"start":{"line":193,"column":1,"offset":3228},"end":{"line":202,"column":4,"offset":3381}}},{"type":"paragraph","children":[{"type":"text","value":"FP 的写法（无控制流）：","position":{"start":{"line":204,"column":1,"offset":3383},"end":{"line":204,"column":14,"offset":3396}}}],"position":{"start":{"line":204,"column":1,"offset":3383},"end":{"line":204,"column":14,"offset":3396}}},{"type":"code","lang":"python","meta":null,"value":"\ndef func2(lst) :\n    return map(square, filter(odd, lst))\n","position":{"start":{"line":206,"column":1,"offset":3398},"end":{"line":211,"column":4,"offset":3471}}},{"type":"paragraph","children":[{"type":"text","value":"怎么样？是不是更简洁？连 for / if 这两个关键字都不需要了。","position":{"start":{"line":213,"column":1,"offset":3473},"end":{"line":213,"column":35,"offset":3507}}}],"position":{"start":{"line":213,"column":1,"offset":3473},"end":{"line":213,"column":35,"offset":3507}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"List Comprehension","position":{"start":{"line":215,"column":3,"offset":3511},"end":{"line":215,"column":21,"offset":3529}}}],"position":{"start":{"line":215,"column":1,"offset":3509},"end":{"line":215,"column":21,"offset":3529}}},{"type":"paragraph","children":[{"type":"text","value":"这个洋文比较难翻译。有人叫做“列表推导”，也有人称为“列表展开”或“列表解析”。（俺比较喜欢头一个翻译——不禁让人联想到“推倒”:）","position":{"start":{"line":217,"column":1,"offset":3531},"end":{"line":217,"column":67,"offset":3597}}}],"position":{"start":{"line":217,"column":1,"offset":3531},"end":{"line":217,"column":67,"offset":3597}}},{"type":"paragraph","children":[{"type":"text","value":"在 Python 中，这是一个很好吃的语法糖——可以让你写出很简洁、很优雅的代码。","position":{"start":{"line":219,"column":1,"offset":3599},"end":{"line":219,"column":42,"offset":3640}}}],"position":{"start":{"line":219,"column":1,"offset":3599},"end":{"line":219,"column":42,"offset":3640}}},{"type":"paragraph","children":[{"type":"text","value":"举例1：","position":{"start":{"line":221,"column":1,"offset":3642},"end":{"line":221,"column":5,"offset":3646}}}],"position":{"start":{"line":221,"column":1,"offset":3642},"end":{"line":221,"column":5,"offset":3646}}},{"type":"paragraph","children":[{"type":"text","value":"还拿刚才过滤奇数的例子。","position":{"start":{"line":223,"column":1,"offset":3648},"end":{"line":223,"column":13,"offset":3660}}}],"position":{"start":{"line":223,"column":1,"offset":3648},"end":{"line":223,"column":13,"offset":3660}}},{"type":"code","lang":"python","meta":null,"value":"\nfilter(lambda n: (n%2)==1, lst)\n","position":{"start":{"line":225,"column":1,"offset":3662},"end":{"line":229,"column":4,"offset":3709}}},{"type":"paragraph","children":[{"type":"text","value":"上述写法可以等价替换为列表推导：","position":{"start":{"line":231,"column":1,"offset":3711},"end":{"line":231,"column":17,"offset":3727}}}],"position":{"start":{"line":231,"column":1,"offset":3711},"end":{"line":231,"column":17,"offset":3727}}},{"type":"code","lang":"python","meta":null,"value":"\n[n for n in lst if (n%2)==1]\n","position":{"start":{"line":233,"column":1,"offset":3729},"end":{"line":237,"column":4,"offset":3773}}},{"type":"paragraph","children":[{"type":"text","value":"举例2：\n　　\n再来一个稍微复杂的例子。假设有两个整数 list，分别存储矩形的宽度和高度。现在想把所有的宽度和高度进行两两组合，把大于 10 的面积打印出来。\n　　\n传统的写法（2层循环，4行代码）","position":{"start":{"line":239,"column":1,"offset":3775},"end":{"line":243,"column":17,"offset":3875}}}],"position":{"start":{"line":239,"column":1,"offset":3775},"end":{"line":243,"column":17,"offset":3875}}},{"type":"code","lang":"python","meta":null,"value":"\nfor w in width :\n    for h in height :\n        if w*h \u003e 10 :\n            print(w*h)\n","position":{"start":{"line":245,"column":1,"offset":3877},"end":{"line":252,"column":4,"offset":3976}}},{"type":"paragraph","children":[{"type":"text","value":"FP 的写法（无循环，1行代码，多精致啊）","position":{"start":{"line":254,"column":1,"offset":3978},"end":{"line":254,"column":22,"offset":3999}}}],"position":{"start":{"line":254,"column":1,"offset":3978},"end":{"line":254,"column":22,"offset":3999}}},{"type":"code","lang":"python","meta":null,"value":"\nprint( [w*h for w in width for h in height if w*h \u003e 10] )\n","position":{"start":{"line":256,"column":1,"offset":4001},"end":{"line":260,"column":4,"offset":4074}}},{"type":"paragraph","children":[{"type":"text","value":"除了列表推导，Python 中还有字典推导、集合推导等等。为了省点口水，暂且打住。","position":{"start":{"line":262,"column":1,"offset":4076},"end":{"line":262,"column":42,"offset":4117}}}],"position":{"start":{"line":262,"column":1,"offset":4076},"end":{"line":262,"column":42,"offset":4117}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"闭包","position":{"start":{"line":264,"column":3,"offset":4121},"end":{"line":264,"column":5,"offset":4123}}}],"position":{"start":{"line":264,"column":1,"offset":4119},"end":{"line":264,"column":5,"offset":4123}}},{"type":"paragraph","children":[{"type":"text","value":"闭包，洋文叫“closure”，解释在“这里”。它是 FP 的常见手法。那闭包到底有啥用捏？俺举一个微积分中，函数求导的例子。（不懂微积分或者对高数有心理阴影的同学，别担心，请把注意力集中在代码上）","position":{"start":{"line":266,"column":1,"offset":4125},"end":{"line":266,"column":100,"offset":4224}}}],"position":{"start":{"line":266,"column":1,"offset":4125},"end":{"line":266,"column":100,"offset":4224}}},{"type":"code","lang":"python","meta":null,"value":"\ndef d(f) :\n    def calc(x) :\n        dx = 0.000001  # 表示无穷小的Δx\n        return (f(x+dx) - f(x)) / dx  # 计算斜率。注意，此处引用了外层作用域的变量 f\n    return calc  # 此处用函数作为返回值（也就是函数 f 的导数）\n","position":{"start":{"line":268,"column":1,"offset":4226},"end":{"line":276,"column":4,"offset":4411}}},{"type":"paragraph","children":[{"type":"text","value":"现在，假设要计算二次函数 f(x) = x2 + x + 1 的导数，只需如下代码：","position":{"start":{"line":278,"column":1,"offset":4413},"end":{"line":278,"column":43,"offset":4455}}}],"position":{"start":{"line":278,"column":1,"offset":4413},"end":{"line":278,"column":43,"offset":4455}}},{"type":"code","lang":"python","meta":null,"value":"\nf = lambda x : x**2 + x + 1  # 先把二次函数用代码表达出来\nf1 = d(f)  # 这个f1 就是 f 的一阶导数啦。注意，导数依然是个函数\n","position":{"start":{"line":280,"column":1,"offset":4457},"end":{"line":285,"column":4,"offset":4559}}},{"type":"paragraph","children":[{"type":"text","value":"有了一阶导数，就可以很容易地计算该函数在某点的斜率","position":{"start":{"line":287,"column":1,"offset":4561},"end":{"line":287,"column":26,"offset":4586}}}],"position":{"start":{"line":287,"column":1,"offset":4561},"end":{"line":287,"column":26,"offset":4586}}},{"type":"paragraph","children":[{"type":"text","value":"比如要计算 x=3 的斜率，只需：","position":{"start":{"line":289,"column":1,"offset":4588},"end":{"line":289,"column":18,"offset":4605}}}],"position":{"start":{"line":289,"column":1,"offset":4588},"end":{"line":289,"column":18,"offset":4605}}},{"type":"code","lang":"python","meta":null,"value":"\nf1(3)\n","position":{"start":{"line":291,"column":1,"offset":4607},"end":{"line":295,"column":4,"offset":4628}}},{"type":"paragraph","children":[{"type":"text","value":"如果要想得到二阶导数（导数的导数），只需依样画葫芦（瞧这代码写得多优雅）","position":{"start":{"line":297,"column":1,"offset":4630},"end":{"line":297,"column":37,"offset":4666}}}],"position":{"start":{"line":297,"column":1,"offset":4630},"end":{"line":297,"column":37,"offset":4666}}},{"type":"code","lang":"python","meta":null,"value":"\nf2 = d(f1)\n","position":{"start":{"line":299,"column":1,"offset":4668},"end":{"line":303,"column":4,"offset":4694}}},{"type":"paragraph","children":[{"type":"text","value":"看到这里，大伙儿不妨设想一下：如果不用 FP，改用 OOP，上述需求该如何实现？俺觉得吧，用 OOP 来求导，这代码写起来多半是又丑又臭。","position":{"start":{"line":305,"column":1,"offset":4696},"end":{"line":305,"column":70,"offset":4765}}}],"position":{"start":{"line":305,"column":1,"offset":4696},"end":{"line":305,"column":70,"offset":4765}}},{"type":"heading","depth":1,"children":[{"type":"text","value":"结尾","position":{"start":{"line":307,"column":3,"offset":4769},"end":{"line":307,"column":5,"offset":4771}}}],"position":{"start":{"line":307,"column":1,"offset":4767},"end":{"line":307,"column":5,"offset":4771}}},{"type":"paragraph","children":[{"type":"text","value":"今天聊了不少 FP 的语法特性，可惜还是没聊完。由于俺比较懒，而且怕写得太长没人看，所以一些高级话题（比如：迭代器、生成器、等），今天就不介绍了。假如列位看官对那些玩意儿感兴趣，再抽空单独写一帖。","position":{"start":{"line":309,"column":1,"offset":4773},"end":{"line":309,"column":99,"offset":4871}}}],"position":{"start":{"line":309,"column":1,"offset":4773},"end":{"line":309,"column":99,"offset":4871}}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"RP-why-choose-python-0-overview","children":[{"type":"text","value":"回到本系列的目录","position":{"start":{"line":311,"column":2,"offset":4874},"end":{"line":311,"column":10,"offset":4882}}}],"position":{"start":{"line":311,"column":1,"offset":4873},"end":{"line":311,"column":44,"offset":4916}}}],"position":{"start":{"line":311,"column":1,"offset":4873},"end":{"line":311,"column":44,"offset":4916}}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"版权声明","position":{"start":{"line":313,"column":5,"offset":4922},"end":{"line":313,"column":9,"offset":4926}}}],"position":{"start":{"line":313,"column":3,"offset":4920},"end":{"line":313,"column":11,"offset":4928}}},{"type":"html","value":"\u003cbr\u003e","position":{"start":{"line":313,"column":11,"offset":4928},"end":{"line":313,"column":15,"offset":4932}}},{"type":"text","value":"\n本博客（编程随想的博客）所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者编程随想和本文原始地址：","position":{"start":{"line":313,"column":15,"offset":4932},"end":{"line":314,"column":71,"offset":5003}}},{"type":"html","value":"\u003cbr\u003e","position":{"start":{"line":314,"column":71,"offset":5003},"end":{"line":314,"column":75,"offset":5007}}},{"type":"text","value":"\n","position":{"start":{"line":314,"column":75,"offset":5007},"end":{"line":315,"column":1,"offset":5008}}},{"type":"html","value":"\u003ca href=\"https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html\"\u003e","position":{"start":{"line":315,"column":3,"offset":5010},"end":{"line":315,"column":84,"offset":5091}}},{"type":"link","title":null,"url":"https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html","children":[{"type":"text","value":"https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html","position":{"start":{"line":315,"column":84,"offset":5091},"end":{"line":315,"column":154,"offset":5161}}}],"position":{"start":{"line":315,"column":84,"offset":5091},"end":{"line":315,"column":154,"offset":5161}}},{"type":"html","value":"\u003c/a\u003e","position":{"start":{"line":315,"column":154,"offset":5161},"end":{"line":315,"column":158,"offset":5165}}}],"position":{"start":{"line":313,"column":3,"offset":4920},"end":{"line":315,"column":158,"offset":5165}}}],"position":{"start":{"line":313,"column":1,"offset":4918},"end":{"line":315,"column":158,"offset":5165}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":316,"column":1,"offset":5166}}},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"h3","properties":{"id":"文章目录"},"children":[{"type":"element","tagName":"a","properties":{"href":"#文章目录"},"children":[{"type":"text","value":"文章目录","position":{"start":{"line":2,"column":5,"offset":5},"end":{"line":2,"column":9,"offset":9}}}]}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":9,"offset":9}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"什么是函数式编程","position":{"start":{"line":4,"column":3,"offset":13},"end":{"line":4,"column":11,"offset":21}}}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":4,"column":11,"offset":21}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"FP 的特点","position":{"start":{"line":5,"column":3,"offset":24},"end":{"line":5,"column":9,"offset":30}}}],"position":{"start":{"line":5,"column":1,"offset":22},"end":{"line":5,"column":9,"offset":30}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"FP 的优点","position":{"start":{"line":6,"column":3,"offset":33},"end":{"line":6,"column":9,"offset":39}}}],"position":{"start":{"line":6,"column":1,"offset":31},"end":{"line":6,"column":9,"offset":39}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Python 的函数语法","position":{"start":{"line":7,"column":3,"offset":42},"end":{"line":7,"column":15,"offset":54}}}],"position":{"start":{"line":7,"column":1,"offset":40},"end":{"line":7,"column":15,"offset":54}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"和 FP 相关的内置函数","position":{"start":{"line":8,"column":3,"offset":57},"end":{"line":8,"column":15,"offset":69}}}],"position":{"start":{"line":8,"column":1,"offset":55},"end":{"line":8,"column":15,"offset":69}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"消除控制流","position":{"start":{"line":9,"column":3,"offset":72},"end":{"line":9,"column":8,"offset":77}}}],"position":{"start":{"line":9,"column":1,"offset":70},"end":{"line":9,"column":8,"offset":77}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"List Comprehension","position":{"start":{"line":10,"column":3,"offset":80},"end":{"line":10,"column":21,"offset":98}}}],"position":{"start":{"line":10,"column":1,"offset":78},"end":{"line":10,"column":21,"offset":98}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"闭包","position":{"start":{"line":11,"column":3,"offset":101},"end":{"line":11,"column":5,"offset":103}}}],"position":{"start":{"line":11,"column":1,"offset":99},"end":{"line":11,"column":5,"offset":103}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"结尾","position":{"start":{"line":12,"column":3,"offset":106},"end":{"line":12,"column":5,"offset":108}}}],"position":{"start":{"line":12,"column":1,"offset":104},"end":{"line":12,"column":5,"offset":108}}},{"type":"text","value":"\n"}],"position":{"start":{"line":4,"column":1,"offset":11},"end":{"line":12,"column":5,"offset":108}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"春节前看到热心读者留言，提醒俺：Python 系列好久没更新了（不知不觉又过了一年多）。俺当时回复说：春节假期补上后一篇。昨天听到鞭炮声才发觉元宵已经到了，赶忙写出本文。","position":{"start":{"line":14,"column":1,"offset":110},"end":{"line":14,"column":86,"offset":195}}}],"position":{"start":{"line":14,"column":1,"offset":110},"end":{"line":14,"column":86,"offset":195}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"前一个帖子介绍了 Python 作为“面向对象编程”（以下简称 OOP）语言的特点，今天来聊一聊 Python 作为“函数式编程”（以下简称 FP）语言的特点。考虑到本系列面向的是 Python 的门外汉或刚入门的新手，故本文仅介绍若干浅显的 FP 特性。","position":{"start":{"line":16,"column":1,"offset":197},"end":{"line":16,"column":129,"offset":325}}}],"position":{"start":{"line":16,"column":1,"offset":197},"end":{"line":16,"column":129,"offset":325}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"什么是函数式编程"},"children":[{"type":"element","tagName":"a","properties":{"href":"#什么是函数式编程"},"children":[{"type":"text","value":"什么是函数式编程","position":{"start":{"line":18,"column":3,"offset":329},"end":{"line":18,"column":11,"offset":337}}}]}],"position":{"start":{"line":18,"column":1,"offset":327},"end":{"line":18,"column":11,"offset":337}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"说实话，“函数式编程语言”是一个很大的话题。由于篇幅有限，本文不可能对这个话题做全面介绍。俺干脆偷一下懒，只简单说说。","position":{"start":{"line":20,"column":1,"offset":339},"end":{"line":20,"column":60,"offset":398}}}],"position":{"start":{"line":20,"column":1,"offset":339},"end":{"line":20,"column":60,"offset":398}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"从字面上看，所谓的函数式编程，就是以“函数”为中心的“编程范式”。估计有同学又会问了，啥是“编程范式”捏？哎呦，这又是一个很大的话题。通俗来讲，“编程范式”就是指编程的套路。比方说大家很熟悉的 OOP，就是一种“编程范式”。FP 跟 OOP 一样，都是一种编程的套路。做个简单类比：OOP 以“对象/类”作为程序设计的核心，而 FP 以“函数”作为程序设计的核心。","position":{"start":{"line":22,"column":1,"offset":400},"end":{"line":22,"column":183,"offset":582}}}],"position":{"start":{"line":22,"column":1,"offset":400},"end":{"line":22,"column":183,"offset":582}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"fp的特点"},"children":[{"type":"element","tagName":"a","properties":{"href":"#fp的特点"},"children":[{"type":"text","value":"FP的特点","position":{"start":{"line":24,"column":3,"offset":586},"end":{"line":24,"column":8,"offset":591}}}]}],"position":{"start":{"line":24,"column":1,"offset":584},"end":{"line":24,"column":8,"offset":591}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"既然说到 FP，自然要稍微说一下 FP 的特色。","position":{"start":{"line":26,"column":1,"offset":593},"end":{"line":26,"column":25,"offset":617}}}],"position":{"start":{"line":26,"column":1,"offset":593},"end":{"line":26,"column":25,"offset":617}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"函数很牛x"},"children":[{"type":"element","tagName":"a","properties":{"href":"#函数很牛x"},"children":[{"type":"text","value":"函数很牛X","position":{"start":{"line":28,"column":4,"offset":622},"end":{"line":28,"column":9,"offset":627}}}]}],"position":{"start":{"line":28,"column":1,"offset":619},"end":{"line":28,"column":9,"offset":627}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"刚才说了，FP 是以函数为中心。既然如此，在支持 FP 的语言中，函数的功能自然十分牛X。通俗地说，OOP 语言中，类/对象能干的事情，FP 语言中的函数也能干。下面做一些对比，以加深大伙儿的印象。","position":{"start":{"line":30,"column":1,"offset":629},"end":{"line":30,"column":100,"offset":728}}}],"position":{"start":{"line":30,"column":1,"offset":629},"end":{"line":30,"column":100,"offset":728}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"OOP 中，对象可以互相赋值；FP 中，函数可以互相赋值。","position":{"start":{"line":32,"column":1,"offset":730},"end":{"line":32,"column":30,"offset":759}}}],"position":{"start":{"line":32,"column":1,"offset":730},"end":{"line":32,"column":30,"offset":759}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"OOP 中，对象可以作为函数的参数/返回值，FP 中，函数可以作为函数的参数/返回值。","position":{"start":{"line":34,"column":1,"offset":761},"end":{"line":34,"column":44,"offset":804}}}],"position":{"start":{"line":34,"column":1,"offset":761},"end":{"line":34,"column":44,"offset":804}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"某些 OOP 中，类可以嵌套定义；FP 中，函数可以嵌套定义。","position":{"start":{"line":36,"column":1,"offset":806},"end":{"line":36,"column":32,"offset":837}}}],"position":{"start":{"line":36,"column":1,"offset":806},"end":{"line":36,"column":32,"offset":837}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"某些 OOP 中，可以有匿名类；FP 中，可以有匿名函数。","position":{"start":{"line":38,"column":1,"offset":839},"end":{"line":38,"column":30,"offset":868}}}],"position":{"start":{"line":38,"column":1,"offset":839},"end":{"line":38,"column":30,"offset":868}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"避免副作用"},"children":[{"type":"element","tagName":"a","properties":{"href":"#避免副作用"},"children":[{"type":"text","value":"避免副作用","position":{"start":{"line":40,"column":4,"offset":873},"end":{"line":40,"column":9,"offset":878}}}]}],"position":{"start":{"line":40,"column":1,"offset":870},"end":{"line":40,"column":9,"offset":878}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 FP 中，特别强调函数不要有“副作用”（洋文叫“side effect”）。没有副作用的函数，又称之为纯函数（pure function）。其输出完全依赖于输入。换句话说，只要输入一样，输出就一样。","position":{"start":{"line":42,"column":1,"offset":880},"end":{"line":42,"column":102,"offset":981}}}],"position":{"start":{"line":42,"column":1,"offset":880},"end":{"line":42,"column":102,"offset":981}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"要成为纯函数，函数内部不能读写函数外部变量、不能有设备 I/O（比如读写文件）......","position":{"start":{"line":44,"column":1,"offset":983},"end":{"line":44,"column":46,"offset":1028}}}],"position":{"start":{"line":44,"column":1,"offset":983},"end":{"line":44,"column":46,"offset":1028}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"无副作用是 FP 的重要特性。FP的很多优点来自于此特性。","position":{"start":{"line":46,"column":1,"offset":1030},"end":{"line":46,"column":30,"offset":1059}}}],"position":{"start":{"line":46,"column":1,"offset":1030},"end":{"line":46,"column":30,"offset":1059}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"避免控制流"},"children":[{"type":"element","tagName":"a","properties":{"href":"#避免控制流"},"children":[{"type":"text","value":"避免控制流","position":{"start":{"line":48,"column":4,"offset":1064},"end":{"line":48,"column":9,"offset":1069}}}]}],"position":{"start":{"line":48,"column":1,"offset":1061},"end":{"line":48,"column":9,"offset":1069}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 FP 中，尽量避免用控制流语句（循环语句、判断语句）。对于控制流语句，FP 有另外的替代方式。比如：常用递归或高阶函数来替代循环。如此一来，FP 的代码会显得更简洁，更可读。","position":{"start":{"line":50,"column":1,"offset":1071},"end":{"line":50,"column":90,"offset":1160}}}],"position":{"start":{"line":50,"column":1,"offset":1071},"end":{"line":50,"column":90,"offset":1160}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"多态"},"children":[{"type":"element","tagName":"a","properties":{"href":"#多态"},"children":[{"type":"text","value":"多态","position":{"start":{"line":52,"column":4,"offset":1165},"end":{"line":52,"column":6,"offset":1167}}}]}],"position":{"start":{"line":52,"column":1,"offset":1162},"end":{"line":52,"column":6,"offset":1167}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"大部分支持 FP 的语言，也都支持多态。函数参数支持多态化，便可实现非常灵活的功能。","position":{"start":{"line":54,"column":1,"offset":1169},"end":{"line":54,"column":43,"offset":1211}}}],"position":{"start":{"line":54,"column":1,"offset":1169},"end":{"line":54,"column":43,"offset":1211}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"说了这么多，不知道大伙儿明白了没？还是没整明白的同学，请看维基百科的英文词条（中文词条太简单，看不明白滴）。","position":{"start":{"line":56,"column":1,"offset":1213},"end":{"line":56,"column":55,"offset":1267}}}],"position":{"start":{"line":56,"column":1,"offset":1213},"end":{"line":56,"column":55,"offset":1267}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"洋文实在看不下去吗？那不妨看看 IT 大牛 Joel 写的《你的编程语言能这样做吗？》（中文版在“这里”）。此文以 JavaScript 来阐述 FP 的妙处。","position":{"start":{"line":58,"column":1,"offset":1269},"end":{"line":58,"column":81,"offset":1349}}}],"position":{"start":{"line":58,"column":1,"offset":1269},"end":{"line":58,"column":81,"offset":1349}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"fp-的优点"},"children":[{"type":"element","tagName":"a","properties":{"href":"#fp-的优点"},"children":[{"type":"text","value":"FP 的优点","position":{"start":{"line":60,"column":3,"offset":1353},"end":{"line":60,"column":9,"offset":1359}}}]}],"position":{"start":{"line":60,"column":1,"offset":1351},"end":{"line":60,"column":9,"offset":1359}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"再稍微说一下 FP 的好处，以强化大伙儿学习的动力。","position":{"start":{"line":62,"column":1,"offset":1361},"end":{"line":62,"column":27,"offset":1387}}}],"position":{"start":{"line":62,"column":1,"offset":1361},"end":{"line":62,"column":27,"offset":1387}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"模块化"},"children":[{"type":"element","tagName":"a","properties":{"href":"#模块化"},"children":[{"type":"text","value":"模块化","position":{"start":{"line":64,"column":4,"offset":1392},"end":{"line":64,"column":7,"offset":1395}}}]}],"position":{"start":{"line":64,"column":1,"offset":1389},"end":{"line":64,"column":7,"offset":1395}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 FP 的思想中，函数最好是“纯”的，而且最好只完成“单一”的任务。在这种指导思想下，函数的模块化程度自然就高。","position":{"start":{"line":66,"column":1,"offset":1397},"end":{"line":66,"column":58,"offset":1454}}}],"position":{"start":{"line":66,"column":1,"offset":1397},"end":{"line":66,"column":58,"offset":1454}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"可复用性"},"children":[{"type":"element","tagName":"a","properties":{"href":"#可复用性"},"children":[{"type":"text","value":"可复用性","position":{"start":{"line":68,"column":4,"offset":1459},"end":{"line":68,"column":8,"offset":1463}}}]}],"position":{"start":{"line":68,"column":1,"offset":1456},"end":{"line":68,"column":8,"offset":1463}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"模块化程度高，直接的好处就是可复用性好。","position":{"start":{"line":70,"column":1,"offset":1465},"end":{"line":70,"column":21,"offset":1485}}}],"position":{"start":{"line":70,"column":1,"offset":1465},"end":{"line":70,"column":21,"offset":1485}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"可读性"},"children":[{"type":"element","tagName":"a","properties":{"href":"#可读性"},"children":[{"type":"text","value":"可读性","position":{"start":{"line":72,"column":4,"offset":1490},"end":{"line":72,"column":7,"offset":1493}}}]}],"position":{"start":{"line":72,"column":1,"offset":1487},"end":{"line":72,"column":7,"offset":1493}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"刚才说了，FP 的思想强调函数又纯又小。这样的函数，代码的可读性自然好，修改起来也方便。","position":{"start":{"line":74,"column":1,"offset":1495},"end":{"line":74,"column":45,"offset":1539}}}],"position":{"start":{"line":74,"column":1,"offset":1495},"end":{"line":74,"column":45,"offset":1539}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"易于调试"},"children":[{"type":"element","tagName":"a","properties":{"href":"#易于调试"},"children":[{"type":"text","value":"易于调试","position":{"start":{"line":76,"column":4,"offset":1544},"end":{"line":76,"column":8,"offset":1548}}}]}],"position":{"start":{"line":76,"column":1,"offset":1541},"end":{"line":76,"column":8,"offset":1548}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"前面提到了纯函数。如果你的程序中大部分函数都是纯函数，则调试 Bug 会容易很多。像 OOP 中，类的多个成员函数都可以修改类的成员变量，有时候会导致调试极其困难。而纯函数没有此问题。","position":{"start":{"line":78,"column":1,"offset":1550},"end":{"line":78,"column":93,"offset":1642}}}],"position":{"start":{"line":78,"column":1,"offset":1550},"end":{"line":78,"column":93,"offset":1642}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"另外，多线程是调试的一大噩梦。当年俺还专门写过帖子，介绍 C++ 多线程的注意事项（在“这里”）。而纯函数由于没有副作用，不必担心各种“互斥”、“死锁”等问题。","position":{"start":{"line":80,"column":1,"offset":1644},"end":{"line":80,"column":81,"offset":1724}}}],"position":{"start":{"line":80,"column":1,"offset":1644},"end":{"line":80,"column":81,"offset":1724}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"易于测试"},"children":[{"type":"element","tagName":"a","properties":{"href":"#易于测试"},"children":[{"type":"text","value":"易于测试","position":{"start":{"line":82,"column":4,"offset":1729},"end":{"line":82,"column":8,"offset":1733}}}]}],"position":{"start":{"line":82,"column":1,"offset":1726},"end":{"line":82,"column":8,"offset":1733}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"除了易于调试，纯函数的输出仅仅依赖于输入，这一特点注定了它很容易进行单元测试。","position":{"start":{"line":84,"column":1,"offset":1735},"end":{"line":84,"column":40,"offset":1774}}}],"position":{"start":{"line":84,"column":1,"offset":1735},"end":{"line":84,"column":40,"offset":1774}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"适合并行"},"children":[{"type":"element","tagName":"a","properties":{"href":"#适合并行"},"children":[{"type":"text","value":"适合并行","position":{"start":{"line":86,"column":4,"offset":1779},"end":{"line":86,"column":8,"offset":1783}}}]}],"position":{"start":{"line":86,"column":1,"offset":1776},"end":{"line":86,"column":8,"offset":1783}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 FP 中，由于纯函数无副作用，很适合编写并行处理的代码。最典型并且在工业界获得巨大成功的例子就是 Erlang。","position":{"start":{"line":88,"column":1,"offset":1785},"end":{"line":88,"column":59,"offset":1843}}}],"position":{"start":{"line":88,"column":1,"offset":1785},"end":{"line":88,"column":59,"offset":1843}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"其它"},"children":[{"type":"element","tagName":"a","properties":{"href":"#其它"},"children":[{"type":"text","value":"其它","position":{"start":{"line":90,"column":4,"offset":1848},"end":{"line":90,"column":6,"offset":1850}}}]}],"position":{"start":{"line":90,"column":1,"offset":1845},"end":{"line":90,"column":6,"offset":1850}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"当然啦，FP 的好处远不止上述这些（比如还有：利于形式化证明）。限于篇幅，俺就不展开了。","position":{"start":{"line":92,"column":1,"offset":1852},"end":{"line":92,"column":45,"offset":1896}}}],"position":{"start":{"line":92,"column":1,"offset":1852},"end":{"line":92,"column":45,"offset":1896}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"python-的函数语法"},"children":[{"type":"element","tagName":"a","properties":{"href":"#python-的函数语法"},"children":[{"type":"text","value":"Python 的函数语法","position":{"start":{"line":94,"column":3,"offset":1900},"end":{"line":94,"column":15,"offset":1912}}}]}],"position":{"start":{"line":94,"column":1,"offset":1898},"end":{"line":94,"column":15,"offset":1912}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Python 中，常见的函数定义和函数调用，想必各位都晓得了。下面说几种不太常见的，且跟 FP 有关的语法。","position":{"start":{"line":96,"column":1,"offset":1914},"end":{"line":96,"column":55,"offset":1968}}}],"position":{"start":{"line":96,"column":1,"offset":1914},"end":{"line":96,"column":55,"offset":1968}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"函数赋值"},"children":[{"type":"element","tagName":"a","properties":{"href":"#函数赋值"},"children":[{"type":"text","value":"函数赋值","position":{"start":{"line":98,"column":4,"offset":1973},"end":{"line":98,"column":8,"offset":1977}}}]}],"position":{"start":{"line":98,"column":1,"offset":1970},"end":{"line":98,"column":8,"offset":1977}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Python 可以把函数直接赋值给一个变量。举例如下：","position":{"start":{"line":100,"column":1,"offset":1979},"end":{"line":100,"column":28,"offset":2006}}}],"position":{"start":{"line":100,"column":1,"offset":1979},"end":{"line":100,"column":28,"offset":2006}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" square"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(n) :  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 这是一个计算平方的小函数，后面会反复用它举例"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" n "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"**"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 2"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"f "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" square  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 此处赋值给变量 f"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"f("}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"10"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 此处返回100。注意：对该变量使用小括号，等同于调用函数"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"匿名定义"},"children":[{"type":"element","tagName":"a","properties":{"href":"#匿名定义"},"children":[{"type":"text","value":"匿名定义","position":{"start":{"line":112,"column":4,"offset":2151},"end":{"line":112,"column":8,"offset":2155}}}]}],"position":{"start":{"line":112,"column":1,"offset":2148},"end":{"line":112,"column":8,"offset":2155}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Python 可以用 lambda 关键字定义【单行】的匿名函数。套用刚才的例子","position":{"start":{"line":114,"column":1,"offset":2157},"end":{"line":114,"column":41,"offset":2197}}}],"position":{"start":{"line":114,"column":1,"offset":2157},"end":{"line":114,"column":41,"offset":2197}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"square "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" lambda"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" x : x"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"**"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"  # 定义一个单参数的匿名函数，并把该函数赋值给变量"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"square("}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"10"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 此处返回 100"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"嵌套定义"},"children":[{"type":"element","tagName":"a","properties":{"href":"#嵌套定义"},"children":[{"type":"text","value":"嵌套定义","position":{"start":{"line":123,"column":4,"offset":2294},"end":{"line":123,"column":8,"offset":2298}}}]}],"position":{"start":{"line":123,"column":1,"offset":2291},"end":{"line":123,"column":8,"offset":2298}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Python 支持函数的嵌套定义（请看如下例子）。这种语法，在“闭包”中经常出现（后面会具体介绍“闭包”）。","position":{"start":{"line":125,"column":1,"offset":2300},"end":{"line":125,"column":55,"offset":2354}}}],"position":{"start":{"line":125,"column":1,"offset":2300},"end":{"line":125,"column":55,"offset":2354}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" outer"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"() :  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 外层函数"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    s "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"hello\""}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" inner"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"() :  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 内层函数"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"        print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(s)  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 此处引用的是外层作用域的变量"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    inner()  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 输出 hello"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    s "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"world\""}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    inner()  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 输出 world"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"和-fp-相关的内置函数"},"children":[{"type":"element","tagName":"a","properties":{"href":"#和-fp-相关的内置函数"},"children":[{"type":"text","value":"和 FP 相关的内置函数","position":{"start":{"line":140,"column":3,"offset":2539},"end":{"line":140,"column":15,"offset":2551}}}]}],"position":{"start":{"line":140,"column":1,"offset":2537},"end":{"line":140,"column":15,"offset":2551}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Python 内置了一大坨用于 FP 的函数，以方便程序猿写出简洁的代码。在接下去聊之前，俺有必要先介绍其中的2个。","position":{"start":{"line":142,"column":1,"offset":2553},"end":{"line":142,"column":59,"offset":2611}}}],"position":{"start":{"line":142,"column":1,"offset":2553},"end":{"line":142,"column":59,"offset":2611}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"mapfunc-iter"},"children":[{"type":"element","tagName":"a","properties":{"href":"#mapfunc-iter"},"children":[{"type":"text","value":"map(func, iter)","position":{"start":{"line":144,"column":4,"offset":2616},"end":{"line":144,"column":19,"offset":2631}}}]}],"position":{"start":{"line":144,"column":1,"offset":2613},"end":{"line":144,"column":19,"offset":2631}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"为了省事，俺只介绍2参数的 map（正宗的 map 支持 N 参数）。","position":{"start":{"line":146,"column":1,"offset":2633},"end":{"line":146,"column":36,"offset":2668}}}],"position":{"start":{"line":146,"column":1,"offset":2633},"end":{"line":146,"column":36,"offset":2668}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"参数 func 是个函数，参数 iter 是个迭代器（也可以理解为集合）","position":{"start":{"line":148,"column":1,"offset":2670},"end":{"line":148,"column":37,"offset":2706}}}],"position":{"start":{"line":148,"column":1,"offset":2670},"end":{"line":148,"column":37,"offset":2706}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"map() 会把 iter 的每个元素传给 func，并把每次调用的结果保存到一个 list 中，然后返回此 list。","position":{"start":{"line":150,"column":1,"offset":2708},"end":{"line":150,"column":61,"offset":2768}}}],"position":{"start":{"line":150,"column":1,"offset":2708},"end":{"line":150,"column":61,"offset":2768}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"举例：","position":{"start":{"line":152,"column":1,"offset":2770},"end":{"line":152,"column":4,"offset":2773}}}],"position":{"start":{"line":152,"column":1,"offset":2770},"end":{"line":152,"column":4,"offset":2773}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"挨个计算整数 list 的平方：","position":{"start":{"line":154,"column":1,"offset":2775},"end":{"line":154,"column":17,"offset":2791}}}],"position":{"start":{"line":154,"column":1,"offset":2775},"end":{"line":154,"column":17,"offset":2791}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"map"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(square, ["}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 返回 [1, 4, 9]"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"filterfunc-iter"},"children":[{"type":"element","tagName":"a","properties":{"href":"#filterfunc-iter"},"children":[{"type":"text","value":"filter(func, iter)","position":{"start":{"line":162,"column":4,"offset":2852},"end":{"line":162,"column":22,"offset":2870}}}]}],"position":{"start":{"line":162,"column":1,"offset":2849},"end":{"line":162,"column":22,"offset":2870}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"参数含义同 map","position":{"start":{"line":164,"column":1,"offset":2872},"end":{"line":164,"column":10,"offset":2881}}}],"position":{"start":{"line":164,"column":1,"offset":2872},"end":{"line":164,"column":10,"offset":2881}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"filter() 会把 iter 的每个元素传给 func，如果 func 返回结果为 True，就把元素保存在一个 list 中，最后返回此 list。","position":{"start":{"line":166,"column":1,"offset":2883},"end":{"line":166,"column":78,"offset":2960}}}],"position":{"start":{"line":166,"column":1,"offset":2883},"end":{"line":166,"column":78,"offset":2960}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"举例：","position":{"start":{"line":168,"column":1,"offset":2962},"end":{"line":168,"column":4,"offset":2965}}}],"position":{"start":{"line":168,"column":1,"offset":2962},"end":{"line":168,"column":4,"offset":2965}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"要过滤出所有奇数，代码如下：","position":{"start":{"line":170,"column":1,"offset":2967},"end":{"line":170,"column":15,"offset":2981}}}],"position":{"start":{"line":170,"column":1,"offset":2967},"end":{"line":170,"column":15,"offset":2981}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" odd"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(n) :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" (n"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 1"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"filter"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(odd, ["}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 返回[1, 3]"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"此处可以用上 lambda，把代码简化为一行：","position":{"start":{"line":181,"column":1,"offset":3071},"end":{"line":181,"column":24,"offset":3094}}}],"position":{"start":{"line":181,"column":1,"offset":3071},"end":{"line":181,"column":24,"offset":3094}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"filter"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"lambda"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" n: (n"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", lst)"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"消除控制流"},"children":[{"type":"element","tagName":"a","properties":{"href":"#消除控制流"},"children":[{"type":"text","value":"消除控制流","position":{"start":{"line":187,"column":3,"offset":3145},"end":{"line":187,"column":8,"offset":3150}}}]}],"position":{"start":{"line":187,"column":1,"offset":3143},"end":{"line":187,"column":8,"offset":3150}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"为了让大伙儿更深刻体会 FP 风格同传统风格的差别，俺把刚才两个例子组合一下——要求返回整数list 中所有奇数的平方。","position":{"start":{"line":189,"column":1,"offset":3152},"end":{"line":189,"column":61,"offset":3212}}}],"position":{"start":{"line":189,"column":1,"offset":3152},"end":{"line":189,"column":61,"offset":3212}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"传统的写法（有控制流）：","position":{"start":{"line":191,"column":1,"offset":3214},"end":{"line":191,"column":13,"offset":3226}}}],"position":{"start":{"line":191,"column":1,"offset":3214},"end":{"line":191,"column":13,"offset":3226}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" func1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(old_lst) :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    new_lst "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" []"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" n "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" old_lst :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" odd(n) :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            new_lst.append(square(n))"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" new_lst"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"FP 的写法（无控制流）：","position":{"start":{"line":204,"column":1,"offset":3383},"end":{"line":204,"column":14,"offset":3396}}}],"position":{"start":{"line":204,"column":1,"offset":3383},"end":{"line":204,"column":14,"offset":3396}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" func2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(lst) :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" map"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(square, "}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"filter"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(odd, lst))"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"怎么样？是不是更简洁？连 for / if 这两个关键字都不需要了。","position":{"start":{"line":213,"column":1,"offset":3473},"end":{"line":213,"column":35,"offset":3507}}}],"position":{"start":{"line":213,"column":1,"offset":3473},"end":{"line":213,"column":35,"offset":3507}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"list-comprehension"},"children":[{"type":"element","tagName":"a","properties":{"href":"#list-comprehension"},"children":[{"type":"text","value":"List Comprehension","position":{"start":{"line":215,"column":3,"offset":3511},"end":{"line":215,"column":21,"offset":3529}}}]}],"position":{"start":{"line":215,"column":1,"offset":3509},"end":{"line":215,"column":21,"offset":3529}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这个洋文比较难翻译。有人叫做“列表推导”，也有人称为“列表展开”或“列表解析”。（俺比较喜欢头一个翻译——不禁让人联想到“推倒”:）","position":{"start":{"line":217,"column":1,"offset":3531},"end":{"line":217,"column":67,"offset":3597}}}],"position":{"start":{"line":217,"column":1,"offset":3531},"end":{"line":217,"column":67,"offset":3597}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 Python 中，这是一个很好吃的语法糖——可以让你写出很简洁、很优雅的代码。","position":{"start":{"line":219,"column":1,"offset":3599},"end":{"line":219,"column":42,"offset":3640}}}],"position":{"start":{"line":219,"column":1,"offset":3599},"end":{"line":219,"column":42,"offset":3640}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"举例1：","position":{"start":{"line":221,"column":1,"offset":3642},"end":{"line":221,"column":5,"offset":3646}}}],"position":{"start":{"line":221,"column":1,"offset":3642},"end":{"line":221,"column":5,"offset":3646}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"还拿刚才过滤奇数的例子。","position":{"start":{"line":223,"column":1,"offset":3648},"end":{"line":223,"column":13,"offset":3660}}}],"position":{"start":{"line":223,"column":1,"offset":3648},"end":{"line":223,"column":13,"offset":3660}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"filter"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"lambda"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" n: (n"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", lst)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"上述写法可以等价替换为列表推导：","position":{"start":{"line":231,"column":1,"offset":3711},"end":{"line":231,"column":17,"offset":3727}}}],"position":{"start":{"line":231,"column":1,"offset":3711},"end":{"line":231,"column":17,"offset":3727}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"[n "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" n "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" lst "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" (n"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"举例2：\n　　\n再来一个稍微复杂的例子。假设有两个整数 list，分别存储矩形的宽度和高度。现在想把所有的宽度和高度进行两两组合，把大于 10 的面积打印出来。\n　　\n传统的写法（2层循环，4行代码）","position":{"start":{"line":239,"column":1,"offset":3775},"end":{"line":243,"column":17,"offset":3875}}}],"position":{"start":{"line":239,"column":1,"offset":3775},"end":{"line":243,"column":17,"offset":3875}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" w "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" width :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" h "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" height :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" w"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"h "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"\u003e"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 10"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"            print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(w"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"h)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"FP 的写法（无循环，1行代码，多精致啊）","position":{"start":{"line":254,"column":1,"offset":3978},"end":{"line":254,"column":22,"offset":3999}}}],"position":{"start":{"line":254,"column":1,"offset":3978},"end":{"line":254,"column":22,"offset":3999}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"print"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"( [w"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"h "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" w "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" width "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" h "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"in"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" height "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"if"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" w"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"*"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"h "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"\u003e"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 10"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"] )"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"除了列表推导，Python 中还有字典推导、集合推导等等。为了省点口水，暂且打住。","position":{"start":{"line":262,"column":1,"offset":4076},"end":{"line":262,"column":42,"offset":4117}}}],"position":{"start":{"line":262,"column":1,"offset":4076},"end":{"line":262,"column":42,"offset":4117}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"闭包"},"children":[{"type":"element","tagName":"a","properties":{"href":"#闭包"},"children":[{"type":"text","value":"闭包","position":{"start":{"line":264,"column":3,"offset":4121},"end":{"line":264,"column":5,"offset":4123}}}]}],"position":{"start":{"line":264,"column":1,"offset":4119},"end":{"line":264,"column":5,"offset":4123}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"闭包，洋文叫“closure”，解释在“这里”。它是 FP 的常见手法。那闭包到底有啥用捏？俺举一个微积分中，函数求导的例子。（不懂微积分或者对高数有心理阴影的同学，别担心，请把注意力集中在代码上）","position":{"start":{"line":266,"column":1,"offset":4125},"end":{"line":266,"column":100,"offset":4224}}}],"position":{"start":{"line":266,"column":1,"offset":4125},"end":{"line":266,"column":100,"offset":4224}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" d"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(f) :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" calc"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(x) :"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        dx "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 0.000001"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"  # 表示无穷小的Δx"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" (f(x"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"dx) "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" f(x)) "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"/"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" dx  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 计算斜率。注意，此处引用了外层作用域的变量 f"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" calc  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 此处用函数作为返回值（也就是函数 f 的导数）"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"现在，假设要计算二次函数 f(x) = x2 + x + 1 的导数，只需如下代码：","position":{"start":{"line":278,"column":1,"offset":4413},"end":{"line":278,"column":43,"offset":4455}}}],"position":{"start":{"line":278,"column":1,"offset":4413},"end":{"line":278,"column":43,"offset":4455}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"f "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" lambda"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" x : x"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"**"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" +"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" x "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"  # 先把二次函数用代码表达出来"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"f1 "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" d(f)  "}]},{"type":"element","tagName":"span","properties":{"style":"color:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# 这个f1 就是 f 的一阶导数啦。注意，导数依然是个函数"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"有了一阶导数，就可以很容易地计算该函数在某点的斜率","position":{"start":{"line":287,"column":1,"offset":4561},"end":{"line":287,"column":26,"offset":4586}}}],"position":{"start":{"line":287,"column":1,"offset":4561},"end":{"line":287,"column":26,"offset":4586}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"比如要计算 x=3 的斜率，只需：","position":{"start":{"line":289,"column":1,"offset":4588},"end":{"line":289,"column":18,"offset":4605}}}],"position":{"start":{"line":289,"column":1,"offset":4588},"end":{"line":289,"column":18,"offset":4605}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"f1("}]},{"type":"element","tagName":"span","properties":{"style":"color:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果要想得到二阶导数（导数的导数），只需依样画葫芦（瞧这代码写得多优雅）","position":{"start":{"line":297,"column":1,"offset":4630},"end":{"line":297,"column":37,"offset":4666}}}],"position":{"start":{"line":297,"column":1,"offset":4630},"end":{"line":297,"column":37,"offset":4666}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"class":"shiki shiki-themes github-light github-dark","style":"background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8","tabindex":"0"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"f2 "}]},{"type":"element","tagName":"span","properties":{"style":"color:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"style":"color:#24292E;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" d(f1)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"class":"line"},"children":[]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"看到这里，大伙儿不妨设想一下：如果不用 FP，改用 OOP，上述需求该如何实现？俺觉得吧，用 OOP 来求导，这代码写起来多半是又丑又臭。","position":{"start":{"line":305,"column":1,"offset":4696},"end":{"line":305,"column":70,"offset":4765}}}],"position":{"start":{"line":305,"column":1,"offset":4696},"end":{"line":305,"column":70,"offset":4765}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{"id":"结尾"},"children":[{"type":"element","tagName":"a","properties":{"href":"#结尾"},"children":[{"type":"text","value":"结尾","position":{"start":{"line":307,"column":3,"offset":4769},"end":{"line":307,"column":5,"offset":4771}}}]}],"position":{"start":{"line":307,"column":1,"offset":4767},"end":{"line":307,"column":5,"offset":4771}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"今天聊了不少 FP 的语法特性，可惜还是没聊完。由于俺比较懒，而且怕写得太长没人看，所以一些高级话题（比如：迭代器、生成器、等），今天就不介绍了。假如列位看官对那些玩意儿感兴趣，再抽空单独写一帖。","position":{"start":{"line":309,"column":1,"offset":4773},"end":{"line":309,"column":99,"offset":4871}}}],"position":{"start":{"line":309,"column":1,"offset":4773},"end":{"line":309,"column":99,"offset":4871}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"RP-why-choose-python-0-overview"},"children":[{"type":"text","value":"回到本系列的目录","position":{"start":{"line":311,"column":2,"offset":4874},"end":{"line":311,"column":10,"offset":4882}}}],"position":{"start":{"line":311,"column":1,"offset":4873},"end":{"line":311,"column":44,"offset":4916}}}],"position":{"start":{"line":311,"column":1,"offset":4873},"end":{"line":311,"column":44,"offset":4916}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"版权声明","position":{"start":{"line":313,"column":5,"offset":4922},"end":{"line":313,"column":9,"offset":4926}}}],"position":{"start":{"line":313,"column":3,"offset":4920},"end":{"line":313,"column":11,"offset":4928}}},{"type":"text","value":"\n本博客（编程随想的博客）所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者编程随想和本文原始地址：","position":{"start":{"line":313,"column":15,"offset":4932},"end":{"line":314,"column":71,"offset":5003}}},{"type":"text","value":"\n","position":{"start":{"line":314,"column":75,"offset":5007},"end":{"line":315,"column":1,"offset":5008}}},{"type":"element","tagName":"a","properties":{"href":"https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html"},"children":[{"type":"text","value":"https://program-think.blogspot.com/2012/02/why-choose-python-4-fp.html","position":{"start":{"line":315,"column":84,"offset":5091},"end":{"line":315,"column":154,"offset":5161}}}],"position":{"start":{"line":315,"column":84,"offset":5091},"end":{"line":315,"column":154,"offset":5161}}}],"position":{"start":{"line":313,"column":3,"offset":4920},"end":{"line":315,"column":158,"offset":5165}}},{"type":"text","value":"\n"}],"position":{"start":{"line":313,"column":1,"offset":4918},"end":{"line":315,"column":158,"offset":5165}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":316,"column":1,"offset":5166}}}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"RP-why-choose-python-4-fp"},"buildId":"buildID","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>