<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">



<title>.git | 管理 GitHub 不同用户身份的仓库 | 阿掖山：一个博客</title>
<link rel="shortcut icon" href="https://mountaye.github.io/blog/favicon.ico" >
<link rel="canonical" href="https://mountaye.github.io/blog/articles/git-multiple-users" />
<meta name="generator" content="Jekyll v4.3.2" />
<meta name="author" content="MountAye" />
<meta name="description" content="多用户多账户，如何告诉 GitHub 某个项目文件夹该由哪个账号来做版本管理。" />
<meta property="og:title" content=".git | 管理 GitHub 不同用户身份的仓库" />
<meta property="og:locale" content="zh-CN" />
<meta property="og:description" content="" />
<meta property="og:url" content="https://mountaye.github.io/blog/articles/git-multiple-users" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-26 00:00:00 -0600" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content=".git | 管理 GitHub 不同用户身份的仓库" />
<script type="application/ld+json">
    {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"MountAye"},"dateModified":"","datePublished":"2021-12-26","description":"多用户多账户，如何告诉 GitHub 某个项目文件夹该由哪个账号来做版本管理。","headline":"多用户多账户，如何告诉 GitHub 某个项目文件夹该由哪个账号来做版本管理。","mainEntityOfPage":{"@type":"WebPage","@id":""},"url":"https://mountaye.github.io/blog/articles/git-multiple-users"}
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1920275466226790"
     crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/blog/assets/css/style.css?v=">
    <script src="https://code.jquery.com/jquery-3.3.0.min.js" integrity="sha256-RTQy8VOmNlT6b2PIRur37p6JEBZUE7o8wPgMvu18MC4=" crossorigin="anonymous"></script>
    <script src="/blog/assets/js/main.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
    <header>
      <h1>阿掖山：一个博客</h1>
      <p>智力活动是一种生活态度</p>
    </header>
    <div id="banner">
      <span id="logo"></span>
      <span class="button fork">
        <a href="/blog/articles/git-multiple-users"><strong>汉</strong></a> | 
        <a href="/blog/en/articles/git-multiple-users"><strong>En</strong></a>
      </span>
      <div class="downloads">
        <span></span>
        <ul>
          <li><a href="/blog/history" class="button">历史</a></li>
          <li><a href="/blog/topics" class="button">分类</a></li>
          <li><a href="/blog/about" class="button">关于</a></li>
        </ul>
      </div>
    </div>

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section id="ad-head"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1920275466226790"
     crossorigin="anonymous"></script>
<!-- blog-header -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1920275466226790"
     data-ad-slot="4291489170"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></section>
<section class="outlined">
  <h1>.git | 管理 GitHub 不同用户身份的仓库</h1>
  <p style="text-indent: 0;">2021 年 12 月 26 日 </p>
  <p style="text-indent: 0;"><code>.md</code><code>.git</code></p>
  
  <hr>
  <p>很显然，我不可能把“阿掖山”这个名字写到论文里，与研究相关的项目、组里的代码和数据，都由另一个实名的 GitHub 账号来处理。这就有个问题——如何告诉 GitHub 某个项目文件夹该由哪个账号来做版本管理。</p>

<p>于是 STFW，结果看到了GitHub  官方的回答：<a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-user-account/managing-user-account-settings/merging-multiple-user-accounts">“这边建议您把两个账号合并呢～”</a></p>

<p>其实这个问题在建立这个博客站之前就解决了，但是因为很长时间我的研究代码都是自己在用，而且只在台式机上用，一直没有推到 GitHub 上去，实名账号一直没在笔记本上用过。具体细节忘得差不多了，这次复习一下。</p>

<p>作为例子，两个账号的用户名分别是 <code class="language-plaintext highlighter-rouge">USER1</code> 和 <code class="language-plaintext highlighter-rouge">USER2</code>，注册邮箱分别是 <code class="language-plaintext highlighter-rouge">USER1@EMAIL.com</code> 和 <code class="language-plaintext highlighter-rouge">USER2@EMAIL.com</code>。</p>

<h2 id="多个计算机用户">多个计算机用户</h2>

<p>当然了，最简单的方法就是新建一个操作系统用户，每个用户登录一个 GitHub 账号。这种方法好处很多：</p>

<ul>
  <li>不需要特殊操作。</li>
  <li>适用于不同操作系统。</li>
  <li>切换身份需要专门切换账号，有助于防止操作者忘记自己所处的身份。</li>
</ul>

<p>但是这篇文章不会涉及这种方法，因为当初买电脑的时候并没有注意到需要做身份隔离，等到发现事情不妙的时候已经混装和两个身份需要的不同软件，积重难返。于是采用了以下两节的解决方案。</p>

<h2 id="单个计算机用户windows-github-desktop">单个计算机用户@Windows: GitHub Desktop</h2>

<p><img src="/blog/assets/photos/2021-12-26-github-desktop.png" alt="" /></p>

<ul>
  <li>在官网下载、安装、打开 <a href="https://desktop.github.com/">GitHub Desktop</a> 客户端。</li>
  <li>在 GitHub 网页版上切换到新的账户。</li>
  <li>点击左上角 <code class="language-plaintext highlighter-rouge">File &gt; Options</code>，默认界面就是账户信息。点击 <code class="language-plaintext highlighter-rouge">Sign Out</code> 退出登录，然后再点击 <code class="language-plaintext highlighter-rouge">Sign In</code>，根据弹出窗口的提示操作，就来到了新的账户。</li>
</ul>

<h2 id="单个计算机用户linux--sshconfig">单个计算机用户@Linux : <code class="language-plaintext highlighter-rouge">.ssh/config</code></h2>

<p>具体操作看以下两个连接就够了：</p>

<ul>
  <li><a href="https://gist.github.com/JoaquimLey/e6049a12c8fd2923611802384cd2fb4a">https://gist.github.com/JoaquimLey/e6049a12c8fd2923611802384cd2fb4a</a></li>
  <li><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh">https://docs.github.com/en/authentication/connecting-to-github-with-ssh</a></li>
</ul>

<p><del>但是为了水字数，</del> 还是写得详细一点……</p>

<h3 id="本地生成并启用-ssh-key">本地：生成并启用 SSH key</h3>

<p>打开命令行，输入以下命令，生成 SSH key：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-C</span> <span class="s2">"USER1"</span> 
ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-C</span> <span class="s2">"USER2"</span>
</code></pre></div></div>

<p>其中 <code class="language-plaintext highlighter-rouge">-t</code> 指定加密算法，<code class="language-plaintext highlighter-rouge">-b</code> 指定密钥的位数，<code class="language-plaintext highlighter-rouge">-C</code> 相当于注释。</p>

<p>然后命令行会弹出几个选项，可以一路按回车使用默认值。</p>

<p>上述命令完成后，在 <code class="language-plaintext highlighter-rouge">~/.ssh</code> 文件夹应该会有两对四个密钥文件：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">~/.ssh/USER1</code></li>
  <li><code class="language-plaintext highlighter-rouge">~/.ssh/USER1.pub</code></li>
  <li><code class="language-plaintext highlighter-rouge">~/.ssh/USER2</code></li>
  <li><code class="language-plaintext highlighter-rouge">~/.ssh/USER2.pub</code></li>
</ul>

<p>然后输入以下命令，启用刚刚生成的密钥。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span>ssh-agent <span class="nt">-s</span><span class="si">)</span><span class="s2">"</span> <span class="c"># 启动 ssh-agent</span>
ssh-add ~/.ssh/USER1   <span class="c"># 添加 USER1 的密钥</span>
ssh-add ~/.ssh/USER2   <span class="c"># 添加 USER2 的密钥</span>
</code></pre></div></div>

<h3 id="网页把密钥添加到对应的账号">网页：把密钥添加到对应的账号</h3>

<p>在网页端以 <code class="language-plaintext highlighter-rouge">USER1</code> 身份登录 GitHub 之后，在 “Settings” 页面找到 “SSH and GPG keys” 选项卡，点击绿色的 “New SSH key” 按钮之后，将 <code class="language-plaintext highlighter-rouge">~/.ssh/USER1.pub</code> 中的内容复制到 “Key” 填空区，然后起一个名字，点击 “Add SSH key” 按钮。</p>

<p><img src="/blog/assets/photos/2021-12-26-github-key.png" alt="" /></p>

<p>USER2也照此办理。</p>

<p><strong>千万要注意</strong>复制的应该是 <code class="language-plaintext highlighter-rouge">.pub</code> 后缀的文件！</p>

<h3 id="本地编辑-sshconfig-文件">本地：编辑 <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> 文件</h3>

<p>在 ~/.ssh/ 找到或者新建一个名为 config 的文本文件。打开之后，将以下内容添加到文件中：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Host github.com-user1
	Hostname github.com
	User git
	IdentityFile ~/.ssh/user1
Host github.com-user2
	Hostname github.com
	User git
	IdentityFile ~/.ssh/user2
</code></pre></div></div>

<h3 id="git-clone-时-repo-地址的改动"><code class="language-plaintext highlighter-rouge">git clone</code> 时 repo 地址的改动</h3>

<p>一般的 git clone, 直接把 GitHub 提供的命令复制粘贴到命令行就行了。</p>

<p><img src="/blog/assets/photos/2021-12-26-git-clone.png" alt="" /></p>

<p>但是我们这个不同，首先是只能选择 SSH 模式，然后是需要在域名<code class="language-plaintext highlighter-rouge">github.com</code> 后面加上<code class="language-plaintext highlighter-rouge">-user1</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
git clone git@github.com-user1:User/Repo.git
</code></pre></div></div>

<p>这里就体现出之前在 <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> 把 Host 命名为 <code class="language-plaintext highlighter-rouge">github.com-****</code> 的好处了。</p>

<h3 id="git-commit-前填写在-repo-中填写账户信息"><code class="language-plaintext highlighter-rouge">git commit</code> 前填写在 repo 中填写账户信息</h3>

<p>第一次做完改动推送到 GitHub 之前，需要专门在 repo 级别写明自己的身份，也就是在命令行输入：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
git config <span class="nt">--local</span> user.name  <span class="s2">"USER1"</span>
git config <span class="nt">--local</span> user.email <span class="s2">"USER1@EMAIL.com"</span>
</code></pre></div></div>

<h3 id="注意为了防止操作者忘记自己所处的身份"><strong>注意：</strong>为了防止操作者忘记自己所处的身份</h3>

<p>强烈建议去掉用户信息的全局设置：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
git config <span class="nt">--global</span> <span class="nt">--unset</span> user.name
git config <span class="nt">--global</span> <span class="nt">--unset</span> user.email
</code></pre></div></div>

<p>这样假如忘记之前的 <code class="language-plaintext highlighter-rouge">git config --local</code>, 第一次 git commit 的时候会报错，提示信息缺失。</p>

<p>这样操作一次之后，之后的操作几乎感受不到账户的不同。</p>

  <hr>
</section>
<section id="ad-tail"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1920275466226790"
     crossorigin="anonymous"></script>
<!-- blog-header -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1920275466226790"
     data-ad-slot="4291489170"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></section>
<section id="comments">
  <script src="https://giscus.app/client.js"
        data-repo="MountAye/comments"
        data-repo-id="R_kgDOJe4FmQ"
        data-category="BLOG"
        data-category-id="DIC_kwDOJe4Fmc4CWQuC"
        data-mapping="title"
        data-strict="1"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="bottom"
        data-theme="light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
</section>

    </div>
    <footer>
      <p><small>Hosted on GitHub Pages
            <br>Theme by <a href="https://twitter.com/mattgraham">mattgraham</a>
            <br>Modified by <a href="https://www.github.com/MountAye">MountAye</a>
      </small></p>
    </footer>

  </body>
</html>

  